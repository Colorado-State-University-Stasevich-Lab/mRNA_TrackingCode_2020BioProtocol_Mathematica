(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    983056,      21528]
NotebookOptionsPosition[    947992,      20981]
NotebookOutlinePosition[    948388,      20997]
CellTagsIndexPosition[    948345,      20994]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Title",
 CellChangeTimes->{{3.770383258393817*^9, 
  3.770383272169605*^9}},ExpressionUUID->"9e97aec4-4023-44e8-a12f-\
af7c57c1436c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{"Off", "[", 
  RowBox[{
   RowBox[{"General", "::", "spell"}], ",", " ", 
   RowBox[{"General", "::", "spell1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.642167939244282*^9, 3.6421679399873247`*^9}, {
  3.6514954254104395`*^9, 3.65149564868221*^9}, {3.6514957496829867`*^9, 
  3.651495786850113*^9}, {3.6514985885093584`*^9, 3.6514986184050684`*^9}, {
  3.651520636239416*^9, 3.651520636918455*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"23a3959d-752a-474c-a936-6bc8940df47d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<ErrorListLinePlot`\>\"", "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7148638296045837`*^9, 3.7148638450365524`*^9}, {
   3.770476134624033*^9, 3.770476147726783*^9}, 3.7711873995900087`*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"19233f34-1ad6-4da3-bc13-66116c44da09"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Title",
 CellChangeTimes->{{3.575085645362406*^9, 3.5750856463124075`*^9}, {
  3.5774930265230093`*^9, 3.5774930278830867`*^9}, {3.712936679691573*^9, 
  3.712936679835582*^9}},ExpressionUUID->"35a2d634-c54c-4315-9def-\
6daffc4bf438"],

Cell[CellGroupData[{

Cell["Initialize Functions ", "Subsection",
 CellChangeTimes->{{3.7452394160135775`*^9, 3.7452394728064213`*^9}, {
  3.7458585237036204`*^9, 
  3.7458585255152187`*^9}},ExpressionUUID->"e1f2de0f-2dbb-4fab-9807-\
414012d44dbf"],

Cell[CellGroupData[{

Cell["1. MyColMovieMaker", "Subsubsection",
 CellChangeTimes->{{3.7458582322862997`*^9, 
  3.7458582367354565`*^9}},ExpressionUUID->"2ce83764-9ead-4af7-8546-\
8f57ee40c2a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyColMovieMaker", "::", "usage"}], "=", 
   "\"\<MyColMovieMaker[myMovieFileName, myChN] outputs a color version of \
the movie in the file myMovieFileName.\nInputs\n1. myMovieFile: the filename \
of the movie, e.g. MAX_cell01.tif\n2. myChN: total # of channels in the \
movie, e.g. 1, 2, or 3\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyColMovieMaker", "[", 
   RowBox[{"myMovieFileName_", ",", "myChN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myMovie", ",", "myBlankImg", ",", "myColMovie", ",", "myOutput"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myMovie", "=", 
      RowBox[{"Import", "[", "myMovieFileName", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myBlankImg", "=", 
      RowBox[{"ImageMultiply", "[", 
       RowBox[{
        RowBox[{
        "myMovie", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "0"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "creates", " ", "a", " ", "black", " ", "image", " ", "placeholder", 
       " ", "if"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"myColMovie", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"myMovie", ",", "myChN"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
      "partitions", " ", "channels", " ", "of", " ", "movie", " ", 
       "properly"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myChN", "\[Equal]", "3"}], ",", 
       RowBox[{"myOutput", "=", 
        RowBox[{"ColorCombine", "/@", "myColMovie"}]}]}], "]"}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"if", " ", "3", " ", "channels"}], ",", " ", 
       RowBox[{"make", " ", "an", " ", "\"\<RGB\>\"", " ", "image", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ch1", " ", "=", " ", "red"}], ";", " ", 
          RowBox[{"ch2", " ", "=", " ", "green"}], ";", " ", 
          RowBox[{"ch3", " ", "=", " ", "blue"}]}], " "}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myChN", "\[Equal]", "2"}], ",", 
       RowBox[{"myOutput", "=", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"ColorCombine", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             "myBlankImg"}], "}"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "myColMovie"}], ",", "1"}], "}"}]}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"if", " ", "2", " ", "channels"}], ",", " ", 
       RowBox[{
       "make", " ", "an", " ", "\"\<RGB\>\"", " ", "movie", " ", "with", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ch1", " ", "=", " ", "red"}], ",", " ", 
          RowBox[{"ch2", " ", "=", " ", "green"}], ",", " ", 
          RowBox[{"ch3", " ", "=", " ", "myBlankImg"}]}], " "}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myChN", "\[Equal]", "1"}], ",", 
       RowBox[{"myOutput", "=", "myMovie"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"if", " ", "1", " ", "channel"}], ",", " ", 
       RowBox[{"keep", " ", "movie", " ", "grayscale"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "myOutput"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7458500750371447`*^9, 3.745850150447054*^9}, {
  3.745850181236188*^9, 3.745850191967459*^9}, {3.745850475084962*^9, 
  3.745850488486986*^9}, {3.7458505532154646`*^9, 3.7458506021317267`*^9}, {
  3.7458506624704676`*^9, 3.7458507659830093`*^9}, {3.745851040990035*^9, 
  3.7458511977414155`*^9}, {3.7458513234100957`*^9, 3.7458514062951326`*^9}, {
  3.745851466287944*^9, 3.7458516415400105`*^9}, {3.7458525458159*^9, 
  3.745852572699629*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"76cee680-fb4a-4de4-87dd-e75e63fc55fb"]
}, Closed]],

Cell[CellGroupData[{

Cell["2. MyRGBCropMaker", "Subsubsection",
 CellChangeTimes->{{3.745238859788358*^9, 3.7452388610921016`*^9}, {
  3.7452388942191954`*^9, 3.745238926349352*^9}, {3.745239028783815*^9, 
  3.7452390603005447`*^9}, {3.7452391641175985`*^9, 3.74523916464117*^9}, {
  3.7457808356911345`*^9, 3.74578083681114*^9}, {3.74585819788832*^9, 
  3.7458582080032663`*^9}, {3.746451247161847*^9, 
  3.7464512480300617`*^9}},ExpressionUUID->"bffe24b6-70fd-456b-b58a-\
697a2b6c2a15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyRGBCropMaker", "::", "usage"}], "=", 
   "\"\<MyRGBCropMaker[myMovieFileName, \
mySpotsFileName,myTF,myRefChN,myCropSize] outputs a list of cropped 3-color \
images for each spot specified in mySpotsFileName. For each frame of the \
movie, a single list of 3-color cropped images is created, and the output is \
a list of these lists.\nInputs\n1. myMovieFileName: the filename of the \
3-color RGB movie, e.g. MAX_cell01.tif\n3. mySpotsFileName: the filename for \
the spot positiosn, e.g. MAX_cell01_greenspots.dat \n4. myTF: the \
transformation function (usually converts green/blue image coordinates to red \
image coordinates \n5. myRefChN: the channel corresponding to \
mySpotsFileName, e.g. 1 (red), 2 (green), or 3 (blue)\n6. myPadsize: the \
dimensions of the cropped margins. For example, 5 would generate a crop with \
a 5 pixel margin, i.e. a cropped image with dimensions (2*5+1) x (2*5+1) \n\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyRGBCropMaker", "[", 
   RowBox[{
   "myMovieFileName_", ",", "mySpotsFileName_", ",", "myTF_", ",", 
    "myRefChN_", ",", "myPadSize_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myMovie", ",", "mySpots", ",", "myInvF", ",", "myRedSpots", ",", 
      "myGreenSpots", ",", "myBlueSpots", ",", "myRedCrops", ",", 
      "myGreenCrops", ",", "myBlueCrops", ",", "myOutput", ",", "frameN", ",",
       "spotN"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myInvF", "=", 
      RowBox[{"InverseFunction", "[", "myTF", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myMovie", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Import", "[", "myMovieFileName", "]"}], ",", "3"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"This", " ", "assumes", " ", "a", " ", "3"}], "-", 
       RowBox[{"color", " ", "RGB", " ", "movie"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mySpots", "=", 
      RowBox[{"<<", 
       RowBox[{"(", "mySpotsFileName", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"myRefChN", "\[Equal]", "2"}], "||", "3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedSpots", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"myInvF", "/@", "mySpots"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myGreenSpots", "=", 
         RowBox[{"Ceiling", "[", "mySpots", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myBlueSpots", "=", "myGreenSpots"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myRefChN", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedSpots", "=", 
         RowBox[{"Ceiling", "[", "mySpots", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myGreenSpots", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"myTF", "/@", "mySpots"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myBlueSpots", "=", "myGreenSpots"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myRedCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myRedSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myRedSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myRedSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myGreenCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myGreenSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myGreenSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myGreenSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myBlueCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myBlueSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myBlueSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myBlueSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myOutPut", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", 
        RowBox[{"ColorCombine", "/@"}], "*)"}], 
       RowBox[{
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "myRedCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "myGreenCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "myBlueCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "myRedCrops"}], ",", "1"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7458519178036933`*^9, 3.7458520632813377`*^9}, {
   3.7458521049442515`*^9, 3.74585217629611*^9}, {3.7458522330747705`*^9, 
   3.745852447155308*^9}, {3.745852506029435*^9, 3.7458525288793983`*^9}, {
   3.745852669998554*^9, 3.7458527364060783`*^9}, {3.7458528482630186`*^9, 
   3.745852978965003*^9}, {3.745853098974571*^9, 3.745853138429415*^9}, {
   3.745853175173521*^9, 3.7458532994547677`*^9}, {3.7458536813898797`*^9, 
   3.7458538268547845`*^9}, {3.7458538792988896`*^9, 
   3.7458540099443765`*^9}, {3.745854052436186*^9, 3.745854058784972*^9}, {
   3.745854512563048*^9, 3.7458546176255326`*^9}, {3.7458546529055943`*^9, 
   3.7458547729526362`*^9}, {3.745854804235282*^9, 3.745854858774844*^9}, {
   3.7458549062517357`*^9, 3.7458550783945365`*^9}, {3.745855227404073*^9, 
   3.7458552644875584`*^9}, {3.7458554044241104`*^9, 3.745855419125173*^9}, {
   3.7458554526108675`*^9, 3.7458554531094766`*^9}, {3.7458555191607704`*^9, 
   3.7458555290560317`*^9}, {3.7458556522221785`*^9, 3.745855654519553*^9}, {
   3.745855733295171*^9, 3.74585573594094*^9}, 3.745855858868634*^9, {
   3.745856010888579*^9, 3.745856048071333*^9}, {3.7458561088676414`*^9, 
   3.745856119761617*^9}, {3.745856289044778*^9, 3.7458563291166706`*^9}, {
   3.7458564048500667`*^9, 3.7458564836493664`*^9}, {3.7458565301988754`*^9, 
   3.745856635665986*^9}, {3.7458566753531985`*^9, 3.745856785652055*^9}, {
   3.7458568234851623`*^9, 3.7458569489566154`*^9}, {3.745857059827033*^9, 
   3.7458571380847993`*^9}, {3.745857357504737*^9, 3.745857357837981*^9}, {
   3.745857418867024*^9, 3.745857447849612*^9}, {3.7458575695873175`*^9, 
   3.7458575704078736`*^9}, {3.7458576879517126`*^9, 
   3.7458578458161883`*^9}, {3.745857946249809*^9, 3.745857948830464*^9}, {
   3.745858021104472*^9, 3.745858024285194*^9}, 3.745858056311452*^9, {
   3.746449094115302*^9, 3.7464490986802297`*^9}, {3.746463393062771*^9, 
   3.746463393689819*^9}, {3.749390109091023*^9, 3.749390164035277*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"f3572849-4ba5-4223-9ec2-fdf7fafd9df0"]
}, Closed]],

Cell[CellGroupData[{

Cell["3. MyGBCropMaker", "Subsubsection",
 CellChangeTimes->{{3.746447490321603*^9, 3.746447514805194*^9}, 
   3.746447558641393*^9, {3.7464512376523595`*^9, 
   3.746451238081942*^9}},ExpressionUUID->"de3e4957-78f0-4981-b16d-\
260e92546251"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyGBCropMaker", "::", "usage"}], "=", 
   "\"\<MyGBCropMaker[myMovieFileName_,mySpotsFileName_, myRefChN_, \
myPadSize_] outputs a list of cropped 2-color green and blue images for each \
spot specified in mySpotsFileName. For each frame of the movie, a single list \
of 2-color cropped images is created, and the output is a list of these \
lists.\nInputs\n1. myMovieFileName: the filename of the 2-color GB movie, \
e.g. MAX_cell01.tif\n2. mySpotsFileName: the filename for the spot positiosn, \
e.g. MAX_cell01_greenspots.dat \n3. myRefChN: the channel corresponding to \
mySpotsFileName, e.g. 1 (green), 2 (blue)\n4. myPadsize: the dimensions of \
the cropped margins. For example, 5 would generate a crop with a 5 pixel \
margin, i.e. a cropped image with dimensions (2*5+1) x (2*5+1) \n\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.747053266671852*^9, 3.74705339901186*^9}, {
  3.747055218934461*^9, 3.747055232582102*^9}, {3.7470568000087595`*^9, 
  3.7470568507781773`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"9cfad160-2352-43c8-ad4d-fbc980ee65f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyGBCropMaker", "[", 
   RowBox[{
   "myMovieFileName_", ",", "mySpotsFileName_", ",", "myRefChN_", ",", 
    "myPadSize_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myMovie", ",", "mySpots", ",", "myGreenSpots", ",", "myBlueSpots", ",", 
      "myGreenCrops", ",", "myBlueCrops", ",", "myOutput", ",", "frameN", ",",
       "spotN"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myMovie", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Import", "[", "myMovieFileName", "]"}], ",", "2"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"This", " ", "assumes", " ", "a", " ", "2"}], "-", 
       RowBox[{"color", " ", "GB", " ", "movie"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mySpots", "=", 
      RowBox[{"<<", 
       RowBox[{"(", "mySpotsFileName", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myGreenSpots", "=", 
      RowBox[{"Ceiling", "[", "mySpots", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myBlueSpots", "=", "myGreenSpots"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myGreenCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myGreenSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myGreenSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myGreenSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myBlueCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myBlueSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myBlueSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myBlueSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myOutput", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "myGreenCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "myBlueCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "myGreenCrops"}], ",", "1"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7464628730256605`*^9, 3.746462941509307*^9}, {
  3.746462991450775*^9, 3.746463000308903*^9}, {3.7464632585098553`*^9, 
  3.7464632589628716`*^9}, {3.746558083095729*^9, 3.7465581031612234`*^9}, {
  3.747054432163316*^9, 3.747054433240097*^9}, {3.7470546136825066`*^9, 
  3.7470546219602804`*^9}, {3.747054736052824*^9, 3.747054742669588*^9}, {
  3.747055092812504*^9, 3.7470551127341566`*^9}, {3.7470552374547715`*^9, 
  3.747055238992902*^9}, {3.7470567954646406`*^9, 3.7470567966676035`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b3b7dc60-8e14-49c1-abb4-93ba328993c0"]
}, Closed]],

Cell[CellGroupData[{

Cell["4. MyRGCropMaker", "Subsubsection",
 CellChangeTimes->{{3.7464495671620884`*^9, 3.7464495737851443`*^9}, {
  3.746451240141878*^9, 3.7464512406359935`*^9}, {3.746557972241897*^9, 
  3.7465579816962357`*^9}, {3.7470534760211163`*^9, 
  3.747053477174821*^9}},ExpressionUUID->"a6ac1f55-e041-4aaf-9f9b-\
a89674d7ac4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyRGCropMaker", "::", "usage"}], "=", 
   "\"\<MyRGCropMaker[myMovieFileName, \
mySpotsFileName,myTF,myRefChN,myCropSize] outputs a list of cropped 2-color \
red and green images for each spot specified in mySpotsFileName. For each \
frame of the movie, a single list of 2-color cropped images is created, and \
the output is a list of these lists.\nInputs\n1. myMovieFileName: the \
filename of the 2-color RG movie, e.g. MAX_cell01.tif\n2. mySpotsFileName: \
the filename for the spot positions, e.g. MAX_cell01_greenspots.dat \n3. \
myTF: the transformation function (usually converts green/blue image \
coordinates to red image coordinates \n4. myRefChN: the channel corresponding \
to mySpotsFileName, e.g. 1 (red), 2 (green)\n5. myPadsize: the dimensions of \
the cropped margins. For example, 5 would generate a crop with a 5 pixel \
margin, i.e. a cropped image with dimensions (2*5+1) x (2*5+1) \n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyRGCropMaker", "[", 
   RowBox[{
   "myMovieFileName_", ",", "mySpotsFileName_", ",", "myTF_", ",", 
    "myRefChN_", ",", "myPadSize_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myMovie", ",", "mySpots", ",", "myInvF", ",", "myRedSpots", ",", 
      "myGreenSpots", ",", "myRedCrops", ",", "myGreenCrops", ",", "myOutput",
       ",", "frameN", ",", "spotN"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myInvF", "=", 
      RowBox[{"InverseFunction", "[", "myTF", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myMovie", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Import", "[", "myMovieFileName", "]"}], ",", "2"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"This", " ", "assumes", " ", "a", " ", "2"}], "-", 
       RowBox[{"color", " ", "RG"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mySpots", "=", 
      RowBox[{"<<", 
       RowBox[{"(", "mySpotsFileName", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myRefChN", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedSpots", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"myInvF", "/@", "mySpots"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myGreenSpots", "=", 
         RowBox[{"Ceiling", "[", "mySpots", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myRefChN", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedSpots", "=", 
         RowBox[{"Ceiling", "[", "mySpots", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myGreenSpots", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"myTF", "/@", "mySpots"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myRedCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myRedSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myRedSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myRedSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myGreenCrops", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"myMovie", "[", 
           RowBox[{"[", 
            RowBox[{"frameN", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"myGreenSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"myPadSize", ",", "myPadSize"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"myGreenSpots", "[", 
              RowBox[{"[", 
               RowBox[{"frameN", ",", "spotN"}], "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myPadSize", "-", "0.1"}], ",", 
               RowBox[{"myPadSize", "-", "0.1"}]}], "}"}]}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"frameN", ",", "1", ",", 
          RowBox[{"Length", "[", "myMovie", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"spotN", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "myGreenSpots", "\[LeftDoubleBracket]", "frameN", 
            "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myOutput", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "myRedCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "myGreenCrops", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "myRedCrops"}], ",", "1"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7458519178036933`*^9, 3.7458520632813377`*^9}, {
   3.7458521049442515`*^9, 3.74585217629611*^9}, {3.7458522330747705`*^9, 
   3.745852447155308*^9}, {3.745852506029435*^9, 3.7458525288793983`*^9}, {
   3.745852669998554*^9, 3.7458527364060783`*^9}, {3.7458528482630186`*^9, 
   3.745852978965003*^9}, {3.745853098974571*^9, 3.745853138429415*^9}, {
   3.745853175173521*^9, 3.7458532994547677`*^9}, {3.7458536813898797`*^9, 
   3.7458538268547845`*^9}, {3.7458538792988896`*^9, 
   3.7458540099443765`*^9}, {3.745854052436186*^9, 3.745854058784972*^9}, {
   3.745854512563048*^9, 3.7458546176255326`*^9}, {3.7458546529055943`*^9, 
   3.7458547729526362`*^9}, {3.745854804235282*^9, 3.745854858774844*^9}, {
   3.7458549062517357`*^9, 3.7458550783945365`*^9}, {3.745855227404073*^9, 
   3.7458552644875584`*^9}, {3.7458554044241104`*^9, 3.745855419125173*^9}, {
   3.7458554526108675`*^9, 3.7458554531094766`*^9}, {3.7458555191607704`*^9, 
   3.7458555290560317`*^9}, {3.7458556522221785`*^9, 3.745855654519553*^9}, {
   3.745855733295171*^9, 3.74585573594094*^9}, 3.745855858868634*^9, {
   3.745856010888579*^9, 3.745856048071333*^9}, {3.7458561088676414`*^9, 
   3.745856119761617*^9}, {3.745856289044778*^9, 3.7458563291166706`*^9}, {
   3.7458564048500667`*^9, 3.7458564836493664`*^9}, {3.7458565301988754`*^9, 
   3.745856635665986*^9}, {3.7458566753531985`*^9, 3.745856785652055*^9}, {
   3.7458568234851623`*^9, 3.7458569489566154`*^9}, {3.745857059827033*^9, 
   3.7458571380847993`*^9}, {3.745857357504737*^9, 3.745857357837981*^9}, {
   3.745857418867024*^9, 3.745857447849612*^9}, {3.7458575695873175`*^9, 
   3.7458575704078736`*^9}, {3.7458576879517126`*^9, 
   3.7458578458161883`*^9}, {3.745857946249809*^9, 3.745857948830464*^9}, {
   3.745858021104472*^9, 3.745858024285194*^9}, 3.745858056311452*^9, {
   3.746449094115302*^9, 3.7464490986802297`*^9}, {3.746463393062771*^9, 
   3.746463393689819*^9}, {3.7464634951952534`*^9, 3.7464635964678683`*^9}, {
   3.7464641635211368`*^9, 3.746464163786908*^9}, {3.7464642081075788`*^9, 
   3.7464642124884663`*^9}, {3.746464306128193*^9, 3.7464643111295266`*^9}, {
   3.746557797774438*^9, 3.7465578311912427`*^9}, {3.747053490821457*^9, 
   3.7470536393088284`*^9}, {3.7470544443150196`*^9, 3.7470544447584853`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"c594ed29-1a37-4970-bb50-36b60408e43e"]
}, Closed]],

Cell[CellGroupData[{

Cell["5. MyRBCropMaker", "Subsubsection",
 CellChangeTimes->{{3.7464495671620884`*^9, 3.7464495737851443`*^9}, {
  3.746451240141878*^9, 3.7464512406359935`*^9}, {3.746557972241897*^9, 
  3.7465579816962357`*^9}, {3.7470534726188765`*^9, 
  3.7470534831987*^9}},ExpressionUUID->"ac356e3e-9f30-4631-afb3-b4b05dcc1c0b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyRBCropMaker", "::", "usage"}], "=", 
   "\"\<MyRBCropMaker[myMovieFileName, \
mySpotsFileName,myTF,myRefChN,myCropSize] outputs a list of cropped 2-color \
red and blue images for each spot specified in mySpotsFileName. For each \
frame of the movie, a single list of 2-color cropped images is created, and \
the output is a list of these lists.\nInputs\n1. myMovieFileName: the \
filename of the 2-color RB movie, e.g. MAX_cell01.tif\n2. mySpotsFileName: \
the filename for the spot positions, e.g. MAX_cell01_bluespots.dat \n3. myTF: \
the transformation function (usually converts green/blue image coordinates to \
red image coordinates \n4. myRefChN: the channel corresponding to \
mySpotsFileName, e.g. 1 (red), 2 (blue)\n5. myPadsize: the dimensions of the \
cropped margins. For example, 5 would generate a crop with a 5 pixel margin, \
i.e. a cropped image with dimensions (2*5+1) x (2*5+1) \n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyRBCropMaker", "[", 
   RowBox[{
   "myMovieFileName_", ",", "mySpotsFileName_", ",", "myTF_", ",", 
    "myRefChN_", ",", "myPadSize_"}], "]"}], ":=", 
  RowBox[{"MyRGCropMaker", "[", 
   RowBox[{
   "myMovieFileName", ",", "mySpotsFileName", ",", "myTF", ",", "myRefChN", 
    ",", "myPadSize"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7458519178036933`*^9, 3.7458520632813377`*^9}, {
   3.7458521049442515`*^9, 3.74585217629611*^9}, {3.7458522330747705`*^9, 
   3.745852447155308*^9}, {3.745852506029435*^9, 3.7458525288793983`*^9}, {
   3.745852669998554*^9, 3.7458527364060783`*^9}, {3.7458528482630186`*^9, 
   3.745852978965003*^9}, {3.745853098974571*^9, 3.745853138429415*^9}, {
   3.745853175173521*^9, 3.7458532994547677`*^9}, {3.7458536813898797`*^9, 
   3.7458538268547845`*^9}, {3.7458538792988896`*^9, 
   3.7458540099443765`*^9}, {3.745854052436186*^9, 3.745854058784972*^9}, {
   3.745854512563048*^9, 3.7458546176255326`*^9}, {3.7458546529055943`*^9, 
   3.7458547729526362`*^9}, {3.745854804235282*^9, 3.745854858774844*^9}, {
   3.7458549062517357`*^9, 3.7458550783945365`*^9}, {3.745855227404073*^9, 
   3.7458552644875584`*^9}, {3.7458554044241104`*^9, 3.745855419125173*^9}, {
   3.7458554526108675`*^9, 3.7458554531094766`*^9}, {3.7458555191607704`*^9, 
   3.7458555290560317`*^9}, {3.7458556522221785`*^9, 3.745855654519553*^9}, {
   3.745855733295171*^9, 3.74585573594094*^9}, 3.745855858868634*^9, {
   3.745856010888579*^9, 3.745856048071333*^9}, {3.7458561088676414`*^9, 
   3.745856119761617*^9}, {3.745856289044778*^9, 3.7458563291166706`*^9}, {
   3.7458564048500667`*^9, 3.7458564836493664`*^9}, {3.7458565301988754`*^9, 
   3.745856635665986*^9}, {3.7458566753531985`*^9, 3.745856785652055*^9}, {
   3.7458568234851623`*^9, 3.7458569489566154`*^9}, {3.745857059827033*^9, 
   3.7458571380847993`*^9}, {3.745857357504737*^9, 3.745857357837981*^9}, {
   3.745857418867024*^9, 3.745857447849612*^9}, {3.7458575695873175`*^9, 
   3.7458575704078736`*^9}, {3.7458576879517126`*^9, 
   3.7458578458161883`*^9}, {3.745857946249809*^9, 3.745857948830464*^9}, {
   3.745858021104472*^9, 3.745858024285194*^9}, 3.745858056311452*^9, {
   3.746449094115302*^9, 3.7464490986802297`*^9}, {3.746463393062771*^9, 
   3.746463393689819*^9}, {3.7464634951952534`*^9, 3.7464635964678683`*^9}, {
   3.7464641635211368`*^9, 3.746464163786908*^9}, {3.7464642081075788`*^9, 
   3.7464642124884663`*^9}, {3.746464306128193*^9, 3.7464643111295266`*^9}, {
   3.746557797774438*^9, 3.7465578311912427`*^9}, {3.7470536596320395`*^9, 
   3.7470537663818307`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"eb29efd3-ca99-462c-9bfd-e821f40607d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["6. MyBandPass", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
  3.746451235258383*^9, 
  3.74645123548956*^9}},ExpressionUUID->"c5912298-d0e6-43f0-baa1-\
e8ece6444db4"],

Cell["Unit Test", "Text",
 CellChangeTimes->{{3.7512957818938007`*^9, 
  3.7512957887118483`*^9}},ExpressionUUID->"16b0fc8d-b854-45e4-88a8-\
78af83994205"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.751295789823555*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"eaa2674f-3f66-4c7f-921f-08797eb11b79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyBandPass", "::", "usage"}], "=", 
   "\"\<MyBandPass[img, {lo, hi}] outputs the input image after it has been \
bandpass filtered such that objects between the size of lo and hi (in pixels) \
are accentuated.\nInputs\n1. img: an image \n2. lo: the lower limit on the \
size of objects to be accentuated \n3. hi: the upper limit on the size of \
objects to be accentuated \n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyBandPass", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        RowBox[{"GaussianMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"hi", ",", "lo"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"imgc", "=", 
        RowBox[{"ImageConvolve", "[", 
         RowBox[{"img", ",", 
          FractionBox[
           RowBox[{"BoxMatrix", "[", "hi", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "hi"}], "+", "1"}], ")"}], "2"]]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        FractionBox[
         RowBox[{"DiskMatrix", "[", "hi", "]"}], 
         RowBox[{"Plus", "@@", 
          RowBox[{"Plus", "@@", 
           RowBox[{"DiskMatrix", "[", "hi", "]"}]}]}]]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"imgb", ",", "imgc"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
  3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
  3.578795266902531*^9}, {3.746450618041257*^9, 3.7464506325390673`*^9}, {
  3.746451229341381*^9, 3.746451233024241*^9}, {3.7464512851329184`*^9, 
  3.746451476184409*^9}, {3.7494086106269345`*^9, 3.749408612465603*^9}, {
  3.7494786662825217`*^9, 3.7494786831055794`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"3f0fcdcc-4965-4109-b6b8-3d9ce86ed438"]
}, Closed]],

Cell[CellGroupData[{

Cell["6 1/2. MyChooseCenterSpot", "Subsubsection",
 CellChangeTimes->{{3.74644963435837*^9, 3.7464496545992503`*^9}, {
  3.7464515291660357`*^9, 3.746451529454561*^9}, {3.7464540171424923`*^9, 
  3.7464540179876747`*^9}, {3.747725280817218*^9, 3.747725283023589*^9}, {
  3.747729327202599*^9, 3.747729327461471*^9}, {3.748886511479189*^9, 
  3.7488865248781023`*^9}, {3.750543212675498*^9, 3.750543214022253*^9}, {
  3.75129600605725*^9, 3.7512960078085403`*^9}, {3.751296123883543*^9, 
  3.751296126534679*^9}, {3.753617688759622*^9, 
  3.753617699172956*^9}},ExpressionUUID->"3d881f04-2327-4591-bbd3-\
37e138762ea3"],

Cell["Unit test: ", "Text",
 CellChangeTimes->{{3.751295562208428*^9, 
  3.7512955633927193`*^9}},ExpressionUUID->"54ce55b7-5d6f-48b8-8959-\
fa0cf7bf8c00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"test", " ", "=", " ", 
  RowBox[{"MyFindParticlesInCrop", "[", 
   RowBox[{
    GraphicsBox[
     TagBox[
      RasterBox[
       RawArray["UnsignedInteger16",{{7155, 12568, 4814, 6893, 13523, 29349, 
        19966, 29967, 20546, 9889, 7361}, {4102, 10376, 12905, 8859, 9421, 
        21857, 37796, 38358, 21651, 10844, 7248}, {12811, 22663, 30473, 24910,
         17119, 36298, 50963, 62201, 24517, 7211, 14759}, {28975, 33582, 
        39407, 27214, 15265, 19011, 23524, 31616, 22382, 18842, 8990}, {22588,
         41730, 65535, 52986, 22344, 23187, 14778, 15602, 18711, 14384, 
        9384}, {9683, 34594, 44090, 48266, 14628, 16089, 14403, 22401, 9159, 
        20134, 16875}, {10357, 14459, 30192, 23262, 22625, 15958, 13879, 
        12530, 23880, 14572, 29237}, {5432, 10376, 16388, 14815, 28244, 19198,
         17943, 10189, 19910, 17962, 29274}, {6930, 4664, 14984, 17081, 21408,
         12043, 13242, 13560, 6106, 17643, 21876}, {2304, 11144, 6630, 6237, 
        5263, 11800, 7492, 14441, 7398, 7754, 6237}, {0, 7866, 8466, 6312, 
        4589, 4083, 3933, 5919, 5544, 10620, 7941}}], {{0, 11}, {11, 0}}, {0, 
       65535},
       ColorFunction->GrayLevel],
      BoxForm`ImageTag[
      "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
       MetaInformation -> 
       Association[
        "Exif" -> Association[
          "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
           "ImageLength" -> 512, "BitsPerSample" -> 16, 
           "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
           "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
           "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
           524288]]],
      Selectable->False],
     DefaultBaseStyle->"ImageGraphics",
     ImageSizeRaw->{11, 11},
     PlotRange->{{0, 11}, {0, 11}}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "100"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"test2", " ", "=", " ", 
  RowBox[{"MyFindParticlesInCrop", "[", 
   RowBox[{
    GraphicsBox[
     TagBox[
      RasterBox[
       RawArray["UnsignedInteger16",{{3096, 5668, 5031, 3961, 3984, 1662, 
        2481, 6465, 8354, 8650, 0}, {8604, 432, 5668, 6988, 6487, 4052, 8764, 
        12975, 2572, 7398, 8035}, {4371, 7307, 615, 4416, 2936, 7148, 10562, 
        9993, 12520, 10972, 7535}, {1662, 5827, 13385, 2823, 5645, 15593, 
        13385, 19599, 12565, 14045, 12087}, {250, 3437, 4393, 9788, 10266, 
        16913, 30867, 43569, 35260, 9242, 3278}, {7216, 6169, 7125, 7944, 
        3870, 31846, 33052, 56885, 57181, 10744, 14591}, {4006, 4075, 7057, 
        3574, 7808, 12269, 29387, 65535, 33098, 17095, 4644}, {12656, 4393, 
        5395, 4393, 5008, 3756, 11951, 16435, 9128, 14750, 9356}, {2345, 5463,
         6670, 11996, 9652, 6192, 9947, 8969, 10107, 13681, 6624}, {8878, 
        4393, 3437, 5691, 13817, 4985, 5167, 6328, 2823, 3301, 5918}, {9424, 
        9060, 2959, 432, 6624, 10608, 7717, 4484, 8445, 10995, 5031}}], {{0, 
       11}, {11, 0}}, {0, 65535},
       ColorFunction->GrayLevel],
      BoxForm`ImageTag[
      "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
       MetaInformation -> 
       Association[
        "Exif" -> Association[
          "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
           "ImageLength" -> 512, "BitsPerSample" -> 16, 
           "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
           "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
           "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
           524288]]],
      Selectable->False],
     DefaultBaseStyle->"ImageGraphics",
     ImageSizeRaw->{11, 11},
     PlotRange->{{0, 11}, {0, 11}}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "100"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MyChooseCenterSpot", "[", 
  RowBox[{"test", ",", "myPadSize"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MyChooseCenterSpot", "[", 
  RowBox[{"test2", ",", "myPadSize"}], "]"}]}], "Input",
 CellChangeTimes->{{3.751295567657413*^9, 3.75129557837805*^9}, 
   3.751295617437869*^9, {3.751295701075728*^9, 3.751295714600861*^9}, {
   3.7512958922153893`*^9, 3.751295913914837*^9}, {3.753616507502112*^9, 
   3.7536165076916313`*^9}, {3.753616547100572*^9, 3.753616547544264*^9}, {
   3.7536182614621277`*^9, 3.7536182741338654`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"eab74794-9c16-4720-a057-37947164b1b5"],

Cell[BoxData[
 RowBox[{"MyFindParticlesInCrop", "[", 
  RowBox[{
   GraphicsBox[
    TagBox[
     RasterBox[
      RawArray["UnsignedInteger16",{{7155, 12568, 4814, 6893, 13523, 29349, 
       19966, 29967, 20546, 9889, 7361}, {4102, 10376, 12905, 8859, 9421, 
       21857, 37796, 38358, 21651, 10844, 7248}, {12811, 22663, 30473, 24910, 
       17119, 36298, 50963, 62201, 24517, 7211, 14759}, {28975, 33582, 39407, 
       27214, 15265, 19011, 23524, 31616, 22382, 18842, 8990}, {22588, 41730, 
       65535, 52986, 22344, 23187, 14778, 15602, 18711, 14384, 9384}, {9683, 
       34594, 44090, 48266, 14628, 16089, 14403, 22401, 9159, 20134, 16875}, {
       10357, 14459, 30192, 23262, 22625, 15958, 13879, 12530, 23880, 14572, 
       29237}, {5432, 10376, 16388, 14815, 28244, 19198, 17943, 10189, 19910, 
       17962, 29274}, {6930, 4664, 14984, 17081, 21408, 12043, 13242, 13560, 
       6106, 17643, 21876}, {2304, 11144, 6630, 6237, 5263, 11800, 7492, 
       14441, 7398, 7754, 6237}, {0, 7866, 8466, 6312, 4589, 4083, 3933, 5919,
        5544, 10620, 7941}}], {{0, 11}, {11, 0}}, {0, 65535},
      ColorFunction->GrayLevel],
     BoxForm`ImageTag[
     "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
      MetaInformation -> 
      Association[
       "Exif" -> Association[
         "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
          "ImageLength" -> 512, "BitsPerSample" -> 16, 
          "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
          "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
          "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
          524288]]],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSizeRaw->{11, 11},
    PlotRange->{{0, 11}, {0, 11}}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "100"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7512957047794333`*^9, 3.7512957148893957`*^9}, {
   3.751295820445321*^9, 3.751295844940707*^9}, {3.7512958926960897`*^9, 
   3.751295914216178*^9}, 3.751296026050949*^9, 3.753055978298764*^9, {
   3.753081068350585*^9, 3.753081088325387*^9}, 3.753082665075179*^9, 
   3.753108880640526*^9, 3.7532733835163803`*^9, 3.753273521372219*^9, {
   3.753616508373513*^9, 3.7536165580372553`*^9}, 3.753616975140527*^9, {
   3.7536170071144123`*^9, 3.753617058461832*^9}, 3.753617213372085*^9, 
   3.75361743460401*^9, 3.7536178971181173`*^9, {3.7536182636383142`*^9, 
   3.753618274425992*^9}, 3.753669595642331*^9, 3.7797367008806677`*^9, 
   3.7802356072601695`*^9, 3.7802356711563067`*^9, 3.8014442957592735`*^9, 
   3.8066830800418797`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"6ab905d5-b9a4-4476-93bc-7f4e5c0758c2"],

Cell[BoxData[
 RowBox[{"MyFindParticlesInCrop", "[", 
  RowBox[{
   GraphicsBox[
    TagBox[
     RasterBox[
      RawArray["UnsignedInteger16",{{3096, 5668, 5031, 3961, 3984, 1662, 2481,
        6465, 8354, 8650, 0}, {8604, 432, 5668, 6988, 6487, 4052, 8764, 12975,
        2572, 7398, 8035}, {4371, 7307, 615, 4416, 2936, 7148, 10562, 9993, 
       12520, 10972, 7535}, {1662, 5827, 13385, 2823, 5645, 15593, 13385, 
       19599, 12565, 14045, 12087}, {250, 3437, 4393, 9788, 10266, 16913, 
       30867, 43569, 35260, 9242, 3278}, {7216, 6169, 7125, 7944, 3870, 31846,
        33052, 56885, 57181, 10744, 14591}, {4006, 4075, 7057, 3574, 7808, 
       12269, 29387, 65535, 33098, 17095, 4644}, {12656, 4393, 5395, 4393, 
       5008, 3756, 11951, 16435, 9128, 14750, 9356}, {2345, 5463, 6670, 11996,
        9652, 6192, 9947, 8969, 10107, 13681, 6624}, {8878, 4393, 3437, 5691, 
       13817, 4985, 5167, 6328, 2823, 3301, 5918}, {9424, 9060, 2959, 432, 
       6624, 10608, 7717, 4484, 8445, 10995, 5031}}], {{0, 11}, {11, 0}}, {0, 
      65535},
      ColorFunction->GrayLevel],
     BoxForm`ImageTag[
     "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
      MetaInformation -> 
      Association[
       "Exif" -> Association[
         "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
          "ImageLength" -> 512, "BitsPerSample" -> 16, 
          "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
          "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
          "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
          524288]]],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSizeRaw->{11, 11},
    PlotRange->{{0, 11}, {0, 11}}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "100"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7512957047794333`*^9, 3.7512957148893957`*^9}, {
   3.751295820445321*^9, 3.751295844940707*^9}, {3.7512958926960897`*^9, 
   3.751295914216178*^9}, 3.751296026050949*^9, 3.753055978298764*^9, {
   3.753081068350585*^9, 3.753081088325387*^9}, 3.753082665075179*^9, 
   3.753108880640526*^9, 3.7532733835163803`*^9, 3.753273521372219*^9, {
   3.753616508373513*^9, 3.7536165580372553`*^9}, 3.753616975140527*^9, {
   3.7536170071144123`*^9, 3.753617058461832*^9}, 3.753617213372085*^9, 
   3.75361743460401*^9, 3.7536178971181173`*^9, {3.7536182636383142`*^9, 
   3.753618274425992*^9}, 3.753669595642331*^9, 3.7797367008806677`*^9, 
   3.7802356072601695`*^9, 3.7802356711563067`*^9, 3.8014442957592735`*^9, 
   3.80668308006183*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"8c5680f7-c1f4-49a7-b4b3-e2d19209ff08"],

Cell[BoxData[
 RowBox[{"MyChooseCenterSpot", "[", 
  RowBox[{
   RowBox[{"MyFindParticlesInCrop", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[
       RasterBox[
        RawArray["UnsignedInteger16",{{7155, 12568, 4814, 6893, 13523, 29349, 
         19966, 29967, 20546, 9889, 7361}, {4102, 10376, 12905, 8859, 9421, 
         21857, 37796, 38358, 21651, 10844, 7248}, {12811, 22663, 30473, 
         24910, 17119, 36298, 50963, 62201, 24517, 7211, 14759}, {28975, 
         33582, 39407, 27214, 15265, 19011, 23524, 31616, 22382, 18842, 
         8990}, {22588, 41730, 65535, 52986, 22344, 23187, 14778, 15602, 
         18711, 14384, 9384}, {9683, 34594, 44090, 48266, 14628, 16089, 14403,
          22401, 9159, 20134, 16875}, {10357, 14459, 30192, 23262, 22625, 
         15958, 13879, 12530, 23880, 14572, 29237}, {5432, 10376, 16388, 
         14815, 28244, 19198, 17943, 10189, 19910, 17962, 29274}, {6930, 4664,
          14984, 17081, 21408, 12043, 13242, 13560, 6106, 17643, 21876}, {
         2304, 11144, 6630, 6237, 5263, 11800, 7492, 14441, 7398, 7754, 
         6237}, {0, 7866, 8466, 6312, 4589, 4083, 3933, 5919, 5544, 10620, 
         7941}}], {{0, 11}, {11, 0}}, {0, 65535},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag[
       "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
        MetaInformation -> 
        Association[
         "Exif" -> Association[
           "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
            "ImageLength" -> 512, "BitsPerSample" -> 16, 
            "PhotometricInterpretation" -> "Black Is Zero", 
            "ImageDescription" -> 
            "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\
\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
            "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
            524288]]],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 11},
      PlotRange->{{0, 11}, {0, 11}}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "100"}], "}"}]}], "]"}], ",", "myPadSize"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.7512957047794333`*^9, 3.7512957148893957`*^9}, {
   3.751295820445321*^9, 3.751295844940707*^9}, {3.7512958926960897`*^9, 
   3.751295914216178*^9}, 3.751296026050949*^9, 3.753055978298764*^9, {
   3.753081068350585*^9, 3.753081088325387*^9}, 3.753082665075179*^9, 
   3.753108880640526*^9, 3.7532733835163803`*^9, 3.753273521372219*^9, {
   3.753616508373513*^9, 3.7536165580372553`*^9}, 3.753616975140527*^9, {
   3.7536170071144123`*^9, 3.753617058461832*^9}, 3.753617213372085*^9, 
   3.75361743460401*^9, 3.7536178971181173`*^9, {3.7536182636383142`*^9, 
   3.753618274425992*^9}, 3.753669595642331*^9, 3.7797367008806677`*^9, 
   3.7802356072601695`*^9, 3.7802356711563067`*^9, 3.8014442957592735`*^9, 
   3.806683080078817*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"029307c9-eee6-4943-b4dc-5fb331e6c795"],

Cell[BoxData[
 RowBox[{"MyChooseCenterSpot", "[", 
  RowBox[{
   RowBox[{"MyFindParticlesInCrop", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[
       RasterBox[
        RawArray["UnsignedInteger16",{{3096, 5668, 5031, 3961, 3984, 1662, 
         2481, 6465, 8354, 8650, 0}, {8604, 432, 5668, 6988, 6487, 4052, 8764,
          12975, 2572, 7398, 8035}, {4371, 7307, 615, 4416, 2936, 7148, 10562,
          9993, 12520, 10972, 7535}, {1662, 5827, 13385, 2823, 5645, 15593, 
         13385, 19599, 12565, 14045, 12087}, {250, 3437, 4393, 9788, 10266, 
         16913, 30867, 43569, 35260, 9242, 3278}, {7216, 6169, 7125, 7944, 
         3870, 31846, 33052, 56885, 57181, 10744, 14591}, {4006, 4075, 7057, 
         3574, 7808, 12269, 29387, 65535, 33098, 17095, 4644}, {12656, 4393, 
         5395, 4393, 5008, 3756, 11951, 16435, 9128, 14750, 9356}, {2345, 
         5463, 6670, 11996, 9652, 6192, 9947, 8969, 10107, 13681, 6624}, {
         8878, 4393, 3437, 5691, 13817, 4985, 5167, 6328, 2823, 3301, 5918}, {
         9424, 9060, 2959, 432, 6624, 10608, 7717, 4484, 8445, 10995, 
         5031}}], {{0, 11}, {11, 0}}, {0, 65535},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag[
       "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
        MetaInformation -> 
        Association[
         "Exif" -> Association[
           "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
            "ImageLength" -> 512, "BitsPerSample" -> 16, 
            "PhotometricInterpretation" -> "Black Is Zero", 
            "ImageDescription" -> 
            "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\
\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
            "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
            524288]]],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 11},
      PlotRange->{{0, 11}, {0, 11}}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "100"}], "}"}]}], "]"}], ",", "myPadSize"}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.7512957047794333`*^9, 3.7512957148893957`*^9}, {
   3.751295820445321*^9, 3.751295844940707*^9}, {3.7512958926960897`*^9, 
   3.751295914216178*^9}, 3.751296026050949*^9, 3.753055978298764*^9, {
   3.753081068350585*^9, 3.753081088325387*^9}, 3.753082665075179*^9, 
   3.753108880640526*^9, 3.7532733835163803`*^9, 3.753273521372219*^9, {
   3.753616508373513*^9, 3.7536165580372553`*^9}, 3.753616975140527*^9, {
   3.7536170071144123`*^9, 3.753617058461832*^9}, 3.753617213372085*^9, 
   3.75361743460401*^9, 3.7536178971181173`*^9, {3.7536182636383142`*^9, 
   3.753618274425992*^9}, 3.753669595642331*^9, 3.7797367008806677`*^9, 
   3.7802356072601695`*^9, 3.7802356711563067`*^9, 3.8014442957592735`*^9, 
   3.8066830800907507`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"ea3afd4f-91b5-4d73-a4cc-440f3a5ec018"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "WOOOOOOO", " ", "WORKSSSSSSS", "\[IndentingNewLine]", "LITTLE", " ", 
    "more", " ", "clunky"}], "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyChooseCenterSpot", "[", 
     RowBox[{"test_", ",", "mypad_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"padcent", ",", "minED"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "test"}], ">", "1"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"padcent", " ", "=", "  ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mypad", "+", ".5"}], ",", 
            RowBox[{"mypad", "+", ".5"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"minED", " ", "=", " ", 
          RowBox[{"Min", " ", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", 
                 RowBox[{"spot", ",", "1"}], "]"}], "]"}], ",", "padcent"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"spot", ",", "1", ",", 
               RowBox[{"Length", "@", "test"}]}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{"test", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "padcent"}], "]"}], 
             "\[Equal]", " ", "minED"}], "&"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.753082849103159*^9, {3.753083605837545*^9, 3.753083610633366*^9}, {
   3.753083650616048*^9, 3.753083655590089*^9}, {3.753083727461885*^9, 
   3.753083731119525*^9}, {3.753083761812976*^9, 3.753083864932261*^9}, {
   3.753083902244712*^9, 3.753083907963311*^9}, 3.7532744438593597`*^9, {
   3.753275787237761*^9, 3.753275885849881*^9}, {3.753275936841522*^9, 
   3.753275951322171*^9}, {3.7532760636067944`*^9, 3.753276087684082*^9}, {
   3.753615208633315*^9, 3.7536152223905497`*^9}, {3.753617223025004*^9, 
   3.753617236836318*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"381ad9ba-dd31-4652-87ad-129b79c0ee48"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyChooseCenterSpot", "::", "usage"}], "=", 
   "\"\<MyChooseCenterSpot[myout,mypadsize] reads in a line on the particle \
finder output, and if there are 2 or more spots detected in the same channel \
crop then it selects the spot nearest to the center of the crop. \nInputs\n1. \
myout: line of particle finder output\n2. mypad: size of the pad of the crop\n\
\n\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.75361773540829*^9, 3.7536178575124617`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"b2a80756-1cec-4af8-85ab-9b164ac666e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "WORKS", " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyChooseCenterSpot", "[", 
    RowBox[{"test_", ",", "mypad_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"padcent", ",", "minED"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "test"}], ">", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"padcent", " ", "=", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mypad", "+", ".5"}], ",", 
           RowBox[{"mypad", "+", ".5"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minED", " ", "=", " ", 
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"test", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "padcent"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Select", "[", 
         RowBox[{"test", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], "\[Equal]", " ", 
            "minED"}], "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", "test"}],
       "\[IndentingNewLine]", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.753082849103159*^9, {3.753083605837545*^9, 3.753083610633366*^9}, {
   3.753083650616048*^9, 3.753083655590089*^9}, {3.753083727461885*^9, 
   3.753083731119525*^9}, {3.753083761812976*^9, 3.753083864932261*^9}, {
   3.753083902244712*^9, 3.753083907963311*^9}, 3.7532744438593597`*^9, {
   3.753275787237761*^9, 3.753275885849881*^9}, {3.753275936841522*^9, 
   3.753275951322171*^9}, {3.7532760636067944`*^9, 3.753276087684082*^9}, {
   3.753615208633315*^9, 3.7536152223905497`*^9}, {3.75361695389297*^9, 
   3.753617056658291*^9}, {3.7536170903560266`*^9, 3.753617090614524*^9}, {
   3.75361713663546*^9, 3.7536171530716*^9}, {3.753617201948367*^9, 
   3.7536172326510067`*^9}, {3.753617726114945*^9, 3.753617729494646*^9}, {
   3.753617893567424*^9, 3.7536178953588667`*^9}, {3.753618312317381*^9, 
   3.753618325331361*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"63e690ab-1d8a-42a3-a14c-ebf0dd881ff9"]
}, Closed]],

Cell[CellGroupData[{

Cell["7. MyFindParticlesInCrop ", "Subsubsection",
 CellChangeTimes->{{3.74644963435837*^9, 3.7464496545992503`*^9}, {
  3.7464515291660357`*^9, 3.746451529454561*^9}, {3.7464540171424923`*^9, 
  3.7464540179876747`*^9}, {3.7500413939640737`*^9, 3.7500414080830917`*^9}, {
  3.750382211307848*^9, 
  3.75038221467835*^9}},ExpressionUUID->"726f0240-b98e-4805-8f4f-\
2ea591701e3f"],

Cell["Unit test: ", "Text",
 CellChangeTimes->{{3.751295562208428*^9, 
  3.7512955633927193`*^9}},ExpressionUUID->"b8991132-c4c3-423d-b7f7-\
14ad857ebcc9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"test", " ", "=", " ", 
  RowBox[{"MyFindParticlesInCrop", "[", 
   RowBox[{
    GraphicsBox[
     TagBox[
      RasterBox[
       RawArray["UnsignedInteger16",{{7155, 12568, 4814, 6893, 13523, 29349, 
        19966, 29967, 20546, 9889, 7361}, {4102, 10376, 12905, 8859, 9421, 
        21857, 37796, 38358, 21651, 10844, 7248}, {12811, 22663, 30473, 24910,
         17119, 36298, 50963, 62201, 24517, 7211, 14759}, {28975, 33582, 
        39407, 27214, 15265, 19011, 23524, 31616, 22382, 18842, 8990}, {22588,
         41730, 65535, 52986, 22344, 23187, 14778, 15602, 18711, 14384, 
        9384}, {9683, 34594, 44090, 48266, 14628, 16089, 14403, 22401, 9159, 
        20134, 16875}, {10357, 14459, 30192, 23262, 22625, 15958, 13879, 
        12530, 23880, 14572, 29237}, {5432, 10376, 16388, 14815, 28244, 19198,
         17943, 10189, 19910, 17962, 29274}, {6930, 4664, 14984, 17081, 21408,
         12043, 13242, 13560, 6106, 17643, 21876}, {2304, 11144, 6630, 6237, 
        5263, 11800, 7492, 14441, 7398, 7754, 6237}, {0, 7866, 8466, 6312, 
        4589, 4083, 3933, 5919, 5544, 10620, 7941}}], {{0, 11}, {11, 0}}, {0, 
       65535},
       ColorFunction->GrayLevel],
      BoxForm`ImageTag[
      "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
       MetaInformation -> 
       Association[
        "Exif" -> Association[
          "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
           "ImageLength" -> 512, "BitsPerSample" -> 16, 
           "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
           "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
           "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
           524288]]],
      Selectable->False],
     DefaultBaseStyle->"ImageGraphics",
     ImageSizeRaw->{11, 11},
     PlotRange->{{0, 11}, {0, 11}}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "100"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"test2", " ", "=", " ", 
  RowBox[{"MyFindParticlesInCrop", "[", 
   RowBox[{
    GraphicsBox[
     TagBox[
      RasterBox[
       RawArray["UnsignedInteger16",{{3096, 5668, 5031, 3961, 3984, 1662, 
        2481, 6465, 8354, 8650, 0}, {8604, 432, 5668, 6988, 6487, 4052, 8764, 
        12975, 2572, 7398, 8035}, {4371, 7307, 615, 4416, 2936, 7148, 10562, 
        9993, 12520, 10972, 7535}, {1662, 5827, 13385, 2823, 5645, 15593, 
        13385, 19599, 12565, 14045, 12087}, {250, 3437, 4393, 9788, 10266, 
        16913, 30867, 43569, 35260, 9242, 3278}, {7216, 6169, 7125, 7944, 
        3870, 31846, 33052, 56885, 57181, 10744, 14591}, {4006, 4075, 7057, 
        3574, 7808, 12269, 29387, 65535, 33098, 17095, 4644}, {12656, 4393, 
        5395, 4393, 5008, 3756, 11951, 16435, 9128, 14750, 9356}, {2345, 5463,
         6670, 11996, 9652, 6192, 9947, 8969, 10107, 13681, 6624}, {8878, 
        4393, 3437, 5691, 13817, 4985, 5167, 6328, 2823, 3301, 5918}, {9424, 
        9060, 2959, 432, 6624, 10608, 7717, 4484, 8445, 10995, 5031}}], {{0, 
       11}, {11, 0}}, {0, 65535},
       ColorFunction->GrayLevel],
      BoxForm`ImageTag[
      "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
       MetaInformation -> 
       Association[
        "Exif" -> Association[
          "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
           "ImageLength" -> 512, "BitsPerSample" -> 16, 
           "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
           "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
           "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
           524288]]],
      Selectable->False],
     DefaultBaseStyle->"ImageGraphics",
     ImageSizeRaw->{11, 11},
     PlotRange->{{0, 11}, {0, 11}}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "100"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"test3", " ", "=", " ", 
  RowBox[{"MyFindParticlesInCrop", "[", 
   RowBox[{
    GraphicsBox[
     TagBox[
      RasterBox[
       RawArray["UnsignedInteger16",{{22746, 18475, 28497, 21264, 20828, 
        14815, 27713, 18650, 24837, 30763, 16994}, {14728, 28410, 20131, 
        65361, 15774, 22658, 23181, 11416, 30066, 47147, 24837}, {21700, 
        10545, 27539, 15164, 18650, 30240, 14118, 41918, 38519, 52550, 
        28846}, {18475, 21961, 35905, 17604, 33378, 32506, 19783, 19783, 
        36863, 21787, 32942}, {15425, 28759, 28149, 11503, 35818, 22833, 
        39129, 2702, 30066, 22571, 47583}, {65535, 42267, 48367, 27103, 26841,
         27626, 21874, 42092, 29456, 28149, 12724}, {17255, 21874, 38084, 
        52376, 11939, 18475, 31373, 32942, 25970, 29979, 32245}, {14292, 
        38955, 29804, 31025, 17168, 27539, 19521, 23530, 47408, 32419, 
        42964}, {25360, 31983, 24488, 35731, 33726, 24227, 29717, 38258, 
        16035, 26580, 34075}, {27974, 17168, 42267, 36428, 31722, 0, 26319, 
        23181, 33290, 42441, 25883}, {21351, 30066, 33378, 28759, 22310, 
        40349, 25360, 34859, 22920, 40001, 34075}}], {{0, 11}, {11, 0}}, {0, 
       65535},
       ColorFunction->GrayLevel],
      BoxForm`ImageTag[
      "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
       MetaInformation -> 
       Association[
        "Exif" -> Association[
          "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
           "ImageLength" -> 512, "BitsPerSample" -> 16, 
           "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
           "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
           "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
           524288]]],
      Selectable->False],
     DefaultBaseStyle->"ImageGraphics",
     ImageSizeRaw->{11, 11},
     PlotRange->{{0, 11}, {0, 11}}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "100"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.751295567657413*^9, 3.75129557837805*^9}, 
   3.751295617437869*^9, {3.751295701075728*^9, 3.751295714600861*^9}, {
   3.7512958922153893`*^9, 3.751295913914837*^9}, {3.753618119424712*^9, 
   3.753618169001027*^9}, 3.753618338771571*^9, {3.753621610658346*^9, 
   3.753621618533081*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"4c17959f-1fb0-479b-85e1-013123874646"],

Cell[BoxData[
 RowBox[{"MyFindParticlesInCrop", "[", 
  RowBox[{
   GraphicsBox[
    TagBox[
     RasterBox[
      RawArray["UnsignedInteger16",{{7155, 12568, 4814, 6893, 13523, 29349, 
       19966, 29967, 20546, 9889, 7361}, {4102, 10376, 12905, 8859, 9421, 
       21857, 37796, 38358, 21651, 10844, 7248}, {12811, 22663, 30473, 24910, 
       17119, 36298, 50963, 62201, 24517, 7211, 14759}, {28975, 33582, 39407, 
       27214, 15265, 19011, 23524, 31616, 22382, 18842, 8990}, {22588, 41730, 
       65535, 52986, 22344, 23187, 14778, 15602, 18711, 14384, 9384}, {9683, 
       34594, 44090, 48266, 14628, 16089, 14403, 22401, 9159, 20134, 16875}, {
       10357, 14459, 30192, 23262, 22625, 15958, 13879, 12530, 23880, 14572, 
       29237}, {5432, 10376, 16388, 14815, 28244, 19198, 17943, 10189, 19910, 
       17962, 29274}, {6930, 4664, 14984, 17081, 21408, 12043, 13242, 13560, 
       6106, 17643, 21876}, {2304, 11144, 6630, 6237, 5263, 11800, 7492, 
       14441, 7398, 7754, 6237}, {0, 7866, 8466, 6312, 4589, 4083, 3933, 5919,
        5544, 10620, 7941}}], {{0, 11}, {11, 0}}, {0, 65535},
      ColorFunction->GrayLevel],
     BoxForm`ImageTag[
     "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
      MetaInformation -> 
      Association[
       "Exif" -> Association[
         "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
          "ImageLength" -> 512, "BitsPerSample" -> 16, 
          "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
          "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
          "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
          524288]]],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSizeRaw->{11, 11},
    PlotRange->{{0, 11}, {0, 11}}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "100"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.753618333370398*^9, 3.753618339086722*^9}, 
   3.753621619162163*^9, {3.753621750929138*^9, 3.7536217690334053`*^9}, 
   3.7536695957551656`*^9, 3.779736700998353*^9, 3.78023560748883*^9, 
   3.7802356712672014`*^9, 3.8014442958990793`*^9, 3.8066830801928825`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"22cf2aba-7c3a-4a4d-9444-bceaaf507d04"],

Cell[BoxData[
 RowBox[{"MyFindParticlesInCrop", "[", 
  RowBox[{
   GraphicsBox[
    TagBox[
     RasterBox[
      RawArray["UnsignedInteger16",{{3096, 5668, 5031, 3961, 3984, 1662, 2481,
        6465, 8354, 8650, 0}, {8604, 432, 5668, 6988, 6487, 4052, 8764, 12975,
        2572, 7398, 8035}, {4371, 7307, 615, 4416, 2936, 7148, 10562, 9993, 
       12520, 10972, 7535}, {1662, 5827, 13385, 2823, 5645, 15593, 13385, 
       19599, 12565, 14045, 12087}, {250, 3437, 4393, 9788, 10266, 16913, 
       30867, 43569, 35260, 9242, 3278}, {7216, 6169, 7125, 7944, 3870, 31846,
        33052, 56885, 57181, 10744, 14591}, {4006, 4075, 7057, 3574, 7808, 
       12269, 29387, 65535, 33098, 17095, 4644}, {12656, 4393, 5395, 4393, 
       5008, 3756, 11951, 16435, 9128, 14750, 9356}, {2345, 5463, 6670, 11996,
        9652, 6192, 9947, 8969, 10107, 13681, 6624}, {8878, 4393, 3437, 5691, 
       13817, 4985, 5167, 6328, 2823, 3301, 5918}, {9424, 9060, 2959, 432, 
       6624, 10608, 7717, 4484, 8445, 10995, 5031}}], {{0, 11}, {11, 0}}, {0, 
      65535},
      ColorFunction->GrayLevel],
     BoxForm`ImageTag[
     "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
      MetaInformation -> 
      Association[
       "Exif" -> Association[
         "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
          "ImageLength" -> 512, "BitsPerSample" -> 16, 
          "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
          "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
          "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
          524288]]],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSizeRaw->{11, 11},
    PlotRange->{{0, 11}, {0, 11}}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "100"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.753618333370398*^9, 3.753618339086722*^9}, 
   3.753621619162163*^9, {3.753621750929138*^9, 3.7536217690334053`*^9}, 
   3.7536695957551656`*^9, 3.779736700998353*^9, 3.78023560748883*^9, 
   3.7802356712672014`*^9, 3.8014442958990793`*^9, 3.806683080197872*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"4b2cb94e-8db0-41c4-b721-430a70511144"],

Cell[BoxData[
 RowBox[{"MyFindParticlesInCrop", "[", 
  RowBox[{
   GraphicsBox[
    TagBox[
     RasterBox[
      RawArray["UnsignedInteger16",{{22746, 18475, 28497, 21264, 20828, 14815,
        27713, 18650, 24837, 30763, 16994}, {14728, 28410, 20131, 65361, 
       15774, 22658, 23181, 11416, 30066, 47147, 24837}, {21700, 10545, 27539,
        15164, 18650, 30240, 14118, 41918, 38519, 52550, 28846}, {18475, 
       21961, 35905, 17604, 33378, 32506, 19783, 19783, 36863, 21787, 
       32942}, {15425, 28759, 28149, 11503, 35818, 22833, 39129, 2702, 30066, 
       22571, 47583}, {65535, 42267, 48367, 27103, 26841, 27626, 21874, 42092,
        29456, 28149, 12724}, {17255, 21874, 38084, 52376, 11939, 18475, 
       31373, 32942, 25970, 29979, 32245}, {14292, 38955, 29804, 31025, 17168,
        27539, 19521, 23530, 47408, 32419, 42964}, {25360, 31983, 24488, 
       35731, 33726, 24227, 29717, 38258, 16035, 26580, 34075}, {27974, 17168,
        42267, 36428, 31722, 0, 26319, 23181, 33290, 42441, 25883}, {21351, 
       30066, 33378, 28759, 22310, 40349, 25360, 34859, 22920, 40001, 
       34075}}], {{0, 11}, {11, 0}}, {0, 65535},
      ColorFunction->GrayLevel],
     BoxForm`ImageTag[
     "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
      MetaInformation -> 
      Association[
       "Exif" -> Association[
         "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
          "ImageLength" -> 512, "BitsPerSample" -> 16, 
          "PhotometricInterpretation" -> "Black Is Zero", "ImageDescription" -> 
          "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\nhyperstack=true\n\
mode=composite\nloop=false\nmin=511.0\nmax=3962.0", "StripOffsets" -> 2659, 
          "SamplesPerPixel" -> 1, "RowsPerStrip" -> 512, "StripByteCounts" -> 
          524288]]],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSizeRaw->{11, 11},
    PlotRange->{{0, 11}, {0, 11}}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10"}], "}"}], ",", "1", ",", "0.2`", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "100"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.753618333370398*^9, 3.753618339086722*^9}, 
   3.753621619162163*^9, {3.753621750929138*^9, 3.7536217690334053`*^9}, 
   3.7536695957551656`*^9, 3.779736700998353*^9, 3.78023560748883*^9, 
   3.7802356712672014`*^9, 3.8014442958990793`*^9, 3.8066830802029133`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"13fe2649-50f6-4d0a-8cce-2bd841c2141f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dimensions", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"6.872725788393357`", ",", "8.67314331031909`"}], "}"}], ",", 
      "0.12712843905603033`", ",", "0.4824292362859541`", ",", 
      "3.9251087205310142`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2.594865013224213`", ",", "6.196829818218111`"}], "}"}], ",", 
      "0.2942327229516736`", ",", "0.3549553673609522`", ",", 
      "6.727061875333791`"}], "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2.594865013224213`", ",", "6.196829818218111`"}], "}"}], ",", 
     "0.2942327229516736`", ",", "0.3549553673609522`", ",", 
     "6.727061875333791`"}], "}"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.753617943389593*^9, 3.7536179799558*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"a2f36a1c-96bf-40d8-a6cc-23cb56620da2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.753617949838036*^9, 3.75361796113914*^9}, 
   3.753617999321844*^9, 3.7536695957975864`*^9, 3.7797367010462255`*^9, 
   3.7802356075171146`*^9, 3.7802356713049517`*^9, 3.8014442959430485`*^9, 
   3.8066830802293186`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"f087f9c6-9613-44a5-b34a-2a1e44609124"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.753617949838036*^9, 3.75361796113914*^9}, 
   3.753617999321844*^9, 3.7536695957975864`*^9, 3.7797367010462255`*^9, 
   3.7802356075171146`*^9, 3.7802356713049517`*^9, 3.8014442959430485`*^9, 
   3.8066830802323103`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"ae47f81e-5066-4ee2-98b7-ed61ea5c70f9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyFindParticlesInCrop", "::", "usage"}], "=", 
   "\"\<MyFindParticlesInCrop[img, {lo, hi}, max, th, {small, large}] outputs \
the input image after it has been bandpass filtered such that objects between \
the size of lo and hi (in pixels) are accentuated.\nInputs\n1. img: an image \
\n2. lo: the lower limit on the size of objects to be accentuated \n3. hi: \
the upper limit on the size of objects to be accentuated \n4. th: the \
threshold\n5. small: the lower limit on the count of pixels after \
binarization\n6. large: the upper limit on the count of pixels after \
binarization\n\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MyFindParticlesInCrop", "[", 
     RowBox[{"img_", ",", 
      RowBox[{"{", 
       RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "th_", ",", 
      RowBox[{"{", 
       RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"imgb", ",", "imgc", ",", "pos", ",", "myout"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imgb", "=", 
        RowBox[{
         RowBox[{"MyBandPass", "[", 
          RowBox[{"img", ",", 
           RowBox[{"{", 
            RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}], "//", 
         "ImageAdjust"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"imgc", "=", 
        RowBox[{"SelectComponents", "[", 
         RowBox[{
          RowBox[{"Binarize", "[", 
           RowBox[{"imgb", ",", " ", "th"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Count\>\"", ",", "\"\<AdjacentBorderCount\>\""}], 
           "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"small", "<", "#1", "<", "large"}], "&&", 
            RowBox[{"#2", "\[Equal]", "0"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myout", "=", 
        RowBox[{"ComponentMeasurements", "[", 
         RowBox[{
          RowBox[{"ImageMultiply", "[", 
           RowBox[{"img", ",", "imgc"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Count\>\"", ",", "\"\<Centroid\>\"", ",", 
            "\"\<Elongation\>\"", ",", "\"\<IntensityCentroid\>\"", ",", 
            "\"\<Mean\>\"", ",", "\"\<Total\>\"", ",", "\"\<MinIntensity\>\"",
             ",", " ", "\"\<MaxIntensity\>\"", ",", 
            "\"\<TotalIntensity\>\""}], "}"}], ",", "All", ",", 
          "\"\<Dataset\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"myout", ",", 
         RowBox[{"img", "//", "ImageAdjust"}], ",", 
         RowBox[{"imgb", "//", "ImageAdjust"}], ",", 
         RowBox[{"imgc", "//", "ImageAdjust"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5751527958022947`*^9, 3.5751528802924128`*^9}, {
   3.575152925492476*^9, 3.575153061152666*^9}, {3.5751531432227807`*^9, 
   3.5751531438627815`*^9}, {3.575153188922845*^9, 3.575153245352924*^9}, {
   3.5751533274730387`*^9, 3.5751533584830823`*^9}, {3.575153416033163*^9, 
   3.575153416743164*^9}, {3.575153718293586*^9, 3.5751537187735863`*^9}, {
   3.575157436595137*^9, 3.575157459425169*^9}, {3.5751582558262844`*^9, 
   3.5751582568962855`*^9}, {3.575166234180505*^9, 3.5751662566605363`*^9}, {
   3.5752405029781218`*^9, 3.5752405155081396`*^9}, 3.5752409476101503`*^9, {
   3.575241075013016*^9, 3.575241093953043*^9}, {3.575241128623091*^9, 
   3.5752411288630915`*^9}, {3.575241197793188*^9, 3.5752411981431885`*^9}, {
   3.5752413495734005`*^9, 3.5752413764734383`*^9}, {3.608917991298159*^9, 
   3.608917992241254*^9}, {3.6464847677413335`*^9, 3.646484783389229*^9}, {
   3.6485836816759624`*^9, 3.648583758596362*^9}, {3.6485838271562834`*^9, 
   3.6485838425561647`*^9}, {3.648584935277664*^9, 3.648584935773693*^9}, {
   3.653239142652603*^9, 3.653239166804985*^9}, {3.653239283964686*^9, 
   3.6532393084690876`*^9}, {3.6550415999770727`*^9, 
   3.6550416069970846`*^9}, {3.655041804633832*^9, 3.655041805772634*^9}, {
   3.6550418792175627`*^9, 3.6550418826339693`*^9}, {3.655059163882098*^9, 
   3.655059163986104*^9}, {3.655059211210805*^9, 3.655059211353813*^9}, {
   3.6552216016280055`*^9, 3.655221607020314*^9}, {3.6552232897335596`*^9, 
   3.6552232946458406`*^9}, {3.6552233416135273`*^9, 3.655223392261424*^9}, {
   3.6552241750611973`*^9, 3.65522418961403*^9}, {3.6553853018305316`*^9, 
   3.6553853463590784`*^9}, {3.7064175117925706`*^9, 
   3.7064175278289895`*^9}, {3.7064175826179943`*^9, 
   3.7064175944213734`*^9}, {3.708250397120329*^9, 3.708250404106188*^9}, {
   3.7082504460739756`*^9, 3.7082504507957506`*^9}, 3.7082516795254517`*^9, {
   3.7082520161449137`*^9, 3.708252025649684*^9}, {3.708252308189315*^9, 
   3.708252309186164*^9}, 3.7082569876100755`*^9, 3.7083825965615287`*^9, {
   3.7464515180572205`*^9, 3.7464515562285194`*^9}, {3.7464521012716465`*^9, 
   3.7464521374715257`*^9}, {3.7464534593990316`*^9, 
   3.7464534659380913`*^9}, {3.7464538846343718`*^9, 
   3.7464538955199833`*^9}, {3.746453976490098*^9, 3.7464540153064103`*^9}, {
   3.7464540548894415`*^9, 3.7464540864387436`*^9}, 3.746454133689786*^9, {
   3.7464541656322346`*^9, 3.74645416730042*^9}, 3.746454212196041*^9, {
   3.7464544683583994`*^9, 3.7464544945649505`*^9}, {3.7464545517986317`*^9, 
   3.7464545735980964`*^9}, {3.7464546645028543`*^9, 
   3.7464546674269953`*^9}, {3.746454720506714*^9, 3.7464547237358923`*^9}, {
   3.746455160227872*^9, 3.7464551603787336`*^9}, 3.74645519806208*^9, {
   3.7464552359116383`*^9, 3.746455236886984*^9}, {3.7464566162188816`*^9, 
   3.7464566203159475`*^9}, {3.746456729226885*^9, 3.746456733473564*^9}, {
   3.746456806645172*^9, 3.746456825234175*^9}, {3.7470103295403814`*^9, 
   3.747010361094475*^9}, 3.747010643435824*^9, {3.7470574260564365`*^9, 
   3.747057458504814*^9}, 3.747057768168931*^9, {3.747057999108574*^9, 
   3.7470580438375173`*^9}, {3.7493277161937714`*^9, 3.749327728408454*^9}, {
   3.7493279018042088`*^9, 3.7493279194832296`*^9}, {3.7493463805208282`*^9, 
   3.749346398750167*^9}, {3.7493464492788734`*^9, 3.7493464548987265`*^9}, {
   3.749391541066494*^9, 3.749391566364748*^9}, {3.7494363464076567`*^9, 
   3.7494363467434473`*^9}, 3.749478718675353*^9, {3.7503823267981825`*^9, 
   3.750382336929203*^9}, {3.751295735993826*^9, 3.751295739228006*^9}, {
   3.751295804065675*^9, 3.7512958064315977`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"19ed8e70-394f-4b72-99e4-397b446d8093"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "MY", " ", "PAD", " ", "SIZE", " ", "ADD", " ", "TO", " ", "INPUTS"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.753617461368554*^9, 3.753617468032721*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a5c2fae7-014d-4e7a-a419-39376726b519"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyFindParticlesInCrop", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"MyBandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"Binarize", "[", 
         RowBox[{"imgb", ",", " ", "th"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Count\>\"", ",", "\"\<AdjacentBorderCount\>\""}], 
         RowBox[{"(*", 
          RowBox[{",", "\"\<\>\""}], "*)"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"small", "<", "#1", "<", "large"}], "&&", 
          RowBox[{"#2", "\[Equal]", "0"}]}], "&"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"&", "#3"}], "&"}], "*)"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myout", "=", 
      RowBox[{
       RowBox[{"ComponentMeasurements", "[", 
        RowBox[{
         RowBox[{"ImageMultiply", "[", 
          RowBox[{"img", ",", "imgc"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<IntensityCentroid\>\"", ",", "\"\<Elongation\>\"", ",", 
           "\"\<MinIntensity\>\"", ",", "\"\<TotalIntensity\>\""}], "}"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "  ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myout", " ", "\[Equal]", " ", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}], ",", 
          "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}], 
        "}"}], 
       RowBox[{"(*", " ", 
        RowBox[{
        "Adds", " ", "a", " ", "blank", " ", "\"\<NaN\>\"", " ", "output", 
         " ", "if", " ", 
         RowBox[{"there", "'"}], "s", " ", "nothing", " ", "in", " ", "the", 
         " ", "crop"}], " ", "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MyChooseCenterSpot", "[", 
        RowBox[{"myout", ",", "myPadSize"}], "]"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{
       "Gets", " ", "rid", " ", "of", " ", "2", " ", "detected", " ", 
        "particles", " ", "in", " ", "the", " ", "same", " ", "crop", " ", 
        "by", " ", "choosing", " ", "only", " ", "the", " ", "center", " ", 
        "one"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.750382233743742*^9, 3.7503822467064424`*^9}, {
   3.7503840061131477`*^9, 3.7503840172989607`*^9}, {3.750384538360248*^9, 
   3.750384540774273*^9}, 3.751295551518074*^9, {3.751295808231139*^9, 
   3.7512958095011806`*^9}, {3.751296152089178*^9, 3.751296169565668*^9}, {
   3.753617297344851*^9, 3.753617306134964*^9}, {3.753617337845126*^9, 
   3.753617418664509*^9}, {3.75361745361897*^9, 3.753617457099786*^9}, {
   3.753617601191329*^9, 3.753617627091037*^9}, {3.753621644366007*^9, 
   3.753621798021625*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"1005b23c-d85f-4df9-8af1-a10777498a55"],

Cell["Unit test: ", "Text",
 CellChangeTimes->{{3.751295562208428*^9, 
  3.7512955633927193`*^9}},ExpressionUUID->"371f534a-ce9f-481e-858d-\
9596ce571d84"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Cases", "[", 
   RowBox[{"test", ",", 
    RowBox[{"x_", "/;", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
      "myCenterParticlePosition"}]}]}], "]"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.751296592494893*^9, 3.75129661097237*^9}, {
  3.7536176680824213`*^9, 3.753617669917354*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"0bb64873-d217-4df4-a104-23082059db38"]
}, Closed]],

Cell[CellGroupData[{

Cell["8. MyCropMaker", "Subsubsection",
 CellChangeTimes->{{3.74644963435837*^9, 3.7464496545992503`*^9}, {
  3.7464515291660357`*^9, 3.746451529454561*^9}, {3.7464540171424923`*^9, 
  3.7464540179876747`*^9}, {3.747725280817218*^9, 3.747725283023589*^9}, {
  3.747729327202599*^9, 
  3.747729327461471*^9}},ExpressionUUID->"35fb4dde-2332-4f1d-933f-\
09ef09c963f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyCropMaker", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<Decides which CropMaker function to use.\nInputs\n1. \
myMovieFileName: the filename of the 3-color RGB movie, e.g. MAX_cell01.tif\n\
3. mySpotsFileName: the filename for the spot positiosn, e.g. \
MAX_cell01_greenspots.dat \n4. myTF: the transformation function (usually \
converts green/blue image coordinates to red image coordinates \n5. myRefChN: \
the channel corresponding to mySpotsFileName, e.g. 1 (red), 2 (green), or 3 \
(blue)\n6. myPadsize: the dimensions of the cropped margins. For example, 5 \
would generate a crop with a 5 pixel margin, i.e. a cropped image with \
dimensions (2*5+1) x (2*5+1) \n7. input: RGB, RG, RB, or GB corresponding to \
the channels in the input file\n\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5751527958022947`*^9, 3.5751528802924128`*^9}, {
   3.575152925492476*^9, 3.575153061152666*^9}, {3.5751531432227807`*^9, 
   3.5751531438627815`*^9}, {3.575153188922845*^9, 3.575153245352924*^9}, {
   3.5751533274730387`*^9, 3.5751533584830823`*^9}, {3.575153416033163*^9, 
   3.575153416743164*^9}, {3.575153718293586*^9, 3.5751537187735863`*^9}, {
   3.575157436595137*^9, 3.575157459425169*^9}, {3.5751582558262844`*^9, 
   3.5751582568962855`*^9}, {3.575166234180505*^9, 3.5751662566605363`*^9}, {
   3.5752405029781218`*^9, 3.5752405155081396`*^9}, 3.5752409476101503`*^9, {
   3.575241075013016*^9, 3.575241093953043*^9}, {3.575241128623091*^9, 
   3.5752411288630915`*^9}, {3.575241197793188*^9, 3.5752411981431885`*^9}, {
   3.5752413495734005`*^9, 3.5752413764734383`*^9}, {3.608917991298159*^9, 
   3.608917992241254*^9}, {3.6464847677413335`*^9, 3.646484783389229*^9}, {
   3.6485836816759624`*^9, 3.648583758596362*^9}, {3.6485838271562834`*^9, 
   3.6485838425561647`*^9}, {3.648584935277664*^9, 3.648584935773693*^9}, {
   3.653239142652603*^9, 3.653239166804985*^9}, {3.653239283964686*^9, 
   3.6532393084690876`*^9}, {3.6550415999770727`*^9, 
   3.6550416069970846`*^9}, {3.655041804633832*^9, 3.655041805772634*^9}, {
   3.6550418792175627`*^9, 3.6550418826339693`*^9}, {3.655059163882098*^9, 
   3.655059163986104*^9}, {3.655059211210805*^9, 3.655059211353813*^9}, {
   3.6552216016280055`*^9, 3.655221607020314*^9}, {3.6552232897335596`*^9, 
   3.6552232946458406`*^9}, {3.6552233416135273`*^9, 3.655223392261424*^9}, {
   3.6552241750611973`*^9, 3.65522418961403*^9}, {3.6553853018305316`*^9, 
   3.6553853463590784`*^9}, {3.7064175117925706`*^9, 
   3.7064175278289895`*^9}, {3.7064175826179943`*^9, 
   3.7064175944213734`*^9}, {3.708250397120329*^9, 3.708250404106188*^9}, {
   3.7082504460739756`*^9, 3.7082504507957506`*^9}, 3.7082516795254517`*^9, {
   3.7082520161449137`*^9, 3.708252025649684*^9}, {3.708252308189315*^9, 
   3.708252309186164*^9}, 3.7082569876100755`*^9, 3.7083825965615287`*^9, {
   3.7464515180572205`*^9, 3.7464515562285194`*^9}, {3.7464521012716465`*^9, 
   3.7464521374715257`*^9}, {3.7464534593990316`*^9, 
   3.7464534659380913`*^9}, {3.7464538846343718`*^9, 
   3.7464538955199833`*^9}, {3.746453976490098*^9, 3.7464540153064103`*^9}, {
   3.7464540548894415`*^9, 3.7464540864387436`*^9}, 3.746454133689786*^9, {
   3.7464541656322346`*^9, 3.74645416730042*^9}, 3.746454212196041*^9, {
   3.7464544683583994`*^9, 3.7464544945649505`*^9}, {3.7464545517986317`*^9, 
   3.7464545735980964`*^9}, {3.7464546645028543`*^9, 
   3.7464546674269953`*^9}, {3.746454720506714*^9, 3.7464547237358923`*^9}, {
   3.746455160227872*^9, 3.7464551603787336`*^9}, 3.74645519806208*^9, {
   3.7464552359116383`*^9, 3.746455236886984*^9}, {3.7464566162188816`*^9, 
   3.7464566203159475`*^9}, {3.746456729226885*^9, 3.746456733473564*^9}, {
   3.746456806645172*^9, 3.746456825234175*^9}, {3.7470103295403814`*^9, 
   3.747010361094475*^9}, 3.747010643435824*^9, {3.7470574260564365`*^9, 
   3.747057458504814*^9}, 3.747057768168931*^9, {3.747057999108574*^9, 
   3.7470580438375173`*^9}, {3.747724283623608*^9, 3.747724447223867*^9}, {
   3.747724479399426*^9, 3.747724483981615*^9}, {3.747724517759342*^9, 
   3.747724524608004*^9}, {3.7477248915715303`*^9, 3.747724930690443*^9}, {
   3.747725031328712*^9, 3.747725143760057*^9}, {3.747725178755452*^9, 
   3.747725197324498*^9}, {3.7477252354772377`*^9, 3.7477252650050097`*^9}, {
   3.747725298825385*^9, 3.747725357839999*^9}, {3.747725389564856*^9, 
   3.7477254199530478`*^9}, {3.7477254731074743`*^9, 3.747725511880824*^9}, {
   3.747725552675132*^9, 3.747725587166404*^9}, {3.747726741806274*^9, 
   3.7477267941441317`*^9}, {3.747726974789653*^9, 3.747726990331839*^9}, {
   3.7477273680924377`*^9, 3.7477274294072037`*^9}, {3.747728553557353*^9, 
   3.7477285584195957`*^9}, {3.747728993079495*^9, 3.747729045096244*^9}, {
   3.7477294462625427`*^9, 3.747729503484128*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"19b42f68-f1fe-465b-aa1a-33cec54bc0ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCropMaker", "[", 
   RowBox[{
   "myMovieFileName_", ",", "mySpotsFileName_", ",", "myTF_", ",", 
    "myRefChN_", ",", "myPadSize_", ",", "mycolors_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myMovie", ",", "mySpots", ",", "myInvF", ",", "myRedSpots", ",", 
      "myGreenSpots", ",", "myBlueSpots", ",", "myRedCrops", ",", 
      "myGreenCrops", ",", "myBlueCrops", ",", "myOutput", ",", "frameN", ",",
       "spotN"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"mycolors", " ", "==", "\"\<RGB\>\""}], ",", " ", 
      RowBox[{"MyRGBCropMaker", "[", 
       RowBox[{
       "myMovieFileName", ",", "mySpotsFileName", ",", "myTF", ",", 
        "myRefChN", ",", "myPadSize"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"mycolors", " ", "==", "\"\<RG\>\""}], ",", " ", 
      RowBox[{"MyRGCropMaker", "[", 
       RowBox[{
       "myMovieFileName", ",", "mySpotsFileName", ",", "myTF", ",", 
        "myRefChN", ",", "myPadSize"}], "]"}], " ", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mycolors", " ", "==", "\"\<RB\>\""}], ",", " ", 
      RowBox[{"MyRBCropMaker", "[", 
       RowBox[{
       "myMovieFileName", ",", "mySpotsFileName", ",", "myTF", ",", 
        "myRefChN", ",", "myPadSize"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"mycolors", " ", "==", "\"\<GB\>\""}], ",", " ", 
      RowBox[{"MyGBCropMaker", "[", 
       RowBox[{
       "myMovieFileName", ",", "mySpotsFileName", ",", "myRefChN", ",", 
        "myPadSize"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.74772755557854*^9, 3.74772763098219*^9}, {
   3.7477276990373077`*^9, 3.747727822714205*^9}, 3.747727900803089*^9, {
   3.747728143410343*^9, 3.747728178207623*^9}, {3.747729520897545*^9, 
   3.747729526466655*^9}, {3.7488851533862257`*^9, 3.748885195518326*^9}, {
   3.74940802465746*^9, 3.749408049976418*^9}, {3.7500813476183805`*^9, 
   3.7500813483182364`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"05404d22-ee0a-47d4-9c6b-12f130d3ff4e"]
}, Closed]],

Cell[CellGroupData[{

Cell["9. MySpotCaller", "Subsubsection",
 CellChangeTimes->{{3.74644963435837*^9, 3.7464496545992503`*^9}, {
  3.7464515291660357`*^9, 3.746451529454561*^9}, {3.7464540171424923`*^9, 
  3.7464540179876747`*^9}, {3.747725280817218*^9, 3.747725283023589*^9}, {
  3.747729327202599*^9, 3.747729327461471*^9}, {3.748886511479189*^9, 
  3.7488865248781023`*^9}, {3.750543212675498*^9, 
  3.750543214022253*^9}},ExpressionUUID->"da8b36c6-f116-497a-be6d-\
17aa0616882e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MySpotCaller", "[", 
   RowBox[{"myCrop_", ",", "mycolors_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myCrops", ",", "myColors"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RGB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "check", " ", "if", " ", "a", " ", "particle", " ", "is", " ", 
           "detected", " ", "in", " ", "channel", " ", "1", " ", "ie", " ", 
           "red"}], "*)"}], "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{
          "check", " ", "if", " ", "a", " ", "particle", " ", "is", " ", 
           "detected", " ", "in", " ", "channnel", " ", "2", " ", "ie", " ", 
           "green"}], "*)"}], "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "check", " ", "if", " ", "a", " ", "particle", " ", "is", " ", 
          "deteced", " ", "in", " ", "channel", " ", "3", " ", "ie", " ", 
          "blue"}], "*)"}], ",", "\"\<RGB\>\"", ",", "\[IndentingNewLine]", 
        "                  ", 
        RowBox[{
         RowBox[{"mycolors", "==", "\"\<RG\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<RG\>\"", ",", 
        "\[IndentingNewLine]", "                  ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RGB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<RG\>\"", ",", 
        "\[IndentingNewLine]", "                  ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<GB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<GB\>\"", ",", 
        "\[IndentingNewLine]", "                  ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<RB\>\"", ",", 
        "\[IndentingNewLine]", "                      ", 
        RowBox[{
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<RB\>\"", ",", 
        "\[IndentingNewLine]", "                      ", 
        RowBox[{
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<GB\>\"", ",", 
        "\[IndentingNewLine]", "                          ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RGB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<R\>\"", ",", "\n", 
        "                                    ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RG\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<R\>\"", ",", 
        "\[IndentingNewLine]", "                          ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<R\>\"", ",", 
        "\[IndentingNewLine]", "                          ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<GB\>\""}], " ", "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<G\>\"", ",", 
        "\[IndentingNewLine]", "                          ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<B\>\""}], "&&", " ", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<B\>\"", ",", 
        "\[IndentingNewLine]", "                               ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RG\>\""}], "||", " ", 
         RowBox[{
          RowBox[{"mycolors", "\[Equal]", "\"\<RGB\>\""}], " ", "&&", 
          RowBox[{"NumericQ", "[", 
           RowBox[{"myCrop", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
            "\[RightDoubleBracket]"}], "]"}]}]}], ",", "\"\<G\>\"", ",", 
        "\[IndentingNewLine]", "                               ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<RB\>\""}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<B\>\"", ",", 
        "\[IndentingNewLine]", "                               ", 
        RowBox[{
         RowBox[{"mycolors", "\[Equal]", "\"\<GB\>\""}], "&&", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"myCrop", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1", ",", "1"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "\"\<B\>\"", ",", 
        "\[IndentingNewLine]", "                                   ", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"myCrop", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}], "]"}], " ", ",", "\"\<B\>\""}], "]"}], 
      ")"}], "\[IndentingNewLine]", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.749433307723404*^9, 3.7494334004963737`*^9}, {
   3.7494334828942204`*^9, 3.749433485984445*^9}, {3.7494355861490397`*^9, 
   3.749435624229737*^9}, {3.7494359465400047`*^9, 3.7494359872181215`*^9}, {
   3.7494361833669004`*^9, 3.7494362511654444`*^9}, {3.74947185925597*^9, 
   3.749471892147628*^9}, {3.7494722201324167`*^9, 3.7494722547224894`*^9}, {
   3.7494727238396835`*^9, 3.7494727448208213`*^9}, {3.749478819579434*^9, 
   3.749478827921374*^9}, {3.7494788885240116`*^9, 3.7494789171979685`*^9}, {
   3.7494813535987864`*^9, 3.7494816467534585`*^9}, {3.7494817010630684`*^9, 
   3.7494817561473246`*^9}, {3.7500129629188304`*^9, 3.750012999084445*^9}, {
   3.7500131356890783`*^9, 3.75001314041527*^9}, {3.750014882666091*^9, 
   3.750014918050786*^9}, {3.7500169478696375`*^9, 3.750016963994465*^9}, {
   3.750016996020827*^9, 3.7500170638645544`*^9}, {3.7500346535370736`*^9, 
   3.750034732499434*^9}, {3.7500347850647163`*^9, 3.750034908984634*^9}, {
   3.7500349923295155`*^9, 3.7500350371647606`*^9}, {3.750035225138342*^9, 
   3.75003525367692*^9}, {3.7500353408624554`*^9, 3.750035386766651*^9}, {
   3.750036777446439*^9, 3.750036791712124*^9}, 3.750036835901851*^9, {
   3.7500369221386747`*^9, 3.7500369615096426`*^9}, {3.750039511059765*^9, 
   3.750039546296157*^9}, {3.75003958734542*^9, 3.7500396126690283`*^9}, {
   3.7500833172869525`*^9, 3.750083318958131*^9}, {3.750083690561072*^9, 
   3.7500836917892942`*^9}, {3.750381674653881*^9, 3.750381752257071*^9}, {
   3.750381782843645*^9, 3.7503819024475527`*^9}, {3.750381983483562*^9, 
   3.7503820654725876`*^9}, {3.7503826770357485`*^9, 
   3.7503826804990883`*^9}, {3.750383029697449*^9, 3.7503830333941345`*^9}, {
   3.750545386936795*^9, 3.7505454371697206`*^9}, {3.750545479752575*^9, 
   3.7505455214224987`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8e19dd60-9f0d-49b6-a5ab-aaf63c76b9ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["10. MyParticleFinder", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
  3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
  3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
  3.750950049325511*^9, 3.750950052579129*^9}, {3.750951082292624*^9, 
  3.750951122460825*^9}, {3.750951299693718*^9, 3.750951303356394*^9}, {
  3.7512442041620617`*^9, 3.751244205249435*^9}, {3.752151440390341*^9, 
  3.752151445002593*^9}, {3.753057081291624*^9, 3.7530570855176163`*^9}, {
  3.753070156624681*^9, 3.7530701606659203`*^9}, {3.753070219006833*^9, 
  3.7530702226236153`*^9}, {3.753072443643929*^9, 3.75307244792787*^9}, {
  3.753618666320937*^9, 
  3.753618671287779*^9}},ExpressionUUID->"c14523ab-eeb3-4987-aa1f-\
11ed9cc449c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyParticleFinder", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}], ",", "myColors_"}], "]"}], " ",
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgmask", ",", " ", "centroid", ",", "call", ",", "output"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgmask", "=", 
      RowBox[{"ColorNegate", "[", 
       RowBox[{"ImageMultiply", "[", 
        RowBox[{
         RowBox[{
         "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         "0"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"centroid", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MyFindParticlesInCrop", "[", 
         RowBox[{
          RowBox[{
          "img", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"lo", ",", "hi"}], "}"}], ",", "max", ",", "th", ",", 
          RowBox[{"{", 
           RowBox[{"small", ",", "large"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "img"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"call", " ", "=", " ", 
      RowBox[{"MySpotCaller", "[", 
       RowBox[{"centroid", ",", "myColors"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", 
      RowBox[{"{", " ", 
       RowBox[{"img", ",", "call", ",", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"centroid", ",", "1"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "/.", " ", 
       RowBox[{"Null", "\[Rule]", " ", "\"\<NaN\>\""}]}], "//", 
      RowBox[{
       RowBox[{"#", " ", "/.", " ", 
        RowBox[{
         RowBox[{"{", "}"}], " ", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}], ",", 
            "\"\<NaN\>\"", ",", "\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}], 
          "}"}]}]}], "&"}]}]}]}], "  ", "\[IndentingNewLine]", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"output", "/.", " ", 
      RowBox[{"Null", "\[Rule]", " ", "\[Placeholder]"}]}], "//", 
     RowBox[{
      RowBox[{"#", " ", "/.", " ", 
       RowBox[{
        RowBox[{"{", "}"}], " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Placeholder]", ",", "\[Placeholder]"}], "}"}], ",", 
           "\[Placeholder]", ",", "\[Placeholder]", ",", "\[Placeholder]"}], 
          "}"}], "}"}]}]}], "&"}]}], "   ", "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.749432934345498*^9, 3.7494329478130827`*^9}, {
   3.7494335040003605`*^9, 3.7494335351134634`*^9}, 3.750382427128169*^9, {
   3.750382690623907*^9, 3.750382696333502*^9}, {3.7503830507784224`*^9, 
   3.7503830562785625`*^9}, {3.7505434399143972`*^9, 
   3.7505434504219627`*^9}, {3.750557728444522*^9, 3.7505577454936333`*^9}, {
   3.7505577804812517`*^9, 3.750557811437551*^9}, {3.750557981519635*^9, 
   3.750557984127006*^9}, {3.750605918505365*^9, 3.7506059492648287`*^9}, {
   3.750605980193695*^9, 3.7506059891889553`*^9}, {3.751246767376725*^9, 
   3.7512467780184383`*^9}, {3.751253719363647*^9, 3.751253733455958*^9}, 
   3.75129595549966*^9, {3.751296054805956*^9, 3.7512960583640614`*^9}, {
   3.751296116933556*^9, 3.751296118629974*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"4c817102-a726-4f44-b80d-104f4aab69e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["11. MyBarcoder", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
  3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
  3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
  3.750950049325511*^9, 3.750950052579129*^9}, {3.750951082292624*^9, 
  3.750951122460825*^9}, {3.750951299693718*^9, 3.750951303356394*^9}, {
  3.7512442041620617`*^9, 3.751244205249435*^9}, {3.752151440390341*^9, 
  3.752151445002593*^9}, {3.753057081291624*^9, 3.7530570855176163`*^9}, {
  3.753070156624681*^9, 3.7530701606659203`*^9}, {3.753070219006833*^9, 
  3.7530702226236153`*^9}, {3.753072443643929*^9, 
  3.75307244792787*^9}},ExpressionUUID->"5c6a7fc2-3a8a-4d20-9c5e-\
257042d62bb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyBarcoder", "[", "spotsdata_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"step0", ",", "step1", ",", "step2", ",", "step3"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"step0", "=", " ", 
      RowBox[{"spotsdata", "/.", 
       RowBox[{
        RowBox[{"{", "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<NaN\>\"", ",", "\"\<NaN\>\""}], "}"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"step1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "#", "}"}], "}"}], "&"}], "/@", "#"}], "&"}], "/@", 
       "step0"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"step2", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#", ",", "i"}], "]"}], "&"}], "/@", 
         RowBox[{
         "step1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "spotsdata"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"step3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"step2", "\[LeftDoubleBracket]", 
             RowBox[{"frame", ",", "spot"}], "\[RightDoubleBracket]"}], ",", 
            "spot"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"spot", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "step2", "\[LeftDoubleBracket]", "frame", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"frame", ",", "1", ",", 
          RowBox[{"Length", "@", "step2"}], ",", "1"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.753063196680681*^9, 3.75306321091241*^9}, {
  3.753070207729583*^9, 3.753070208519713*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"2809f9be-f5c2-4487-8eb2-f6ea2da99962"]
}, Closed]],

Cell[CellGroupData[{

Cell["12. MyDiskDonutMask VERSION2 (less flexibility)", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
  3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
  3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
  3.750950049325511*^9, 3.750950052579129*^9}, {3.750951082292624*^9, 
  3.750951122460825*^9}, {3.750951299693718*^9, 3.750951303356394*^9}, {
  3.7512442041620617`*^9, 3.751244205249435*^9}, {3.752151440390341*^9, 
  3.752151445002593*^9}},ExpressionUUID->"699221ed-a096-481a-a234-\
a9e06d7f651c"],

Cell["Module Unit Test input : ", "Text",
 CellChangeTimes->{{3.750954857477921*^9, 
  3.750954876337336*^9}},ExpressionUUID->"e65ac98b-23da-4846-8a92-\
5b448e0c344c"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{"MyDiskDonutMask", "[", 
   RowBox[{"myPadSize", ",", "2"}], "]"}], "  ", "*)"}]], "Input",
 CellChangeTimes->{{3.750954951824719*^9, 3.750954953935198*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"34e4572b-0ad1-4b24-a971-696a2ea0cad1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyDiskDonutMask", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<Makes a disk and donut mask based on size constraints that the user \
provides. Output:  {\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, \
12}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, 12}}]\)}\nInputs\n1. myPadSize: how big you \
want the crop to be. Should match the size of your crops.\n2. donutRadius: \
Diff Lim Spot, use 2 or 3\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyDiskDonutMask", "[", 
   RowBox[{"myPadSize_", ",", "donutRadius_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mycent", ",", "mydonut"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mycent", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"DiskMatrix", "[", 
        RowBox[{"donutRadius", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "myPadSize"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"2", "*", "myPadSize"}], "+", "1"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mydonut", "=", 
      RowBox[{"Image", "[", 
       RowBox[{
        RowBox[{"DiskMatrix", "[", 
         RowBox[{"myPadSize", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}]}], "}"}]}], "]"}], 
        "-", 
        RowBox[{"DiskMatrix", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"donutRadius", "+", "1"}], ")"}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"without", " ", "added", " ", "1"}], ",", " ", 
            RowBox[{
            "the", " ", "donut", " ", "will", " ", "exactly", " ", "nest", 
             " ", "within", " ", "the", " ", 
             RowBox[{"disk", ".", " ", "However"}]}], ",", " ", 
            RowBox[{
            "adding", " ", "1", " ", "here", " ", "adds", " ", "a", " ", "1", 
             " ", "pixel", " ", "pad", " ", "to", " ", "acount", " ", "for", 
             " ", "residual", " ", "brightness", " ", "from", " ", "the", " ", 
             RowBox[{"DLS", "'"}], "s", " ", "tails", " ", "of", " ", "the", 
             " ", "gaussian"}]}], "*)"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mycent", ",", "mydonut"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
   3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
   3.578795266902531*^9}, {3.746450618041257*^9, 3.7464506325390673`*^9}, {
   3.746451229341381*^9, 3.746451233024241*^9}, {3.7464512851329184`*^9, 
   3.746451476184409*^9}, {3.7494086106269345`*^9, 3.749408612465603*^9}, {
   3.7494786662825217`*^9, 3.7494786831055794`*^9}, {3.750949144621682*^9, 
   3.750949171539495*^9}, {3.750949202634305*^9, 3.7509492065697823`*^9}, {
   3.750949249498136*^9, 3.75094935832798*^9}, {3.7509495261099157`*^9, 
   3.7509497203736343`*^9}, {3.750949984139188*^9, 3.75095000820501*^9}, {
   3.75095052843073*^9, 3.7509509891151323`*^9}, {3.750951130191716*^9, 
   3.750951285153647*^9}, 3.751244210989418*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"aeabe348-cb90-4205-b9ba-075fe4c91b03"]
}, Closed]],

Cell[CellGroupData[{

Cell["13. MyDiskDonutCentered", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
  3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
  3.7509491388134403`*^9}, {3.750950512193235*^9, 3.750950512888213*^9}, {
  3.750951457307918*^9, 
  3.75095145745465*^9}},ExpressionUUID->"7f8cbe35-642c-46f9-ad03-\
e5070d4766d0"],

Cell["Module Unit Test input : ", "Text",
 CellChangeTimes->{{3.750954857477921*^9, 
  3.750954876337336*^9}},ExpressionUUID->"2d2427d7-043f-4260-9edc-\
381b7f840861"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MyDiskDonutCentered", "[", 
   RowBox[{"5", ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}], "  "}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"7b641c58-a6df-4b67-b9ee-dfaa32a121a6"],

Cell[BoxData[
 RowBox[{"MyDiskDonutCentered", "[", 
  RowBox[{"5", ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7512945049316473`*^9, 3.752151453748416*^9, 
  3.7530573885401154`*^9, 3.753070568297056*^9, 3.753081067821525*^9, 
  3.7531088795007057`*^9, 3.753273382926766*^9, 3.7536165381344643`*^9, 
  3.753626577147461*^9, 3.7536695962084303`*^9, 3.779736701321489*^9, 
  3.780235607867026*^9, 3.780235671629732*^9, 3.801444296342518*^9, 
  3.8066830805403748`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"b0d2686d-21ae-4c28-908f-0c8938c95f1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyDiskDonutCentered", "[", 
   RowBox[{"5", ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyDiskDonutCentered", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Placeholder", "[", "]"}], ",", 
      RowBox[{"Placeholder", "[", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSize->{Automatic, 24.},
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}], "  "}]}], "Input",
 CellChangeTimes->{{3.750955060199387*^9, 3.7509551190982122`*^9}, {
   3.7512470083785543`*^9, 3.751247010008852*^9}, {3.7512475305735817`*^9, 
   3.751247561120721*^9}, {3.751247609681673*^9, 3.7512476300462103`*^9}, {
   3.751286511380637*^9, 3.751286511658519*^9}, {3.751294492947831*^9, 
   3.751294494668882*^9}, 3.752151647269643*^9, {3.753626574022758*^9, 
   3.7536265743552628`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"875fd433-e4e9-4be2-9ed6-122a2a801260"],

Cell[BoxData[
 RowBox[{"MyDiskDonutCentered", "[", 
  RowBox[{"5", ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7536265787554913`*^9, 3.7536695962396564`*^9, 
  3.779736701426238*^9, 3.7802356078982687`*^9, 3.7802356716534667`*^9, 
  3.8014442964303966`*^9, 3.8066830806105614`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"04d30448-b42c-4071-8976-ff22a2d16c98"],

Cell[BoxData[
 RowBox[{"MyDiskDonutCentered", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Placeholder]", ",", "\[Placeholder]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSize->{Automatic, 24.},
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7536265787554913`*^9, 3.7536695962396564`*^9, 
  3.779736701426238*^9, 3.7802356078982687`*^9, 3.7802356716534667`*^9, 
  3.8014442964303966`*^9, 3.806683080615576*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"2358fe0d-2f49-4bbd-8c78-501660a1597e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyDiskDonutCentered", "::", "usage"}], "=", 
    "\[IndentingNewLine]", 
    "\"\<Uses masks for the disk and donut, \
{\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, \
12}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, 12}}]\)}, then pads them to center them \
around the centroid, such as this: \
{\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSFIMiAUZRsEoGAWj
YBSMglEweMAHe+z0QNtPb/eMuoM094yC4Q4A5vchAQ==
\"], {{0, 22}, {17, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
17, 22},PlotRange->{{0, 17}, {0, \
22}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSFIMiAUZRsEoGAWj
YBSMgoEAH+yJo+llP6XqaGU/rd1DqTmj7qCtOwY6fZBq7kDlX3qXH/QHAA+k
LgY=
\"], {{0, 22}, {17, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
17, 22},PlotRange->{{0, 17}, {0, 22}}]\)}. \n\nInputs\n1. myPadSize, number \
with pixel units, ex: 5\n2. centroid {x,y}, ex.:  {-1,1} \n3. masks \
{disk,donut}, ex.:  {\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, \
12}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, 12}}]\)}\n\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "THIS", " ", "FXN", " ", "uses", " ", "a", " ", "centroid", " ", "input", 
     " ", "as", " ", "g", " ", "and", " ", "h"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"INSTEAD", " ", "OF", " ", 
        RowBox[{"{", 
         RowBox[{"g", ",", "h"}], "}"}]}], " ", "..."}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MyDiskDonutCentered", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"g_", ",", "h_"}], "}"}], ",", "myDiskDonut_"}], "]"}]}], 
     " ", ":=", "\[IndentingNewLine]", " ", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "\[LessEqual]", " ", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[GreaterEqual]", " ", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "g"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "h"}]}], "}"}]}], "}"}]}], "]"}], "&"}], "/@", 
        "myDiskDonut"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "\[LessEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[LessEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "g"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "h"}], ",", "0"}], "}"}]}], "}"}]}], 
          "]"}], "&"}], "/@", "myDiskDonut"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[GreaterEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "g"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "h"}]}], "}"}]}], "}"}]}], "]"}], "&"}], "/@", 
        "myDiskDonut"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[LessEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "g"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "h"}], ",", "0"}], "}"}]}], "}"}]}], 
          "]"}], "&"}], "/@", "myDiskDonut"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MyDiskDonutCentered", "[", 
     RowBox[{"centroid_", ",", "myDiskDonut_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", "h"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"g", ",", "h"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"centroid", "  ", "-", 
          RowBox[{"{", 
           RowBox[{".5", ",", ".5"}], "}"}]}], "//", 
         RowBox[{
          RowBox[{"Ceiling", "@", "#"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberQ", "[", "g", "]"}], "\[Equal]", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"g", "\[LessEqual]", " ", "0"}], " ", "&&", " ", 
            RowBox[{"h", "\[GreaterEqual]", " ", "0"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImagePad", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", ".5"}], "g"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{".5", "h"}]}], "}"}]}], "}"}]}], "]"}], "&"}], "/@",
             "myDiskDonut"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"g", "\[LessEqual]", "0"}], " ", "&&", " ", 
            RowBox[{"h", "\[LessEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImagePad", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", ".5"}], "g"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", ".5"}], "h"}], ",", "0"}], "}"}]}], "}"}]}], 
              "]"}], "&"}], "/@", "myDiskDonut"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
            RowBox[{"h", "\[GreaterEqual]", "0"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImagePad", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{".5", "g"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{".5", "h"}]}], "}"}]}], "}"}]}], "]"}], "&"}], "/@",
             "myDiskDonut"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
            RowBox[{"h", "\[LessEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImagePad", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{".5", "g"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", ".5"}], "h"}], ",", "0"}], "}"}]}], "}"}]}], 
              "]"}], "&"}], "/@", "myDiskDonut"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "   ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
   3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
   3.578795266902531*^9}, {3.746450618041257*^9, 3.7464506325390673`*^9}, {
   3.746451229341381*^9, 3.746451233024241*^9}, {3.7464512851329184`*^9, 
   3.746451476184409*^9}, {3.7494086106269345`*^9, 3.749408612465603*^9}, {
   3.7494786662825217`*^9, 3.7494786831055794`*^9}, {3.750949144621682*^9, 
   3.750949171539495*^9}, {3.750949202634305*^9, 3.7509492065697823`*^9}, {
   3.750949249498136*^9, 3.75094935832798*^9}, {3.7509495261099157`*^9, 
   3.7509497203736343`*^9}, {3.750950083209612*^9, 3.750950101374525*^9}, 
   3.751244470578239*^9, {3.751244756131256*^9, 3.751244767967533*^9}, {
   3.751246908435158*^9, 3.751247001173853*^9}, {3.751247041583015*^9, 
   3.751247047812912*^9}, {3.751247098703039*^9, 3.751247210627803*^9}, {
   3.751247278938119*^9, 3.75124730944249*^9}, {3.75124734699302*^9, 
   3.7512473595699053`*^9}, {3.751247426505917*^9, 3.7512474496602077`*^9}, {
   3.7512474918217163`*^9, 3.751247516998909*^9}, {3.751282246394025*^9, 
   3.7512822590785723`*^9}, {3.751282489579336*^9, 3.751282496556559*^9}, {
   3.7512829307848253`*^9, 3.7512829358641157`*^9}, {3.7512831032956257`*^9, 
   3.751283207169581*^9}, {3.751283969722331*^9, 3.751283975737221*^9}, {
   3.751285014793301*^9, 3.75128501485921*^9}, {3.751286527113761*^9, 
   3.751286550815689*^9}, {3.753627089358436*^9, 3.753627089896762*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"ed0c91d7-d508-491f-9149-0fc5bad28ffe"],

Cell[CellGroupData[{

Cell[BoxData["tests"], "Input",
 CellChangeTimes->{{3.753627489807951*^9, 3.75362749011066*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"91bcb908-9452-4ee0-8304-e1bde5c11597"],

Cell[BoxData["tests"], "Output",
 CellChangeTimes->{{3.7536274904775753`*^9, 3.7536275075794573`*^9}, 
   3.753669596294529*^9, 3.77973670147408*^9, 3.7802356080326242`*^9, 
   3.7802356717058125`*^9, 3.8014442965062685`*^9, 3.8066830806727705`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"32607f76-f36f-42e1-be61-b2b198ee4330"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ImageDimensions", "@", 
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJITikcBOeCDPXaa
Uv2kmjfYzCFkHm4AAFoSIOw=
     "], {{0, 9}, {9, 0}}, {0., 1.},
     ColorFunction->GrayLevel],
    BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSizeRaw->{9, 9},
   PlotRange->{{0, 9}, {0, 9}}]}]], "Input",
 CellChangeTimes->{{3.753628130752633*^9, 3.753628140991805*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"417de312-7c5e-4841-b0f4-ba0bf2f3f9e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9"}], "}"}]], "Output",
 CellChangeTimes->{{3.7536281389826612`*^9, 3.7536281412870092`*^9}, 
   3.753669596325801*^9, 3.779736701495556*^9, 3.780235608068413*^9, 
   3.780235671737059*^9, 3.8014442965422535`*^9, 3.806683080699918*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"8a9fe8fa-984b-497f-b8bf-fdeac18969e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", " ", "=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"tests", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MyDiskDonutCentered", "[", 
        RowBox[{"myPadSize", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tests", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"tests", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           GraphicsBox[
            TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
              "], {{0, 12}, {11, 0}}, {0., 1.},
              ColorFunction->GrayLevel],
             BoxForm`ImageTag[
             "Real", ColorSpace -> Automatic, Interleaving -> None],
             Selectable->False],
            DefaultBaseStyle->"ImageGraphics",
            ImageSizeRaw->{11, 12},
            PlotRange->{{0, 11}, {0, 12}}], ",", 
           GraphicsBox[
            TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
              "], {{0, 12}, {11, 0}}, {0., 1.},
              ColorFunction->GrayLevel],
             BoxForm`ImageTag[
             "Real", ColorSpace -> Automatic, Interleaving -> None],
             Selectable->False],
            DefaultBaseStyle->"ImageGraphics",
            ImageSizeRaw->{11, 12},
            PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "tests"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.753627101068246*^9, 3.753627163202354*^9}, {
  3.7536272107931747`*^9, 3.753627251716296*^9}, {3.7536272866192837`*^9, 
  3.753627287400208*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"70abdd6c-b022-4d78-b18d-1bc3bf49644d"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "argx", 
   "\"\\!\\(\\*RowBox[{\\\"Symbol\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"0\
\\\"}]\\) arguments; 1 argument is expected.\"", 2, 48, 1, 
   21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753669596414336*^9, 3.7797367015175123`*^9, 
  3.780235608162939*^9, 3.7802356717683287`*^9, 3.8014442965861597`*^9, 
  3.806683080861947*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"cf0abb01-9031-4740-a6fb-b31a04c6e503"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "nmtx", 
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Symbol\\\", \\\"[\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\
\"{\\\", \\\"}\\\"}]}], \\\"}\\\"}]\\) cannot be transposed.\"", 2, 48, 2, 
   21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753669596414336*^9, 3.7797367015175123`*^9, 
  3.780235608162939*^9, 3.7802356717683287`*^9, 3.8014442965861597`*^9, 
  3.8066830808649125`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"5836dc89-6d44-42f6-9a47-3e53fc0fa722"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Symbol", "[", "]"}], ",", 
    RowBox[{"{", "}"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.753627207327858*^9, 3.753627252045293*^9}, 
   3.753627287610085*^9, 3.753627509028817*^9, 3.7536275641096773`*^9, 
   3.7536276603777237`*^9, 3.753627716640559*^9, 3.753627855801798*^9, {
   3.753628077134459*^9, 3.7536280932237453`*^9}, 3.7536282548757687`*^9, 
   3.753628285397943*^9, {3.753628746017015*^9, 3.753628759456623*^9}, 
   3.753669596430975*^9, 3.779736701521513*^9, 3.780235608194212*^9, 
   3.7802356717683287`*^9, 3.8014442965901537`*^9, 3.806683080866934*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"42799cc4-c7e4-4f7f-a617-0d05fc5134e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"MyDiskDonutCentered", "[", 
    RowBox[{"myPadSize", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tests", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"tests", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       GraphicsBox[
        TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
          "], {{0, 12}, {11, 0}}, {0., 1.},
          ColorFunction->GrayLevel],
         BoxForm`ImageTag[
         "Real", ColorSpace -> Automatic, Interleaving -> None],
         Selectable->False],
        DefaultBaseStyle->"ImageGraphics",
        ImageSizeRaw->{11, 12},
        PlotRange->{{0, 11}, {0, 12}}], ",", 
       GraphicsBox[
        TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
          "], {{0, 12}, {11, 0}}, {0., 1.},
          ColorFunction->GrayLevel],
         BoxForm`ImageTag[
         "Real", ColorSpace -> Automatic, Interleaving -> None],
         Selectable->False],
        DefaultBaseStyle->"ImageGraphics",
        ImageSizeRaw->{11, 12},
        PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}], " ", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "@", "tests"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7536283049103327`*^9, 3.753628305555213*^9}, {
  3.753628765502553*^9, 3.753628772102426*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"72d72ed3-c7bd-47c0-ab11-b2e37e2c8d20"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.753628749424336*^9, 3.753628762073135*^9}, 
   3.7536695964466057`*^9, 3.7797367015454226`*^9, 3.780235608209801*^9, 
   3.7802356717995453`*^9, 3.801444296626109*^9, 3.8066830808937397`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"c5682a65-c42c-4bc0-9a16-0236469cf585"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MyDiskDonutCentered", "[", 
  RowBox[{"myPadSize", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"tests", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"tests", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSize->{22., Automatic},
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.753628363591889*^9, 3.753628377061261*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"c7436e49-ceff-42ce-bf5e-3a8586d047f1"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"tests\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"7\\\", \\\",\\\", \\\"2\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"", 2, 51, 3, 
   21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7536695965104055`*^9, 3.779736701569357*^9, 
  3.780235608334819*^9, 3.7802356718216763`*^9, 3.8014442966660547`*^9, 
  3.806683080982355*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"77b9f038-71e5-40be-a534-54ffc773d8b5"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"tests\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"7\\\", \\\",\\\", \\\"3\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"", 2, 51, 4, 
   21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7536695965104055`*^9, 3.779736701569357*^9, 
  3.780235608334819*^9, 3.7802356718216763`*^9, 3.8014442966660547`*^9, 
  3.8066830809873433`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"08c5250b-f381-4143-a86a-213c1cd91a0c"],

Cell[BoxData[
 RowBox[{"MyDiskDonutCentered", "[", 
  RowBox[{"myPadSize", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"tests", "\[LeftDoubleBracket]", 
      RowBox[{"7", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"tests", "\[LeftDoubleBracket]", 
      RowBox[{"7", ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSize->{22., Automatic},
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
        "], {{0, 12}, {11, 0}}, {0., 1.},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> None],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 12},
      PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7536283063574867`*^9, 3.7536283283577557`*^9}, 
   3.753628377288354*^9, {3.753628413632998*^9, 3.753628457929192*^9}, {
   3.753628505156877*^9, 3.753628552982217*^9}, 3.753628629885621*^9, 
   3.753628689896675*^9, {3.753628732659071*^9, 3.753628751898623*^9}, 
   3.753669596514426*^9, 3.779736701575341*^9, 3.780235608334819*^9, 
   3.7802356718373013`*^9, 3.801444296674074*^9, 3.806683080991354*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"49e11f7a-2ebd-48b8-826d-1a6a1876c9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"ImageMultiply", "[", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"a", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "@", "a"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.753627278110055*^9, 3.753627395899909*^9}, {
  3.753627572948634*^9, 3.7536275784390783`*^9}, {3.753627676261909*^9, 
  3.753627687868743*^9}, {3.753627759269573*^9, 3.7536277646808577`*^9}, {
  3.753627861133944*^9, 3.753627878252429*^9}, {3.7536287770277987`*^9, 
  3.753628787178143*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"1656df1c-17e2-4280-a2e4-37367d97f128"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 53, 5, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7536695965612993`*^9, 3.779736701601272*^9, 
  3.7802356084597425`*^9, 3.7802356718997855`*^9, 3.8014442967898903`*^9, 
  3.806683081078722*^9},
 CellLabel->
  "During evaluation of \
In[52]:=",ExpressionUUID->"d786f98a-9d9e-4998-94a3-771d58037f2a"],

Cell[BoxData[
 TemplateBox[{
  "ImageMultiply", "imginv", 
   "\"Expecting an image or graphics instead of \\!\\(\\*RowBox[{\\\"Symbol\\\
\", \\\"[\\\", \\\"]\\\"}]\\).\"", 2, 53, 6, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7536695965612993`*^9, 3.779736701601272*^9, 
  3.7802356084597425`*^9, 3.7802356718997855`*^9, 3.8014442967898903`*^9, 
  3.806683081083709*^9},
 CellLabel->
  "During evaluation of \
In[52]:=",ExpressionUUID->"3a40f44c-e5e9-4702-a6d1-5efb4fe4c8e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ImageMultiply", "[", 
   RowBox[{
    RowBox[{"Symbol", "[", "]"}], ",", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Symbol", "[", "]"}], ",", 
        RowBox[{"{", "}"}]}], "}"}], "]"}], "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.753627280384637*^9, 3.753627365622286*^9}, 
   3.753627396218811*^9, 3.753627578610703*^9, {3.753627673894722*^9, 
   3.753627688183346*^9}, 3.753627719123337*^9, {3.753627759814241*^9, 
   3.7536277649736423`*^9}, {3.7536278588715153`*^9, 3.753627878887396*^9}, 
   3.753628753088554*^9, 3.753628787527658*^9, 3.7536695966078405`*^9, 
   3.7797367016052923`*^9, 3.780235608495801*^9, 3.780235671906296*^9, 
   3.801444296793913*^9, 3.80668308110165*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"4a61407d-6f5a-401e-9b71-494c877111c0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Finally", " ", "fixed", " ", "this", " ", "stupid", " ", "code"}],
    "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MyDiskDonutCentered", "[", 
     RowBox[{"pad_", ",", "centroid_", ",", "myDiskDonut_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", "h", ",", "dd"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberQ", "[", 
           RowBox[{"centroid", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"g", ",", "h"}], "}"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"centroid", "  ", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pad", "+", ".5"}], ",", 
               RowBox[{"pad", "+", ".5"}]}], "}"}]}], "//", 
            RowBox[{
             RowBox[{"Ceiling", "@", "#"}], "&"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dd", " ", "=", " ", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
              RowBox[{"h", "\[GreaterEqual]", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ImagePad", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "g"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "h"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], 
               "&"}], "/@", "myDiskDonut"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"g", "\[LessEqual]", "0"}], " ", "&&", " ", 
              RowBox[{"h", "\[LessEqual]", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ImagePad", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "g"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "h"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], 
               "&"}], "/@", "myDiskDonut"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"g", "<", " ", "0"}], " ", "&&", " ", 
              RowBox[{"h", ">", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ImagePad", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "g"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "h"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], 
               "&"}], "/@", "myDiskDonut"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
              RowBox[{"h", "\[LessEqual]", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ImagePad", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "g"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "h"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], 
               "&"}], "/@", "myDiskDonut"}]}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dims", " ", "=", " ", 
        RowBox[{"ImageDimensions", "@", 
         RowBox[{"dd", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dims", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{
           RowBox[{"2", "pad"}], "+", ".5"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ImagePad", "[", 
            RowBox[{
             RowBox[{"dd", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "dd"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], " ", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.75128398960047*^9, 3.751284012895602*^9}, {
   3.751284128701543*^9, 3.751284148824835*^9}, {3.7512841812919197`*^9, 
   3.751284258164618*^9}, {3.751284415251461*^9, 3.751284439543398*^9}, {
   3.7512845470331087`*^9, 3.751284661504381*^9}, {3.751284765626504*^9, 
   3.751284987474287*^9}, {3.7512851575871763`*^9, 3.751285161038377*^9}, {
   3.751285192143504*^9, 3.751285193791532*^9}, 3.751285235220045*^9, {
   3.7512857774608*^9, 3.751285786951351*^9}, {3.75128599183037*^9, 
   3.751285993472782*^9}, {3.751286026196789*^9, 3.751286093072723*^9}, {
   3.751286192701745*^9, 3.7512862681198997`*^9}, {3.751286306984688*^9, 
   3.7512863458289557`*^9}, {3.751286383406472*^9, 3.751286408944289*^9}, {
   3.753627174715035*^9, 3.753627204120261*^9}, {3.753627502674741*^9, 
   3.753627504157493*^9}, {3.75362765321686*^9, 3.753627656692965*^9}, {
   3.7536277114177647`*^9, 3.7536277128688927`*^9}, {3.75362784930399*^9, 
   3.753627851686296*^9}, {3.75362803730385*^9, 3.753628280600024*^9}, {
   3.753628315068225*^9, 3.7536283254686327`*^9}, {3.753628403345743*^9, 
   3.753628547686734*^9}, {3.753628591505637*^9, 3.753628626972617*^9}, {
   3.753628677430648*^9, 3.753628728346759*^9}, {3.7536287978166523`*^9, 
   3.7536288291658077`*^9}, {3.7536289283339252`*^9, 3.753628933453642*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"70556897-7906-4420-8a16-b7a76724f662"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tests", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "r"}], "]"}], "]"}], ",", 
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"10", ",", "r"}], "]"}], "]"}], ",", 
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"14", ",", "r"}], "]"}], "]"}], ",", 
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"18", ",", "r"}], "]"}], "]"}], ",", 
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"19", ",", "r"}], "]"}], "]"}], ",", 
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"39", ",", "r"}], "]"}], "]"}], ",", 
    RowBox[{"dataframePF", "[", 
     RowBox[{"[", 
      RowBox[{"36", ",", "r"}], "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{
  3.751286082099255*^9, {3.753626623178235*^9, 3.7536267335112457`*^9}, {
   3.753626818363475*^9, 3.753626845941201*^9}, {3.753626882457892*^9, 
   3.753626914058181*^9}, {3.753626955205317*^9, 3.753626963775381*^9}, {
   3.753627016902074*^9, 3.753627042472561*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"ad180aed-7cbd-4c8a-8459-dfb810cb114a"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"r\\\"}]\\) cannot be used as a part \
specification.\"", 2, 55, 7, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753669596663233*^9, 3.7797367016511393`*^9, 
  3.7802356085472794`*^9, 3.780235671953165*^9, 3.8014442968817663`*^9, 
  3.806683081155656*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"95131c53-17c8-4c63-bc30-a96af284b109"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"r\\\"}]\\) cannot be used as a part \
specification.\"", 2, 55, 8, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753669596663233*^9, 3.7797367016511393`*^9, 
  3.7802356085472794`*^9, 3.780235671953165*^9, 3.8014442968817663`*^9, 
  3.806683081158675*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"eb393e76-561d-4468-a0ae-68687904ca0d"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"r\\\"}]\\) cannot be used as a part \
specification.\"", 2, 55, 9, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753669596663233*^9, 3.7797367016511393`*^9, 
  3.7802356085472794`*^9, 3.780235671953165*^9, 3.8014442968817663`*^9, 
  3.8066830811606455`*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"2a1faa87-5407-43c2-a89c-49df33f21831"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 55, 10, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.753669596663233*^9, 3.7797367016511393`*^9, 
  3.7802356085472794`*^9, 3.780235671953165*^9, 3.8014442968817663`*^9, 
  3.8066830812628508`*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"c7221786-0fed-4309-aa60-6d6be7442d5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"3", ",", "r"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"10", ",", "r"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"14", ",", "r"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"18", ",", "r"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"19", ",", "r"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"39", ",", "r"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"dataframePF", "\[LeftDoubleBracket]", 
    RowBox[{"36", ",", "r"}], "\[RightDoubleBracket]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7536266291594563`*^9, 3.7536267338358593`*^9}, 
   3.753626780602311*^9, {3.753626818814*^9, 3.75362684628647*^9}, {
   3.753626884499296*^9, 3.7536269144167423`*^9}, {3.7536269561168613`*^9, 
   3.753626964024972*^9}, {3.753627017893569*^9, 3.7536270427372007`*^9}, 
   3.753669596694477*^9, 3.7797367016591177`*^9, 3.780235608583046*^9, 
   3.7802356719733486`*^9, 3.801444296889786*^9, 3.8066830812668066`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"7e14ea0b-cef4-4559-be00-0fcef99fdef3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["14. FitMySpotIntensity[img_,sigma_,dims_]", "Subsubsection",
 CellChangeTimes->{{3.753669464617916*^9, 3.753669474632221*^9}, {
  3.7536695119452457`*^9, 
  3.753669535944728*^9}},ExpressionUUID->"5d27b8f3-6c90-45f7-b3fc-\
49b0af80b20a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitMySpotIntensity", "[", 
   RowBox[{"img_", ",", "sigma_", ",", "dims_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myzs", ",", "my3Ddata", ",", "nlm", ",", "A", ",", "CC", ",", "x", ",", 
      "x0", ",", "y", ",", "y0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myzs", "=", 
      RowBox[{"ImageData", "@", "img"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"my3Ddata", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"myzs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "dims", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "dims", ",", "1"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nlm", "=", 
      RowBox[{"NonlinearModelFit", "[", 
       RowBox[{"my3Ddata", ",", 
        RowBox[{"CC", "+", 
         RowBox[{"A", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"CC", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x0", ",", 
            RowBox[{"dims", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0", ",", 
            RowBox[{"dims", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "0.5"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"nlm", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], 
        "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"435388a3-86f6-4d14-b992-7591fba82cd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitMySpotIntensity2", "[", 
   RowBox[{"img_", ",", "sigma_", ",", "dims_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myzs", ",", "my3Ddata", ",", "nlm", ",", "A", ",", "CC", ",", "x", ",", 
      "x0", ",", "y", ",", "y0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myzs", "=", 
      RowBox[{"ImageData", "@", "img"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"my3Ddata", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"myzs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ImageDimensions", "@", "img"}], ")"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ImageDimensions", "@", "img"}], ")"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "1"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nlm", "=", 
      RowBox[{"NonlinearModelFit", "[", 
       RowBox[{"my3Ddata", ",", 
        RowBox[{"CC", "+", 
         RowBox[{"A", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"CC", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x0", ",", 
            RowBox[{"dims", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0", ",", 
            RowBox[{"dims", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "0.5"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"nlm", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], 
        "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"e97afc7c-7f42-417a-936d-464838b4b382"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "NOT USED:. My PUT IT TOGETHER... D&D using a barcoded PF output line\n",
 StyleBox["take a line of output, make masks, center masks via padding, then \
calculate mask area, multiply mask x crop, then calculate mean intensity, \
then export the mean intensity, like just {number}",
  FontSize->14]
}], "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
   3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
   3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
   3.750950049325511*^9, 3.750950052579129*^9}, 3.750951542405332*^9, {
   3.750951607120916*^9, 3.750951698469619*^9}, {3.750951739435706*^9, 
   3.750951769329777*^9}, {3.750951806956396*^9, 3.7509518489449253`*^9}, {
   3.7512872720804157`*^9, 3.751287276147211*^9}, {3.7536248229011383`*^9, 
   3.7536248422374372`*^9}},ExpressionUUID->"4fde548c-c2a7-45a2-a0a1-\
ed8b4add4e60"],

Cell[BoxData[
 RowBox[{"This", " ", "is", " ", "what", " ", "the", " ", "input", " ", 
  "looks", " ", 
  RowBox[{"like", ":", " ", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           GraphicsBox[
            
            TagBox[RasterBox[
              RawArray["UnsignedInteger16",{{3600, 10122, 10853, 10044, 8244, 
               3887, 2870, 3209, 5687, 9653, 7070}, {3444, 5583, 1644, 0, 
               3183, 8244, 18314, 7461, 12131, 1331, 6366}, {7905, 2791, 
               16019, 10801, 7905, 16071, 13253, 14088, 17062, 12992, 6757}, {
               12131, 12549, 17245, 7618, 12940, 30028, 12444, 25228, 12679, 
               678, 9183}, {11662, 10853, 19854, 13410, 30367, 16279, 22515, 
               27550, 17271, 12105, 2061}, {15418, 10879, 17114, 10070, 15914,
                26898, 53873, 65535, 23167, 6809, 10227}, {14949, 8218, 9705, 
               17740, 5531, 57056, 58308, 57500, 37829, 12001, 13279}, {15210,
                17349, 19306, 7540, 30837, 40594, 52465, 47038, 18393, 19358, 
               2583}, {12679, 9809, 19436, 24106, 22723, 39629, 41690, 22515, 
               28254, 13044, 10149}, {20897, 18862, 7018, 11531, 11349, 13514,
                12340, 19906, 11009, 16749, 6809}, {14140, 12992, 16697, 
               15184, 15575, 20610, 19201, 6887, 7018, 15445, 7696}}], {{0, 
              11}, {11, 0}}, {0, 65535},
              ColorFunction->GrayLevel],
             BoxForm`ImageTag[
             "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
              MetaInformation -> 
              Association[
               "Exif" -> Association[
                 "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                  "ImageLength" -> 512, "BitsPerSample" -> 16, 
                  "PhotometricInterpretation" -> "Black Is Zero", 
                  "ImageDescription" -> 
                  "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                  "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                  "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
             Selectable->False],
            DefaultBaseStyle->"ImageGraphics",
            ImageSizeRaw->{11, 11},
            PlotRange->{{0, 11}, {0, 11}}], ",", 
           GraphicsBox[
            
            TagBox[RasterBox[
              RawArray["UnsignedInteger16",{{325, 6030, 690, 11572, 9522, 
               11755, 18191, 12323, 13988, 4629, 9826}, {10456, 3005, 13156, 
               11430, 21277, 14151, 14394, 5745, 10902, 3695, 11999}, {21013, 
               21175, 13359, 23814, 18597, 6497, 20485, 12790, 17115, 9684, 
               12100}, {8872, 20464, 20992, 21074, 23896, 31631, 34615, 15551,
                17115, 15937, 6497}, {11085, 9623, 19246, 35407, 49029, 28240,
                60074, 29336, 17602, 8933, 21480}, {22413, 17379, 10496, 
               16323, 65535, 48969, 42411, 25743, 16445, 28240, 3796}, {13907,
                21094, 15450, 15125, 30717, 55242, 30839, 25053, 11207, 23185,
                18779}, {15003, 30839, 22596, 15166, 21947, 26068, 23794, 
               14780, 5827, 12892, 19855}, {12628, 21683, 19003, 20911, 22556,
                23266, 5055, 15470, 14293, 17764, 5624}, {22332, 9846, 8994, 
               14658, 13298, 13785, 9156, 8994, 7187, 14110, 6801}, {13643, 
               18637, 22048, 23124, 20810, 0, 15409, 17642, 10232, 29580, 
               12465}}], {{0, 11}, {11, 0}}, {0, 65535},
              ColorFunction->GrayLevel],
             BoxForm`ImageTag[
             "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
              MetaInformation -> 
              Association[
               "Exif" -> Association[
                 "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                  "ImageLength" -> 512, "BitsPerSample" -> 16, 
                  "PhotometricInterpretation" -> "Black Is Zero", 
                  "ImageDescription" -> 
                  "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                  "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                  "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
             Selectable->False],
            DefaultBaseStyle->"ImageGraphics",
            ImageSizeRaw->{11, 11},
            PlotRange->{{0, 11}, {0, 11}}], ",", 
           GraphicsBox[
            
            TagBox[RasterBox[
              RawArray["UnsignedInteger16",{{9961, 9533, 2266, 11029, 10474, 
               13081, 9234, 7182, 11115, 10260, 9661}, {14364, 26205, 11628, 
               29711, 4617, 25436, 30609, 34328, 8251, 13466, 27231}, {23598, 
               10260, 19537, 11799, 14107, 6883, 14278, 15304, 25564, 15262, 
               9747}, {15005, 7267, 24837, 12269, 15817, 19066, 15946, 16288, 
               26205, 11414, 15561}, {10003, 24025, 13594, 21247, 11329, 
               19280, 18981, 12697, 29326, 9191, 0}, {28300, 15005, 21289, 
               16972, 16886, 65535, 28343, 12440, 12996, 22743, 20862}, {
               22144, 11200, 19152, 14749, 17613, 40698, 29583, 15048, 14535, 
               8122, 16886}, {8849, 24538, 19708, 17784, 26676, 7652, 13979, 
               34884, 12697, 17271, 18810}, {21247, 10645, 16245, 21332, 
               28300, 21802, 16544, 5728, 16801, 2950, 8464}, {22871, 12526, 
               11029, 10645, 12611, 9747, 21717, 16630, 19537, 11884, 
               23298}, {9148, 22999, 5472, 16801, 21674, 10687, 16587, 3505, 
               24709, 25008, 41296}}], {{0, 11}, {11, 0}}, {0, 65535},
              ColorFunction->GrayLevel],
             BoxForm`ImageTag[
             "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
              MetaInformation -> 
              Association[
               "Exif" -> Association[
                 "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                  "ImageLength" -> 512, "BitsPerSample" -> 16, 
                  "PhotometricInterpretation" -> "Black Is Zero", 
                  "ImageDescription" -> 
                  "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                  "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                  "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
             Selectable->False],
            DefaultBaseStyle->"ImageGraphics",
            ImageSizeRaw->{11, 11},
            PlotRange->{{0, 11}, {0, 11}}]}], "}"}], ",", "\"\<RG\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"6.684928164008052`", ",", "4.371788944003483`"}], 
              "}"}], ",", "0.14391349182406232`", ",", "0.24840161745632106`",
              ",", "11.28665598535134`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5.508610968733983`", ",", "5.836610022473682`"}], 
              "}"}], ",", "0.04513628936776892`", ",", "0.2490730144197757`", 
             ",", "9.675364309147785`"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
     "}"}], "}"}]}]}]], "Text",
 CellChangeTimes->{{3.753066111327489*^9, 3.75306618951716*^9}, {
  3.753066510833572*^9, 3.7530665114432077`*^9}, {3.7530665460923567`*^9, 
  3.753066546943136*^9}},ExpressionUUID->"b4edb672-6329-44bf-b36d-\
e1f31cb7260c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"UNIT", " ", 
    RowBox[{"TEST", ":", " ", "\[IndentingNewLine]", 
     RowBox[{
     "myoutput", " ", "is", " ", "an", " ", "output", " ", "ine", " ", "from",
       " ", "the", " ", "barcoder", " ", "code"}], ":"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myoutput", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"50", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            GraphicsBox[
             
             TagBox[RasterBox[
               RawArray["UnsignedInteger16",{{325, 6030, 690, 11572, 9522, 
                11755, 18191, 12323, 13988, 4629, 9826}, {10456, 3005, 13156, 
                11430, 21277, 14151, 14394, 5745, 10902, 3695, 11999}, {21013,
                 21175, 13359, 23814, 18597, 6497, 20485, 12790, 17115, 9684, 
                12100}, {8872, 20464, 20992, 21074, 23896, 31631, 34615, 
                15551, 17115, 15937, 6497}, {11085, 9623, 19246, 35407, 49029,
                 28240, 60074, 29336, 17602, 8933, 21480}, {22413, 17379, 
                10496, 16323, 65535, 48969, 42411, 25743, 16445, 28240, 
                3796}, {13907, 21094, 15450, 15125, 30717, 55242, 30839, 
                25053, 11207, 23185, 18779}, {15003, 30839, 22596, 15166, 
                21947, 26068, 23794, 14780, 5827, 12892, 19855}, {12628, 
                21683, 19003, 20911, 22556, 23266, 5055, 15470, 14293, 17764, 
                5624}, {22332, 9846, 8994, 14658, 13298, 13785, 9156, 8994, 
                7187, 14110, 6801}, {13643, 18637, 22048, 23124, 20810, 0, 
                15409, 17642, 10232, 29580, 12465}}], {{0, 11}, {11, 0}}, {0, 
               65535},
               ColorFunction->GrayLevel],
              BoxForm`ImageTag[
              "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
               MetaInformation -> 
               Association[
                "Exif" -> Association[
                  "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                   "ImageLength" -> 512, "BitsPerSample" -> 16, 
                   "PhotometricInterpretation" -> "Black Is Zero", 
                   "ImageDescription" -> 
                   
                   "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                   "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                   "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
              Selectable->False],
             DefaultBaseStyle->"ImageGraphics",
             ImageSizeRaw->{11, 11},
             PlotRange->{{0, 11}, {0, 11}}], ",", 
            GraphicsBox[
             
             TagBox[RasterBox[
               RawArray["UnsignedInteger16",{{3600, 10122, 10853, 10044, 8244,
                 3887, 2870, 3209, 5687, 9653, 7070}, {3444, 5583, 1644, 0, 
                3183, 8244, 18314, 7461, 12131, 1331, 6366}, {7905, 2791, 
                16019, 10801, 7905, 16071, 13253, 14088, 17062, 12992, 
                6757}, {12131, 12549, 17245, 7618, 12940, 30028, 12444, 25228,
                 12679, 678, 9183}, {11662, 10853, 19854, 13410, 30367, 16279,
                 22515, 27550, 17271, 12105, 2061}, {15418, 10879, 17114, 
                10070, 15914, 26898, 53873, 65535, 23167, 6809, 10227}, {
                14949, 8218, 9705, 17740, 5531, 57056, 58308, 57500, 37829, 
                12001, 13279}, {15210, 17349, 19306, 7540, 30837, 40594, 
                52465, 47038, 18393, 19358, 2583}, {12679, 9809, 19436, 24106,
                 22723, 39629, 41690, 22515, 28254, 13044, 10149}, {20897, 
                18862, 7018, 11531, 11349, 13514, 12340, 19906, 11009, 16749, 
                6809}, {14140, 12992, 16697, 15184, 15575, 20610, 19201, 6887,
                 7018, 15445, 7696}}], {{0, 11}, {11, 0}}, {0, 65535},
               ColorFunction->GrayLevel],
              BoxForm`ImageTag[
              "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
               MetaInformation -> 
               Association[
                "Exif" -> Association[
                  "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                   "ImageLength" -> 512, "BitsPerSample" -> 16, 
                   "PhotometricInterpretation" -> "Black Is Zero", 
                   "ImageDescription" -> 
                   "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                   "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                   "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
              Selectable->False],
             DefaultBaseStyle->"ImageGraphics",
             ImageSizeRaw->{11, 11},
             PlotRange->{{0, 11}, {0, 11}}], ",", 
            GraphicsBox[
             
             TagBox[RasterBox[
               RawArray["UnsignedInteger16",{{9961, 9533, 2266, 11029, 10474, 
                13081, 9234, 7182, 11115, 10260, 9661}, {14364, 26205, 11628, 
                29711, 4617, 25436, 30609, 34328, 8251, 13466, 27231}, {23598,
                 10260, 19537, 11799, 14107, 6883, 14278, 15304, 25564, 15262,
                 9747}, {15005, 7267, 24837, 12269, 15817, 19066, 15946, 
                16288, 26205, 11414, 15561}, {10003, 24025, 13594, 21247, 
                11329, 19280, 18981, 12697, 29326, 9191, 0}, {28300, 15005, 
                21289, 16972, 16886, 65535, 28343, 12440, 12996, 22743, 
                20862}, {22144, 11200, 19152, 14749, 17613, 40698, 29583, 
                15048, 14535, 8122, 16886}, {8849, 24538, 19708, 17784, 26676,
                 7652, 13979, 34884, 12697, 17271, 18810}, {21247, 10645, 
                16245, 21332, 28300, 21802, 16544, 5728, 16801, 2950, 8464}, {
                22871, 12526, 11029, 10645, 12611, 9747, 21717, 16630, 19537, 
                11884, 23298}, {9148, 22999, 5472, 16801, 21674, 10687, 16587,
                 3505, 24709, 25008, 41296}}], {{0, 11}, {11, 0}}, {0, 65535},
               ColorFunction->GrayLevel],
              BoxForm`ImageTag[
              "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
               MetaInformation -> 
               Association[
                "Exif" -> Association[
                  "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                   "ImageLength" -> 512, "BitsPerSample" -> 16, 
                   "PhotometricInterpretation" -> "Black Is Zero", 
                   "ImageDescription" -> 
                   "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                   "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                   "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
              Selectable->False],
             DefaultBaseStyle->"ImageGraphics",
             ImageSizeRaw->{11, 11},
             PlotRange->{{0, 11}, {0, 11}}]}], "}"}], ",", "\"\<RGB\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6.68", ",", "4.37"}], "}"}], ",", "0.143", ",", 
              "0.248", ",", "11.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6.68", ",", "4.37"}], "}"}], ",", "0.143", ",", 
              "0.248", ",", "11.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"5.5", ",", "5.5"}], "}"}], ",", "0.045", ",", "0.24", 
              ",", "9.67"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyPutItTogether", "[", 
    RowBox[{"5", ",", " ", "2", ",", " ", "myoutput"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7530667770732203`*^9, 3.7530667829678707`*^9}, {
   3.753067098718752*^9, 3.7530671032505007`*^9}, {3.753067141892108*^9, 
   3.75306721324035*^9}, {3.7530677929260387`*^9, 3.753067832410965*^9}, {
   3.7530683412791023`*^9, 3.7530683424795523`*^9}, {3.753110614456922*^9, 
   3.753110646243857*^9}, {3.753110707134047*^9, 3.753110728672769*^9}, {
   3.753112801333331*^9, 3.753112806978009*^9}, 3.753624993684627*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"3f27adde-5b02-46ea-ad91-7e8d97ef833b"],

Cell[BoxData[
 RowBox[{"MyPutItTogether", "[", 
  RowBox[{"5", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          GraphicsBox[
           
           TagBox[RasterBox[
             RawArray["UnsignedInteger16",{{325, 6030, 690, 11572, 9522, 
              11755, 18191, 12323, 13988, 4629, 9826}, {10456, 3005, 13156, 
              11430, 21277, 14151, 14394, 5745, 10902, 3695, 11999}, {21013, 
              21175, 13359, 23814, 18597, 6497, 20485, 12790, 17115, 9684, 
              12100}, {8872, 20464, 20992, 21074, 23896, 31631, 34615, 15551, 
              17115, 15937, 6497}, {11085, 9623, 19246, 35407, 49029, 28240, 
              60074, 29336, 17602, 8933, 21480}, {22413, 17379, 10496, 16323, 
              65535, 48969, 42411, 25743, 16445, 28240, 3796}, {13907, 21094, 
              15450, 15125, 30717, 55242, 30839, 25053, 11207, 23185, 
              18779}, {15003, 30839, 22596, 15166, 21947, 26068, 23794, 14780,
               5827, 12892, 19855}, {12628, 21683, 19003, 20911, 22556, 23266,
               5055, 15470, 14293, 17764, 5624}, {22332, 9846, 8994, 14658, 
              13298, 13785, 9156, 8994, 7187, 14110, 6801}, {13643, 18637, 
              22048, 23124, 20810, 0, 15409, 17642, 10232, 29580, 12465}}], {{
             0, 11}, {11, 0}}, {0, 65535},
             ColorFunction->GrayLevel],
            BoxForm`ImageTag[
            "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
             MetaInformation -> 
             Association[
              "Exif" -> Association[
                "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                 "ImageLength" -> 512, "BitsPerSample" -> 16, 
                 "PhotometricInterpretation" -> "Black Is Zero", 
                 "ImageDescription" -> 
                 "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                 "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                 "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
            Selectable->False],
           DefaultBaseStyle->"ImageGraphics",
           ImageSizeRaw->{11, 11},
           PlotRange->{{0, 11}, {0, 11}}], ",", 
          GraphicsBox[
           
           TagBox[RasterBox[
             RawArray["UnsignedInteger16",{{3600, 10122, 10853, 10044, 8244, 
              3887, 2870, 3209, 5687, 9653, 7070}, {3444, 5583, 1644, 0, 3183,
               8244, 18314, 7461, 12131, 1331, 6366}, {7905, 2791, 16019, 
              10801, 7905, 16071, 13253, 14088, 17062, 12992, 6757}, {12131, 
              12549, 17245, 7618, 12940, 30028, 12444, 25228, 12679, 678, 
              9183}, {11662, 10853, 19854, 13410, 30367, 16279, 22515, 27550, 
              17271, 12105, 2061}, {15418, 10879, 17114, 10070, 15914, 26898, 
              53873, 65535, 23167, 6809, 10227}, {14949, 8218, 9705, 17740, 
              5531, 57056, 58308, 57500, 37829, 12001, 13279}, {15210, 17349, 
              19306, 7540, 30837, 40594, 52465, 47038, 18393, 19358, 2583}, {
              12679, 9809, 19436, 24106, 22723, 39629, 41690, 22515, 28254, 
              13044, 10149}, {20897, 18862, 7018, 11531, 11349, 13514, 12340, 
              19906, 11009, 16749, 6809}, {14140, 12992, 16697, 15184, 15575, 
              20610, 19201, 6887, 7018, 15445, 7696}}], {{0, 11}, {11, 0}}, {
             0, 65535},
             ColorFunction->GrayLevel],
            BoxForm`ImageTag[
            "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
             MetaInformation -> 
             Association[
              "Exif" -> Association[
                "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                 "ImageLength" -> 512, "BitsPerSample" -> 16, 
                 "PhotometricInterpretation" -> "Black Is Zero", 
                 "ImageDescription" -> 
                 "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                 "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                 "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
            Selectable->False],
           DefaultBaseStyle->"ImageGraphics",
           ImageSizeRaw->{11, 11},
           PlotRange->{{0, 11}, {0, 11}}], ",", 
          GraphicsBox[
           
           TagBox[RasterBox[
             RawArray["UnsignedInteger16",{{9961, 9533, 2266, 11029, 10474, 
              13081, 9234, 7182, 11115, 10260, 9661}, {14364, 26205, 11628, 
              29711, 4617, 25436, 30609, 34328, 8251, 13466, 27231}, {23598, 
              10260, 19537, 11799, 14107, 6883, 14278, 15304, 25564, 15262, 
              9747}, {15005, 7267, 24837, 12269, 15817, 19066, 15946, 16288, 
              26205, 11414, 15561}, {10003, 24025, 13594, 21247, 11329, 19280,
               18981, 12697, 29326, 9191, 0}, {28300, 15005, 21289, 16972, 
              16886, 65535, 28343, 12440, 12996, 22743, 20862}, {22144, 11200,
               19152, 14749, 17613, 40698, 29583, 15048, 14535, 8122, 
              16886}, {8849, 24538, 19708, 17784, 26676, 7652, 13979, 34884, 
              12697, 17271, 18810}, {21247, 10645, 16245, 21332, 28300, 21802,
               16544, 5728, 16801, 2950, 8464}, {22871, 12526, 11029, 10645, 
              12611, 9747, 21717, 16630, 19537, 11884, 23298}, {9148, 22999, 
              5472, 16801, 21674, 10687, 16587, 3505, 24709, 25008, 
              41296}}], {{0, 11}, {11, 0}}, {0, 65535},
             ColorFunction->GrayLevel],
            BoxForm`ImageTag[
            "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
             MetaInformation -> 
             Association[
              "Exif" -> Association[
                "NewSubfileType" -> "Primary image", "ImageWidth" -> 512, 
                 "ImageLength" -> 512, "BitsPerSample" -> 16, 
                 "PhotometricInterpretation" -> "Black Is Zero", 
                 "ImageDescription" -> 
                 "ImageJ=1.51n\nimages=165\nchannels=3\nframes=55\n\
hyperstack=true\nmode=composite\nloop=false\nmin=511.0\nmax=3962.0", 
                 "StripOffsets" -> 2659, "SamplesPerPixel" -> 1, 
                 "RowsPerStrip" -> 512, "StripByteCounts" -> 524288]]],
            Selectable->False],
           DefaultBaseStyle->"ImageGraphics",
           ImageSizeRaw->{11, 11},
           PlotRange->{{0, 11}, {0, 11}}]}], "}"}], ",", "\<\"RGB\"\>", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"6.68`", ",", "4.37`"}], "}"}], ",", "0.143`", ",", 
            "0.248`", ",", "11.2`"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"6.68`", ",", "4.37`"}], "}"}], ",", "0.143`", ",", 
            "0.248`", ",", "11.2`"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"5.5`", ",", "5.5`"}], "}"}], ",", "0.045`", ",", 
            "0.24`", ",", "9.67`"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
    "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.75306889595395*^9, {3.753069030579885*^9, 3.753069046635002*^9}, {
   3.753069117866398*^9, 3.753069130071721*^9}, 3.753069164259202*^9, 
   3.753069323053957*^9, 3.753070568540072*^9, 3.753081068212596*^9, 
   3.753108880035459*^9, {3.753110609521679*^9, 3.753110647175416*^9}, {
   3.753110717832642*^9, 3.753110729012059*^9}, 3.753273383330317*^9, 
   3.753616538413554*^9, 3.753624990585885*^9, 3.779736701709016*^9, 
   3.7802356086659484`*^9, 3.7802356720218697`*^9, 3.801444296997612*^9, 
   3.8066830813690624`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"68f4ccfd-85a4-451d-92b7-094efc3ace75"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyPutItTogether", "[", 
   RowBox[{"myPadSize_", ",", "myDonutRadius_", ",", "myoutputline_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "masks", ",", "blank", ",", " ", "centeredMasks", ",", "masksizes", ",", 
      "mymaskedcrops", ",", "meanIntensities", ",", "meanBGintensity", ",", 
      "myCentroid", ",", "mymasks", ",", "myCrop", ",", "mybarcode", ",", 
      "rgbL", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rgbL", "=", 
      RowBox[{"StringLength", "[", 
       RowBox[{"myoutputline", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"mybarcode", " ", "=", "   ", 
      RowBox[{"myoutputline", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"mybarcode", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"myCentroid", " ", "=", " ", 
            RowBox[{"myoutputline", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "1", ",", "3", ",", "rgb", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"myCrop", " ", "=", " ", 
            RowBox[{"myoutputline", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "1", ",", "1", ",", "rgb"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"masks", " ", "=", " ", 
            RowBox[{"MyDiskDonutMask", "[", 
             RowBox[{"myPadSize", ",", "myDonutRadius"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"blank", "=", " ", 
            RowBox[{"Image", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"myPadSize", "*", "2"}], "+", "1"}], ")"}]}], 
                "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"myPadSize", "*", "2"}], "+", "1"}], ")"}]}], "]"}], 
             "]"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "creates", " ", "a", " ", "maks", " ", "image", " ", "the", " ", 
              "size", " ", "of", " ", "myCrop", " ", 
              RowBox[{"that", "'"}], "s", " ", "just", " ", "1.", "s"}], ",", 
             " ", 
             RowBox[{
             "to", " ", "adjust", " ", "the", " ", "size", " ", "of", " ", 
              "the", " ", "masks", " ", "so", " ", "we", " ", "can", " ", 
              "get", " ", "an", " ", "accurate", " ", "white", " ", "pixel", 
              " ", "count"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"centeredMasks", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageMultiply", "[", 
               RowBox[{"blank", ",", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"MyDiskDonutCentered", "[", 
              RowBox[{"myPadSize", ",", "myCentroid", ",", "masks"}], 
              "]"}]}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "these", " ", "centered", " ", "masks", " ", "now", " ", "look", 
             " ", "like", " ", 
             RowBox[{"this", ":", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 GraphicsBox[
                  TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIbikfBSAIf7LHT
1DaPUvOHmrmEzKc9AACYriDw
                    "], {{0, 11}, {11, 0}}, {0., 1.},
                    ColorFunction->GrayLevel],
                   BoxForm`ImageTag[
                   "Real", ColorSpace -> Automatic, Interleaving -> None],
                   Selectable->False],
                  DefaultBaseStyle->"ImageGraphics",
                  ImageSizeRaw->{11, 11},
                  PlotRange->{{0, 11}, {0, 11}}], ",", 
                 GraphicsBox[
                  TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIbioc3+GBPHE1t
84g1n1L1lJqHSz+p9pILhrq51Apfcs1HqAMAOlMysQ==
                    "], {{0, 11}, {11, 0}}, {0., 1.},
                    ColorFunction->GrayLevel],
                   BoxForm`ImageTag[
                   "Real", ColorSpace -> Automatic, Interleaving -> None],
                   Selectable->False],
                  DefaultBaseStyle->"ImageGraphics",
                  ImageSizeRaw->{11, 11},
                  PlotRange->{{0, 11}, {0, 11}}]}], "}"}], " ", "with", " ", 
               "image", " ", "dimensions", " ", "of", " ", "myCrop"}]}]}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"masksizes", " ", "=", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"ImageData", "[", "#", "]"}]}], ",", "1."}], "]"}], 
              "&"}], "/@", "centeredMasks"}]}], " ", ";", " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "counts", " ", "nonzero", " ", "pixels", " ", "in", " ", 
              "masks"}], ",", " ", 
             RowBox[{
             "which", " ", "correspond", " ", "to", " ", "pixel", " ", "size",
               " ", "of", " ", "masks"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"mymaskedcrops", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageMultiply", "[", 
               RowBox[{"myCrop", ",", "#"}], "]"}], "&"}], "/@", 
             "centeredMasks"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"meanIntensities", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"ImageData", "[", 
                  RowBox[{"mymaskedcrops", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "/", 
               RowBox[{"masksizes", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "@", "mymaskedcrops"}], ",", "1"}], "}"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"meanBGintensity", " ", "=", "  ", 
            RowBox[{
             RowBox[{
             "meanIntensities", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "-", 
             RowBox[{
             "meanIntensities", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rgb", ",", "1", ",", "rgbL"}], "}"}]}], "]"}], "   ", 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Join", "[", 
     RowBox[{"mybarcode", ",", 
      RowBox[{"{", "out", "}"}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"myout", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"mybarcode", ",", 
       RowBox[{"{", 
        RowBox[{"{", "meanBGintensity", "}"}], "}"}]}], "]"}]}], "  ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
     "meanBGintensity", ",", "centeredMasks", ",", "mymaskedcrops", ",", 
      "masksizes"}], "}"}], "  ", "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.753066083014526*^9, 3.7530660907506104`*^9}, {
   3.753066197920163*^9, 3.7530662073301697`*^9}, {3.7530663075365133`*^9, 
   3.753066352896709*^9}, {3.753066401201453*^9, 3.753066484026576*^9}, {
   3.7530666249247828`*^9, 3.753066739225605*^9}, {3.753066810868051*^9, 
   3.753066862793532*^9}, {3.7530670389140244`*^9, 3.753067069776636*^9}, {
   3.7530678170330677`*^9, 3.753067823573358*^9}, {3.7530680610729017`*^9, 
   3.753068076686418*^9}, {3.753068123511294*^9, 3.753068189892816*^9}, {
   3.7530682374484463`*^9, 3.753068241389401*^9}, {3.753068274564357*^9, 
   3.753068289991432*^9}, {3.7530683899102697`*^9, 3.753068399860889*^9}, {
   3.753068462295621*^9, 3.7530685791884737`*^9}, {3.753068672459477*^9, 
   3.753068682146001*^9}, {3.753068748535006*^9, 3.753068780396558*^9}, {
   3.753068820795024*^9, 3.753068889328974*^9}, 3.75306899027757*^9, {
   3.753069022374606*^9, 3.7530691588762207`*^9}, {3.753625053373267*^9, 
   3.7536250581086693`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"e1d63dbf-c5dd-48b0-85e4-78a0a5cac370"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "MyDiskandDonutIntensity\n",
 StyleBox["take a line of dataframePF, make masks, center masks via padding, \
then calculate mask area, multiply mask x crop, then calculate mean \
intensity, then export stats: {background subtracted center intensity, \
background intensity, sizeDisk, sizeDonut, stdevDisk, stdevDonut}",
  FontSize->14]
}], "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
   3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
   3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
   3.750950049325511*^9, 3.750950052579129*^9}, 3.750951542405332*^9, {
   3.750951607120916*^9, 3.750951698469619*^9}, {3.750951739435706*^9, 
   3.750951769329777*^9}, {3.750951806956396*^9, 3.7509518489449253`*^9}, {
   3.7512872720804157`*^9, 3.751287276147211*^9}, {3.7536248229011383`*^9, 
   3.7536248422374372`*^9}, {3.753631344140572*^9, 
   3.7536314326529408`*^9}},ExpressionUUID->"8ce7a505-7925-491e-973c-\
586e850d2d9e"],

Cell["Module Unit Test input : ", "Text",
 CellChangeTimes->{{3.750954857477921*^9, 
  3.750954876337336*^9}},ExpressionUUID->"89ec8ae9-4e81-4d08-aaf1-\
8fa720debe01"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ImgCoord2DataCoord (integer)", "Subsection",
 CellChangeTimes->{{3.715707646859561*^9, 3.7157076885559464`*^9}, {
  3.7157157411215267`*^9, 
  3.715715743770678*^9}},ExpressionUUID->"db90326b-05c6-4a4b-9f54-\
dd85bff97e41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Img2DataCoord", "[", 
   RowBox[{"imageSize_", ",", "coordinate_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "}"}], "&"}], "@", 
     RowBox[{"Abs", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{
           "imageSize", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], "-", 
        RowBox[{"Ceiling", "@", "coordinate"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.71570769159112*^9, 3.715707770748647*^9}, {
  3.7157078970378704`*^9, 3.7157079243804345`*^9}, {3.7157079962525454`*^9, 
  3.7157079981646547`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"ce5061b3-9ff5-4863-a8ce-59d81792de4a"]
}, Closed]],

Cell[CellGroupData[{

Cell["BandPass", "Subsection",
 CellChangeTimes->{{3.5781169365680165`*^9, 
  3.57811693907802*^9}},ExpressionUUID->"fad66368-8e67-4d1a-a03c-\
8efd96b999dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BandPass", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        RowBox[{"GaussianMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"hi", ",", "lo"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"imgc", "=", 
        RowBox[{"ImageConvolve", "[", 
         RowBox[{"img", ",", 
          FractionBox[
           RowBox[{"BoxMatrix", "[", "hi", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "hi"}], "+", "1"}], ")"}], "2"]]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        FractionBox[
         RowBox[{"DiskMatrix", "[", "hi", "]"}], 
         RowBox[{"Plus", "@@", 
          RowBox[{"Plus", "@@", 
           RowBox[{"DiskMatrix", "[", "hi", "]"}]}]}]]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"imgb", ",", "imgc"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
  3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
  3.578795266902531*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"e64c9cf3-68fd-4ce2-889d-fb74f0df555f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"BandPass", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxc3XezbVWZx/uuui+io0gDksydg6STz9777JM5gKG77aBtEyQniYIoAqIe
lCgoSUREBbSRjKKAWTF29T/9Su73jk/NUdRdVXvV2mvNOeYIz3jC7wnjz99/
1p73/z9/8Ad/cH9/z/f3/33+wAc+8O53v/vAgQObN2/etm3bCSecsL6+vmfP
nu3bt//DP/zDysrKe9/73r7ZuHHj2trarl27Nm3atGHDhr//+7/fO179dNxx
x/Xe59NOO211dfVtb3tbt//zP//zSSed9B//8R99v2XLFld2++mnn/5v//Zv
Pah23ve+95188smnnHJKT+/9gx/8YP92TQ/dunVr19SHPmt8586d28ernvzd
3/1dV9bCvn376nAPqg9d2UDqZN3up63j1ZVvfetb+6kO++aYY47p167/x3/8
x/6t5R07duj8/v37Deev/uqvukafu/c973lPD2pQJqfHdW/TVeN90+P0ttt7
r/8nnnhiw+knw6xBs6fPW8br/e9/f3cdffTRTVdNnXrqqU3C2Wef3QVNeM9q
Jmu55/7rv/5rHWiuuqAu/dM//dN//ud/1o1/+Zd/Oeywwz70oQ8df/zxPVTH
+lyzZkmXGku/9mH37t21UyNd0BNruX52V73693//927pifvGq870uRb6vp40
lt67uBt7RO/NVZd1Qe30TW32iDrWhDS0Bl6bzWpzHqmYYTPTq7vqRp3pygbY
hx7XKOpnH2q81qLJPnTBnvHq3jkDzUYP6kN9+/CHP2xpoo0eUT+7qwmsV/W/
lntc9/bEuvHOd76zpfyLv/iLFqIvW8Fa7uJm4B/Hq3+7vuWIQrqgVajlvjGf
f/u3f9vtXdazaqH3Btt7z6qRHlcHehB66Ke+7Jt+tTTmthb6ppmswf3j1WVN
Zt/0XrPd0qh7epNmyK5H0qeMV9c05/W227vsr//6r7vF1oskkGh9bvjdWJt9
rmPd2LzVYFNR+01417dM9arJbFztnT53V//63F0tSq3VeB1u6v7mb/4GgXXj
scce23vt13LvNdvy1du62rQ00q7sp4bf7b3vHC+01xBqtrt63DnnnBNDqD/1
Sgt1ssnvS2TTNd1Yby1cPWn4LVMT0vfdMje7nrSzoo3a6VdbpoE0XX2uKWNE
aX3oEQje3PZlLAuN1W176l3veldjqTULXcv1oSv7tTXqvX+tXRdH861+1NLn
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
        "], {{0, 165}, {192, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->{78., Automatic},
      ImageSizeRaw->{192, 165},
      PlotRange->{{0, 192}, {0, 165}}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "12"}], "}"}]}], "]"}], "//", "ImageAdjust"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.575096671242012*^9, 3.575096685632032*^9}, {
   3.575151552048551*^9, 3.575151584238596*^9}, {3.5751527213321905`*^9, 
   3.575152738242214*^9}, {3.5787952704749374`*^9, 3.5787952717229395`*^9}, {
   3.648226188532628*^9, 3.6482261920908318`*^9}, {3.648226491268944*^9, 
   3.648226494211112*^9}, {3.6482313009610424`*^9, 3.6482313029911585`*^9}, {
   3.6482314723518453`*^9, 3.648231474766983*^9}, {3.6483038949211793`*^9, 
   3.6483038979373517`*^9}, 3.7197529874318905`*^9, 3.719756532127636*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"d4e6b430-64ae-4d9b-8784-1aaa7fe30d7d"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyThresholding", "Subsection",
 CellChangeTimes->{{3.713117663995283*^9, 
  3.7131176666674356`*^9}},ExpressionUUID->"a895c199-0c24-4689-8387-\
4c5f8da05d67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyThresholding", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myImg", "=", "img"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flagRed", ",", "flagGreen", ",", "flagBlue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flagRed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], ")"}]}], 
          ",", 
          RowBox[{
           RowBox[{"thred", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thred"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagGreen", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], ")"}]}],
           ",", 
          RowBox[{
           RowBox[{"thgreen", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thgreen"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagBlue", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thblue.dat\>\""}], ")"}]}], 
          ",", 
          RowBox[{
           RowBox[{"thblue", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thblue.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thblue"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"Manipulator", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", 
        RowBox[{
         RowBox[{"Column", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myImg", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], 
                "&"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Red Threshold  : \>\"", "<>", "flagRed"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Green Threshold: \>\"", "<>", "flagGreen"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Blue Threshold : \>\"", "<>", "flagBlue"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"color", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
             RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
             RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "myImg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold1", ",", "0.01"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Save Threshold\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"thred", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"flagRed", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thred"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"thred", ">>", 
                RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "2"}], ",", 
              RowBox[{
               RowBox[{"thgreen", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagGreen", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thgreen"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thgreen", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thgreen.dat\>\""}]}]}]}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], ",", 
              RowBox[{
               RowBox[{"thblue", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagBlue", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thblue"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thblue", ">>", 
                RowBox[{"analysisFolder", "<>", "\"\<_thblue.dat\>\""}]}]}]}],
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], "&&", 
               RowBox[{"ValueQ", "@", "thred"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thred"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], "&&", 
               RowBox[{"ValueQ", "@", "thgreen"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thgreen"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], "&&", 
               RowBox[{"ValueQ", "@", "thblue"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thblue"}]}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.71311477549407*^9, 3.713115047105606*^9}, {
   3.7131151313864264`*^9, 3.7131151317224455`*^9}, {3.713115176105984*^9, 
   3.71311524684203*^9}, {3.7131152824100647`*^9, 3.71311533880329*^9}, {
   3.7131153694430428`*^9, 3.7131153772424884`*^9}, {3.713115557426794*^9, 
   3.7131155639231663`*^9}, {3.7131156055385466`*^9, 
   3.7131156140430326`*^9}, {3.713115714765794*^9, 3.713115717363942*^9}, {
   3.7131157802195377`*^9, 3.7131158982832904`*^9}, {3.7131159299871035`*^9, 
   3.713115946627055*^9}, {3.7131160469557943`*^9, 3.7131160525641146`*^9}, {
   3.7131170980459127`*^9, 3.7131171494368525`*^9}, {3.7131172670045767`*^9, 
   3.7131172728449106`*^9}, {3.7131173345974426`*^9, 3.7131174051574783`*^9}, 
   3.7131174585005293`*^9, {3.7131184818940644`*^9, 3.7131185203572645`*^9}, {
   3.7131191217586627`*^9, 3.71311913098219*^9}, {3.7131191695663967`*^9, 
   3.7131191793019543`*^9}, {3.7131192385663433`*^9, 3.713119240806472*^9}, {
   3.713120509503037*^9, 3.7131205660152693`*^9}, {3.7131232576092196`*^9, 
   3.7131232793214617`*^9}, {3.7131235614495983`*^9, 3.713123571710185*^9}, {
   3.7131826018405156`*^9, 3.713182620017555*^9}, {3.7166680370076284`*^9, 
   3.716668098192128*^9}, {3.716668276360319*^9, 3.7166683499365273`*^9}, {
   3.7166684302801228`*^9, 3.716668482617116*^9}, {3.716668517240096*^9, 
   3.7166685530891466`*^9}, 3.7166702604908047`*^9, 3.7169062389820023`*^9, {
   3.7174333794424405`*^9, 3.7174333865958495`*^9}, {3.7179422555525503`*^9, 
   3.7179424707438583`*^9}, 3.7179430071455383`*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"3cd9d0d8-7296-40db-91d9-6b40328a0da3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyThresholding3D", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myImg", "=", "img"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flagRed", ",", "flagGreen", ",", "flagBlue3D"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"flagRed", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{"thred", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{
             RowBox[{"ToString", "@", "thred"}], "<>", 
             "\"\<  Already Saved\>\""}]}], ",", 
           "\"\<Not Yet Determined\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flagGreen", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thgreen", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{
             RowBox[{"ToString", "@", "thgreen"}], "<>", 
             "\"\<  Already Saved\>\""}]}], ",", 
           "\"\<Not Yet Determined\>\""}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flagBlue3D", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thblue3D.dat\>\""}], 
            ")"}]}], ",", 
          RowBox[{
           RowBox[{"thblue3D", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thblue3D.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thblue3D"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"Manipulator", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", 
        RowBox[{
         RowBox[{"Column", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myImg", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "z"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], 
                "&"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\"\<Red Threshold  : \>\"", "<>", "flagRed"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Green Threshold: \>\"", "<>", "flagGreen"}], ","}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"\"\<Blue Threshold 3D : \>\"", "<>", "flagBlue3D"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "myImg"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z", ",", 
             RowBox[{"Round", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{
                 "myImg", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "/", "2"}], ")"}]}]}], "}"}], 
           ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{
            "myImg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold1", ",", "0.01"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Save Threshold\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"thred", "=", 
                 RowBox[{"{", 
                  RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagRed", "=", 
                 RowBox[{
                  RowBox[{"ToString", "@", "thred"}], "<>", 
                  "\"\<Saved\>\""}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"thred", ">>", 
                 RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}]}]}]}],
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], ",", 
               RowBox[{
                RowBox[{"thgreen", "=", 
                 RowBox[{"{", 
                  RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
                RowBox[{"flagGreen", "=", 
                 RowBox[{
                  RowBox[{"ToString", "@", "thgreen"}], "<>", 
                  "\"\<Saved\>\""}]}], ";", 
                RowBox[{"thgreen", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thgreen.dat\>\""}]}]}]}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], ","}]}], "*)"}], 
           RowBox[{
            RowBox[{"thblue3D", "=", 
             RowBox[{"{", 
              RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
            RowBox[{"flagBlue3D", "=", 
             RowBox[{
              RowBox[{"ToString", "@", "thblue3D"}], "<>", 
              "\"\<  Saved\>\""}]}], ";", 
            RowBox[{"thblue3D", ">>", 
             RowBox[{"analysisFolder", "<>", "\"\<_thblue3D.dat\>\""}]}], 
            RowBox[{"(*", "]", "*)"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "1"}], "&&", 
                RowBox[{"ValueQ", "@", "thred"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
                "thred"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "2"}], "&&", 
                RowBox[{"ValueQ", "@", "thgreen"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
                "thgreen"}]}], "]"}], ";"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], "&&"}], "*)"}], 
            RowBox[{
             RowBox[{"ValueQ", "@", "thblue3D"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
              "thblue3D"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7185591101571407`*^9, 3.7185593449895725`*^9}, {
  3.7186414361979213`*^9, 3.7186414613663607`*^9}, {3.7186417151428757`*^9, 
  3.7186417163909473`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"3c2439b2-e874-4057-ae6c-128c0256da2a"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyBinarization", "Subsection",
 CellChangeTimes->{{3.71311410796889*^9, 
  3.7131141110090637`*^9}},ExpressionUUID->"27295f72-fb1e-4693-962f-\
c0cb0e131e02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyBinarization", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "threshold1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
           "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "flagRed", ",", "flagGreen", ",", "flagBlue", ",", "max", ",", "imga",
          ",", "imgb", ",", "color", ",", "frame", ",", "threshold", ",", 
         "lowpass", ",", "hipass", ",", "lo", ",", "hi", ",", "myOutline", 
         ",", "myFill"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flagRed", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], ")"}]}],
            ",", 
           RowBox[{
            RowBox[{"thredAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thredAll"}], ",", 
              "\"\<Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flagGreen", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thgreenAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
              "\"\<Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flagBlue", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thblue2.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thblueAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thblue2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thblueAll"}], ",", 
              "\"\<Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"SetOptions", "[", 
         RowBox[{"Manipulator", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"imga", "=", 
            RowBox[{"ImageAdjust", "[", 
             RowBox[{
              RowBox[{"myImg", "\[LeftDoubleBracket]", 
               RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
              RowBox[{
              "threshold1", "\[LeftDoubleBracket]", "color", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"max", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"BandPass", "[", 
               RowBox[{
                RowBox[{"ImageMultiply", "[", 
                 RowBox[{
                  RowBox[{"ImageAdjust", "[", 
                   RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "1"}], "\[RightDoubleBracket]"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
                    RowBox[{
                    "threshold1", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "mask"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}], "//", 
              "ImageData"}], "//", "Max"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"imgb", "=", 
            RowBox[{"SelectComponents", "[", 
             RowBox[{
              RowBox[{"ImageMultiply", "[", 
               RowBox[{
                RowBox[{"Binarize", "[", 
                 RowBox[{
                  RowBox[{"BandPass", "[", 
                   RowBox[{"imga", ",", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}], ",", 
                  RowBox[{"max", " ", "threshold"}]}], "]"}], ",", "mask"}], 
               "]"}], ",", "\"\<Count\>\"", ",", 
              RowBox[{
               RowBox[{"lo", "<", "#", "<", "hi"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GraphicsRow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Show", "[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myOutline", "\[Equal]", "True"}], "&&", 
                    RowBox[{"myFill", "\[Equal]", "False"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"imga", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ComponentMeasurements", "[", 
                    RowBox[{"imgb", ",", "\"\<Contours\>\""}], "]"}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myFill", "\[Equal]", "True"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"imga", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Polygon", "@", "#"}]}], "}"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ComponentMeasurements", "[", 
                    RowBox[{"imgb", ",", "\"\<Contours\>\""}], "]"}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", "imga"}], 
                    "]"}]}], "]"}], "]"}], ",", "imgb"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TableForm", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\>\"", ",", "\"\<max\>\"", ",", "\"\<threshold\>\"", 
                   ",", "\"\<bandpass\>\"", ",", "\"\<particle size\>\""}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{"flagRed", ",", "\"\<Red Threshold 2   :\>\""}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{"flagGreen", ",", "\"\<Green Threshold 2 :\>\""}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{"flagBlue", ",", "\"\<Blue Threshold 2  :\>\""}], 
                  "]"}]}], "}"}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"color", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
              RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
              RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myImg", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"threshold", ",", "0.1"}], "}"}], ",", "0", ",", "1", 
            ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lowpass", ",", "1"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hipass", ",", "7"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lo", ",", "5"}], "}"}], ",", "0", ",", "20", ",", "1"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hi", ",", "100"}], "}"}], ",", "10", ",", "1000", ",", 
            "1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<Display options: \>\"", ",", 
             RowBox[{"Spacer", "@", "5"}], ",", "\"\<outline \>\"", ",", 
             RowBox[{"Checkbox", "[", 
              RowBox[{"Dynamic", "@", "myOutline"}], "]"}], ",", 
             RowBox[{"Spacer", "@", "10"}], ",", "\"\<filled \>\"", ",", 
             RowBox[{"Checkbox", "[", 
              RowBox[{"Dynamic", "@", "myFill"}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Save Threshold 2\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"thredAll", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mymaxred", "=", "max"}], ",", 
                   RowBox[{"thred2", "=", "threshold"}], ",", 
                   RowBox[{"bandpassred", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                   RowBox[{"dotsizered", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagRed", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"ToString", "/@", "thredAll"}], ",", 
                   "\"\<Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"thredAll", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thred2.dat\>\""}]}]}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], ",", 
               RowBox[{
                RowBox[{"thgreenAll", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mymaxgreen", "=", "max"}], ",", 
                   RowBox[{"thgreen2", "=", "threshold"}], ",", 
                   RowBox[{"bandpassgreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                   RowBox[{"dotsizegreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                RowBox[{"flagGreen", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
                   "\"\<Saved\>\""}], "]"}]}], ";", 
                RowBox[{"thgreenAll", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}]}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], ",", 
               RowBox[{
                RowBox[{"thblueAll", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mymaxblue", "=", "max"}], ",", 
                   RowBox[{"thblue2", "=", "threshold"}], ",", 
                   RowBox[{"bandpassblue", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                   RowBox[{"dotsizeblue", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagBlue", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"ToString", "/@", "thblueAll"}], ",", 
                   "\"\<Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"thblueAll", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thblue2.dat\>\""}]}]}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "1"}], "&&", 
                RowBox[{"ValueQ", "@", "thredAll"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", "threshold", ",", 
                  RowBox[{"{", 
                   RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                "thredAll"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "2"}], "&&", 
                RowBox[{"ValueQ", "@", "thgreenAll"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", "threshold", ",", 
                  RowBox[{"{", 
                   RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                "thgreenAll"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "3"}], "&&", 
                RowBox[{"ValueQ", "@", "thblueAll"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", "threshold", ",", 
                  RowBox[{"{", 
                   RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                "thblueAll"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7131841049224873`*^9, 3.7131841932585397`*^9}, {
   3.7131843328755255`*^9, 3.713184435515396*^9}, {3.713184478715867*^9, 
   3.7131845394673414`*^9}, {3.713184625946288*^9, 3.7131846392040462`*^9}, {
   3.7131847116601906`*^9, 3.7131847117871976`*^9}, {3.713186711469573*^9, 
   3.7131867951253576`*^9}, {3.713186834756624*^9, 3.7131869018374615`*^9}, {
   3.713187223207843*^9, 3.713187224589922*^9}, {3.7131872578378234`*^9, 
   3.7131873188943157`*^9}, {3.7131873600926723`*^9, 
   3.7131873820939302`*^9}, {3.713187748766903*^9, 3.7131877488939104`*^9}, 
   3.713187904446807*^9, {3.713188219446824*^9, 3.713188279646268*^9}, 
   3.7131883351344414`*^9, {3.7131888887031035`*^9, 3.713188927351314*^9}, {
   3.7131889758730893`*^9, 3.713188982431464*^9}, {3.7166686764812045`*^9, 
   3.7166688942106576`*^9}, 3.7166702543794546`*^9, {3.716735928614806*^9, 
   3.716735988719244*^9}, {3.716736085134759*^9, 3.7167360934152327`*^9}, {
   3.7167361571758795`*^9, 3.7167362008393764`*^9}, {3.716906052159316*^9, 
   3.7169060532543793`*^9}, {3.7174333178519173`*^9, 3.71743334342038*^9}, 
   3.717433388805976*^9, {3.7179430208503227`*^9, 3.717943109562396*^9}, 
   3.717943226355077*^9, {3.717975480387902*^9, 3.7179754811719465`*^9}, {
   3.71864149614635*^9, 3.7186415213427916`*^9}, {3.7186415716556687`*^9, 
   3.71864161258701*^9}, {3.718643873009299*^9, 3.718643887489127*^9}, 
   3.719275482931738*^9, 3.7197594166796227`*^9, {3.7197704322556777`*^9, 
   3.719770487855858*^9}, {3.719770576023901*^9, 3.7197705867205124`*^9}, {
   3.71977073616006*^9, 3.7197707689039326`*^9}, {3.7197708854726*^9, 
   3.7197709295771227`*^9}, {3.7197710785686445`*^9, 
   3.7197712434890776`*^9}, {3.719771354449424*^9, 3.719771419025118*^9}, {
   3.719771461363539*^9, 3.7197714856339273`*^9}, {3.7197715282983675`*^9, 
   3.719771643057932*^9}, {3.7197716903786383`*^9, 3.7197717895703115`*^9}, 
   3.719772309700061*^9, {3.7197727494912157`*^9, 3.719772755139539*^9}, 
   3.719772788883469*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"1cccd39f-223a-4539-9b26-49509d8f9395"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyBinarization3D", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "threshold1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ","}], 
           "*)"}], "\"\<_thblue.dat\>\"", "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "flagRed", ",", "flagGreen", ",", "flagBlue3D", ",", "max", ",", 
         "imgb", ",", "color", ",", "frame", ",", "threshold", ",", "lowpass",
          ",", "hipass", ",", "lo", ",", "hi"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"flagRed", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "@", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"thredAll", "=", 
              RowBox[{"<<", 
               RowBox[{"(", 
                RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], 
                ")"}]}]}], ";", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"ToString", "/@", "thredAll"}], ",", 
               "\"\<Already Saved\>\""}], "]"}]}], ",", 
            RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"flagGreen", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "@", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"thgreenAll", "=", 
              RowBox[{"<<", 
               RowBox[{"(", 
                RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
                ")"}]}]}], ";", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
               "\"\<Already Saved\>\""}], "]"}]}], ",", 
            RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flagBlue3D", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thblue3D2.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thblue3DAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thblue3D2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thblue3DAll"}], ",", 
              "\"\<  Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"color", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"SetOptions", "[", 
         RowBox[{"Manipulator", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"max", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"BandPass", "[", 
               RowBox[{
                RowBox[{"ImageMultiply", "[", 
                 RowBox[{
                  RowBox[{"ImageAdjust", "[", 
                   RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"Round", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myImg", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "/", "2"}], ")"}]}]}], 
                    "\[RightDoubleBracket]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
                    RowBox[{
                    "threshold1", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "mask"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}], "//", 
              "ImageData"}], "//", "Max"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"imgb", "=", 
            RowBox[{"BandPass", "[", 
             RowBox[{
              RowBox[{"ImageAdjust", "[", 
               RowBox[{
                RowBox[{"myImg", "\[LeftDoubleBracket]", 
                 RowBox[{"frame", ",", "z"}], "\[RightDoubleBracket]"}], " ", 
                ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
                RowBox[{
                "threshold1", "\[LeftDoubleBracket]", "color", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GraphicsRow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ImageAdjust", "[", 
                   RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{"frame", ",", "z"}], "\[RightDoubleBracket]"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
                    RowBox[{
                    "threshold1", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"SelectComponents", "[", 
                   RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{
                    RowBox[{"Binarize", "[", 
                    RowBox[{"imgb", ",", 
                    RowBox[{"max", " ", "threshold"}]}], "]"}], ",", "mask"}],
                     "]"}], ",", "\"\<Count\>\"", ",", 
                    RowBox[{
                    RowBox[{"lo", "<", "#", "<", "hi"}], "&"}]}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TableForm", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\>\"", ",", "\"\<max\>\"", ",", "\"\<threshold\>\"", 
                   ",", "\"\<bandpass\>\"", ",", "\"\<particle size\>\""}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Prepend", "[", 
                    RowBox[{"flagRed", ",", "\"\<Red Threshold 2   :\>\""}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Prepend", "[", 
                    RowBox[{"flagGreen", ",", "\"\<Green Threshold 2 :\>\""}],
                     "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{
                  "flagBlue3D", ",", "\"\<Blue Threshold 3D 2  :\>\""}], 
                  "]"}]}], "}"}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", "myImg"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"Round", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{
                  "myImg", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "/", "2"}], ")"}]}]}], "}"}], 
            ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myImg", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"threshold", ",", "0.1"}], "}"}], ",", "0", ",", "1", 
            ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lowpass", ",", "1"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hipass", ",", "7"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lo", ",", "5"}], "}"}], ",", "0", ",", "20", ",", "1"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hi", ",", "100"}], "}"}], ",", "10", ",", "1000", ",", 
            "1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Save Threshold 3D 2\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"color", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"thredAll", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"mymaxred", "=", "max"}], ",", 
                    RowBox[{"thred2", "=", "threshold"}], ",", 
                    RowBox[{"bandpassred", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                    RowBox[{"dotsizered", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"flagRed", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"ToString", "/@", "thredAll"}], ",", 
                    "\"\<Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"thredAll", ">>", 
                  RowBox[{
                  "analysisFolder", "<>", "\"\<_thred2.dat\>\""}]}]}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"color", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"thgreenAll", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"mymaxgreen", "=", "max"}], ",", 
                    RowBox[{"thgreen2", "=", "threshold"}], ",", 
                    RowBox[{"bandpassgreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                    RowBox[{"dotsizegreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                 RowBox[{"flagGreen", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
                    "\"\<Saved\>\""}], "]"}]}], ";", 
                 RowBox[{"thgreenAll", ">>", 
                  RowBox[{
                  "analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}]}]}]}], 
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], ","}]}], "*)"}], 
            RowBox[{
             RowBox[{"thblue3DAll", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mymaxblue3D", "=", "max"}], ",", 
                RowBox[{"thblue3D2", "=", "threshold"}], ",", 
                RowBox[{"bandpassblue3D", "=", 
                 RowBox[{"{", 
                  RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                RowBox[{"dotsizeblue3D", "=", 
                 RowBox[{"{", 
                  RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"flagBlue3D", "=", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"ToString", "/@", "thblue3DAll"}], ",", 
                "\"\<  Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"thblue3DAll", ">>", 
              RowBox[{
              "analysisFolder", "<>", "\"\<_thblue3D2.dat\>\""}]}]}]}], 
           RowBox[{"(*", 
            RowBox[{"]", ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"color", "\[Equal]", "1"}], "&&", 
                 RowBox[{"ValueQ", "@", "thredAll"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"max", ",", "threshold", ",", 
                   RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                 "thredAll"}]}], "]"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"color", "\[Equal]", "2"}], "&&", 
                 RowBox[{"ValueQ", "@", "thgreenAll"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"max", ",", "threshold", ",", 
                   RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                 "thgreenAll"}]}], "]"}], ";"}], "*)"}], 
            RowBox[{"If", "[", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], "&&"}], "*)"}], 
             RowBox[{
              RowBox[{"ValueQ", "@", "thblue3DAll"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"max", ",", "threshold", ",", 
                 RowBox[{"{", 
                  RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
               "thblue3DAll"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7186417253914623`*^9, 3.7186419242398357`*^9}, {
  3.71864355709723*^9, 3.7186437180654364`*^9}, {3.7186437815850697`*^9, 
  3.7186437992340794`*^9}, {3.7186438951775665`*^9, 3.7186438992097974`*^9}, {
  3.7186439718829536`*^9, 3.7186439745701075`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"f4a75cf4-6246-4a13-887a-fec3c1c800d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindParticles", "Subsection",
 CellChangeTimes->{{3.578116942838025*^9, 
  3.5781169456080294`*^9}},ExpressionUUID->"ea107ba6-6c6d-42e3-83ad-\
2aee4bbc61e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindParticlesWeighted", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"imgb", "//", 
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"max", " ", "th"}]}], "]"}], "&"}]}], ",", "imgmask"}], 
         "]"}], ",", "\"\<Count\>\"", ",", 
        RowBox[{
         RowBox[{"small", "<", "#", "<", "large"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{"img", ",", "imgc"}], "]"}], ",", 
        RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Color", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Circle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"hi", " ", "1.5"}]}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"pos", "=", 
              RowBox[{
               RowBox[{"ComponentMeasurements", "[", 
                RowBox[{"imgc", ",", 
                 RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}]}], 
             ")"}]}]}], "}"}], "]"}]}], "]"}], ",", "pos"}], "}"}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5751527958022947`*^9, 3.5751528802924128`*^9}, {
   3.575152925492476*^9, 3.575153061152666*^9}, {3.5751531432227807`*^9, 
   3.5751531438627815`*^9}, {3.575153188922845*^9, 3.575153245352924*^9}, {
   3.5751533274730387`*^9, 3.5751533584830823`*^9}, {3.575153416033163*^9, 
   3.575153416743164*^9}, {3.575153718293586*^9, 3.5751537187735863`*^9}, {
   3.575157436595137*^9, 3.575157459425169*^9}, {3.5751582558262844`*^9, 
   3.5751582568962855`*^9}, {3.575166234180505*^9, 3.5751662566605363`*^9}, {
   3.5752405029781218`*^9, 3.5752405155081396`*^9}, 3.5752409476101503`*^9, {
   3.575241075013016*^9, 3.575241093953043*^9}, {3.575241128623091*^9, 
   3.5752411288630915`*^9}, {3.575241197793188*^9, 3.5752411981431885`*^9}, {
   3.5752413495734005`*^9, 3.5752413764734383`*^9}, {3.608917991298159*^9, 
   3.608917992241254*^9}, {3.6464847677413335`*^9, 3.646484783389229*^9}, {
   3.6485836816759624`*^9, 3.648583758596362*^9}, {3.6485838271562834`*^9, 
   3.6485838425561647`*^9}, {3.648584935277664*^9, 3.648584935773693*^9}, {
   3.653239142652603*^9, 3.653239166804985*^9}, {3.653239283964686*^9, 
   3.6532393084690876`*^9}, {3.6550415999770727`*^9, 
   3.6550416069970846`*^9}, {3.655041804633832*^9, 3.655041805772634*^9}, {
   3.6550418792175627`*^9, 3.6550418826339693`*^9}, {3.655059163882098*^9, 
   3.655059163986104*^9}, {3.655059211210805*^9, 3.655059211353813*^9}, {
   3.6552216016280055`*^9, 3.655221607020314*^9}, {3.6552232897335596`*^9, 
   3.6552232946458406`*^9}, {3.6552233416135273`*^9, 3.655223392261424*^9}, {
   3.6552241750611973`*^9, 3.65522418961403*^9}, {3.6553853018305316`*^9, 
   3.6553853463590784`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"9157950d-031c-400b-b750-3a41159e3a40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindParticles", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "compResults"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Binarize", "[", 
            RowBox[{"imgb", ",", " ", 
             RowBox[{"max", " ", "th"}]}], "]"}]}], ",", "imgmask"}], "]"}], 
        ",", "\"\<Count\>\"", ",", 
        RowBox[{
         RowBox[{"small", "<", "#", "<", "large"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"compResults", "=", 
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{"img", ",", "imgc"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
          "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
          "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
          "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
          "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compResults", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7147583971303506`*^9, 3.714758408167982*^9}, 
   3.7147584663613105`*^9, {3.714759074449091*^9, 3.7147591860164723`*^9}, {
   3.715380673551758*^9, 3.71538067971211*^9}, {3.715434171802683*^9, 
   3.7154341776260157`*^9}, {3.7157340160817947`*^9, 3.7157340224781604`*^9}, 
   3.716227279614752*^9, {3.716227323727275*^9, 3.7162273973594866`*^9}, {
   3.7162274765670166`*^9, 3.7162275061277075`*^9}, {3.717507076675681*^9, 
   3.7175070820519886`*^9}, {3.717507117202999*^9, 3.717507123539361*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"fb0061be-db34-4dd4-a1eb-c76f86f484eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"After", " ", "finding", " ", "particles"}], ",", " ", 
    RowBox[{"add", " ", "track", " ", "number", " ", "as", " ", "0"}], ",", 
    " ", 
    RowBox[{"and", " ", "add", " ", "frame", " ", "number"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyParticleFinder", "[", 
    RowBox[{"myColMovie_", ",", "channel_", ",", "analysisFolder_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "threshold1", ",", "threshold2", ",", "imgmask", ",", "bandpass", ",", 
       "dotsize", ",", "max", ",", "th2", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"threshold1", "=", 
       RowBox[{"Get", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
            "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"threshold2", "=", 
       RowBox[{"Get", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ",", 
            "\"\<_thblue2.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imgmask", "=", 
       RowBox[{"Import", "@", 
        RowBox[{"(", 
         RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
       RowBox[{"threshold2", "\[LeftDoubleBracket]", 
        RowBox[{"channel", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"max", ",", "th2"}], "}"}], "=", 
       RowBox[{"threshold2", "\[LeftDoubleBracket]", 
        RowBox[{"channel", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"FindParticles", "[", 
          RowBox[{
           RowBox[{"ImageAdjust", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{
             "threshold1", "\[LeftDoubleBracket]", "channel", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", "bandpass", ",", "max",
            ",", "th2", ",", "imgmask", ",", "dotsize"}], "]"}], "&"}], "/@", 
        RowBox[{
        "myColMovie", "\[LeftDoubleBracket]", "channel", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Thread", "@", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
            "result", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "result"}], ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
        "result"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7147583971303506`*^9, 3.714758408167982*^9}, 
   3.7147584663613105`*^9, {3.714759074449091*^9, 3.7147591860164723`*^9}, {
   3.715380673551758*^9, 3.71538067971211*^9}, {3.715434171802683*^9, 
   3.7154341776260157`*^9}, {3.7157340160817947`*^9, 3.7157340224781604`*^9}, 
   3.716227279614752*^9, {3.716227323727275*^9, 3.7162273973594866`*^9}, {
   3.7162274765670166`*^9, 3.7162275061277075`*^9}, {3.717507076675681*^9, 
   3.7175070820519886`*^9}, {3.717507117202999*^9, 3.717507123539361*^9}, {
   3.717509271589223*^9, 3.717509293909499*^9}, {3.717509331916673*^9, 
   3.7175094269971113`*^9}, {3.717509507004688*^9, 3.7175095835090637`*^9}, {
   3.717509644237537*^9, 3.7175097021328487`*^9}, {3.717510019574005*^9, 
   3.7175100234212255`*^9}, {3.7175101642622805`*^9, 
   3.7175101680614977`*^9}, {3.71751024729403*^9, 3.71751027491761*^9}, {
   3.717521561879187*^9, 3.7175215686705756`*^9}, 3.717521646888049*^9, {
   3.717521682112064*^9, 3.71752175459921*^9}, {3.717522233039575*^9, 
   3.71752228906378*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"c8eb5bcb-356b-404e-a8ac-e1b4af35decb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGranuleMasks", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Binarize", "[", 
            RowBox[{"imgb", ",", " ", 
             RowBox[{"max", " ", "th"}]}], "]"}]}], ",", "imgmask"}], "]"}], 
        ",", "\"\<Count\>\"", ",", 
        RowBox[{
         RowBox[{"small", "<", "#", "<", "large"}], "&"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.715433047700388*^9, 3.7154330762730217`*^9}, {
  3.715434158130901*^9, 3.715434164106242*^9}, {3.717523811400852*^9, 
  3.7175238219614563`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"051eaf6e-8a40-495d-adfa-d532a78b7686"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myGranuleMaskFinder", "[", 
   RowBox[{"myColMovie_", ",", "channel_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "threshold1", ",", "threshold2", ",", "imgmask", ",", "bandpass", ",", 
      "dotsize", ",", "max", ",", "th2", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
           "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold2", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ",", 
           "\"\<_thblue2.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgmask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
      RowBox[{"threshold2", "\[LeftDoubleBracket]", 
       RowBox[{"channel", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"max", ",", "th2"}], "}"}], "=", 
      RowBox[{"threshold2", "\[LeftDoubleBracket]", 
       RowBox[{"channel", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FindGranuleMasks", "[", 
        RowBox[{
         RowBox[{"ImageAdjust", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{
           "threshold1", "\[LeftDoubleBracket]", "channel", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", "bandpass", ",", "max", 
         ",", "th2", ",", "imgmask", ",", "dotsize"}], "]"}], "&"}], "/@", 
      RowBox[{
      "myColMovie", "\[LeftDoubleBracket]", "channel", 
       "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717523855883397*^9, 3.7175239911131315`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"e2f08ea4-c04d-445c-9a17-dfc86bd78bee"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PairConnect2 (still one small error, but doesn\[CloseCurlyQuote]t seem to \
mess up stuff)\
\>", "Subsection",
 CellChangeTimes->{{3.578373737283985*^9, 3.578373754802816*^9}, {
  3.6425405298598948`*^9, 3.6425405335598993`*^9}, {3.642540631241037*^9, 
  3.6425406446910553`*^9}, {3.6483824557337046`*^9, 
  3.648382456997307*^9}},ExpressionUUID->"0d56f4d5-27d6-4886-954c-\
901b4816b290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "finalticker", ",", "list1", ",", "list2", ",", "flag",
       ",", "out", ",", "newTracks", ",", "mypos", ",", "myind", ",", "myl", 
      ",", "out2", ",", "out3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myind", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mypos", "=", 
          RowBox[{"list2", "\[LeftDoubleBracket]", 
           RowBox[{"myind", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"list1", "\[LeftDoubleBracket]", 
                RowBox[{"m", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
               "-", "dist"}], "\[LessEqual]"}], " ", "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{"mypos", "\[LessEqual]", 
               RowBox[{
                RowBox[{"list1", "\[LeftDoubleBracket]", 
                 RowBox[{"m", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}],
                 "+", "dist"}]}], " ", "&&", 
              RowBox[{"myind", "\[LessEqual]", " ", 
               RowBox[{"Length", "@", "list2"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"EuclideanDistance", "[", 
                  RowBox[{
                   RowBox[{
                   "list2", "\[LeftDoubleBracket]", "myind", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"list1", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "]"}], "\[LessEqual]", "dist"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"list1", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "list2", "\[LeftDoubleBracket]", "myind", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"list2", "=", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"list2", ",", "myind"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"myind", "=", 
                  RowBox[{"myind", "-", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"flag", "=", 
                  RowBox[{"flag", "+", "1"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myind", "=", 
               RowBox[{"myind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "list2"}], ">", "0"}], "&&", 
                 RowBox[{"myind", "\[LessEqual]", 
                  RowBox[{"Length", "@", "list2"}]}]}], ",", 
                RowBox[{"mypos", "=", 
                 RowBox[{"list2", "\[LeftDoubleBracket]", 
                  RowBox[{"myind", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                ",", 
                RowBox[{"m", "=", 
                 RowBox[{"Length", "@", "list1"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", 
          RowBox[{"Length", "@", "list1"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}]}], ",", "Null"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "list2"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"finalticker", "=", 
         RowBox[{"newticker", "+", 
          RowBox[{"Length", "[", "list2", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newTracks", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"newticker", "+", "1"}], ",", "finalticker"}], "]"}], 
            ",", "list2"}], "}"}], "//", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"out3", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"out2", ",", "newTracks"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"finalticker", "=", "newticker"}], ";", "\[IndentingNewLine]", 
        RowBox[{"out3", "=", "out2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"finalticker", ",", "out3"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.578278483426984*^9, 3.578278527017045*^9}, {
   3.578278617567171*^9, 3.578278812177444*^9}, {3.578278860177511*^9, 
   3.578278958617649*^9}, {3.5782790527777805`*^9, 3.5782791306678896`*^9}, {
   3.578279228338026*^9, 3.5782792824481025`*^9}, {3.578279331708171*^9, 
   3.57827937375923*^9}, {3.5782797231797194`*^9, 3.5782797524497604`*^9}, {
   3.5782798062098355`*^9, 3.578279820769856*^9}, {3.578279860929912*^9, 
   3.578279877759936*^9}, {3.5782800389101615`*^9, 3.5782800426101665`*^9}, {
   3.5782801504503174`*^9, 3.5782802956605206`*^9}, {3.5782803604306116`*^9, 
   3.5782803672306213`*^9}, {3.5782804440807285`*^9, 3.578280470540766*^9}, {
   3.5782805111508226`*^9, 3.5782805168008304`*^9}, {3.5782805968509426`*^9, 
   3.5782805970109425`*^9}, {3.5782806657110386`*^9, 
   3.5782806854210663`*^9}, {3.5782807162611094`*^9, 
   3.5782807175111113`*^9}, {3.5782807897512126`*^9, 3.578280792511216*^9}, {
   3.5782808529913015`*^9, 3.5782808624313145`*^9}, 3.578280908081378*^9, {
   3.5782809467514324`*^9, 3.5782810046925135`*^9}, {3.5782810446625695`*^9, 
   3.5782810505625772`*^9}, {3.5782811481127143`*^9, 
   3.5782811696327443`*^9}, {3.578281283622904*^9, 3.5782812974929237`*^9}, {
   3.578281465663159*^9, 3.578281465853159*^9}, {3.578281551223279*^9, 
   3.578281564433297*^9}, {3.5782816376533995`*^9, 3.578281646533412*^9}, {
   3.578282025693943*^9, 3.5782820302239494`*^9}, {3.5782822587442694`*^9, 
   3.578282264654278*^9}, {3.5782823233143597`*^9, 3.57828232345436*^9}, {
   3.5782825197346344`*^9, 3.578282525154642*^9}, {3.578282604784754*^9, 
   3.5782826048347535`*^9}, {3.5782826819758615`*^9, 
   3.5782826900358734`*^9}, {3.5782827276359253`*^9, 3.578282894096159*^9}, {
   3.578282962536255*^9, 3.5782829667562604`*^9}, {3.5782831375564995`*^9, 
   3.5782831679665422`*^9}, {3.578283206996597*^9, 3.5782832870267086`*^9}, {
   3.578283348096794*^9, 3.578283367776822*^9}, {3.578283470656966*^9, 
   3.578283492016996*^9}, {3.5782839458876314`*^9, 3.5782839944376993`*^9}, {
   3.5782841031378517`*^9, 3.578284113677866*^9}, {3.5782842223180184`*^9, 
   3.5782842223880186`*^9}, {3.5782843294291687`*^9, 
   3.5782843302791696`*^9}, {3.5782844209192963`*^9, 3.578284457309347*^9}, {
   3.578284550769478*^9, 3.5782845508994784`*^9}, {3.578284822663619*^9, 
   3.57828484069565*^9}, {3.5782853893969555`*^9, 3.578285423857003*^9}, {
   3.578285545237173*^9, 3.578285545617174*^9}, {3.5782858759376364`*^9, 
   3.578285897557667*^9}, {3.578286003598815*^9, 3.5782860371688623`*^9}, {
   3.5782861572790303`*^9, 3.57828615737903*^9}, {3.5782862077491007`*^9, 
   3.5782862166091137`*^9}, {3.5782862581791716`*^9, 3.5782862847992086`*^9}, 
   3.578286325379266*^9, {3.578286401229372*^9, 3.5782864672294645`*^9}, {
   3.578286510369525*^9, 3.578286511389526*^9}, {3.5782870152702312`*^9, 
   3.578287016370233*^9}, {3.5782872721305914`*^9, 3.5782873117806463`*^9}, {
   3.5782874462608347`*^9, 3.5782874467208357`*^9}, {3.5782874911708975`*^9, 
   3.5782874941909018`*^9}, {3.5782876928021803`*^9, 3.578287701252192*^9}, {
   3.5782877771222982`*^9, 3.578287777862299*^9}, {3.578288352623104*^9, 
   3.578288353153105*^9}, {3.578288429383211*^9, 3.578288430623213*^9}, {
   3.5782885667834034`*^9, 3.5782885799034224`*^9}, {3.578288708243602*^9, 
   3.5782887524836636`*^9}, {3.578288898613868*^9, 3.578288905053877*^9}, {
   3.5782893486954985`*^9, 3.5782893521655035`*^9}, {3.578291437249422*^9, 
   3.5782914925594997`*^9}, 3.578291604639657*^9, {3.6425306412239523`*^9, 
   3.642530683860013*^9}, {3.642530742362096*^9, 3.6425308047651834`*^9}, {
   3.642531019962491*^9, 3.642531020132491*^9}, {3.6425311360136547`*^9, 
   3.642531166125697*^9}, {3.64253121132876*^9, 3.6425312242587786`*^9}, {
   3.642531293833877*^9, 3.642531297573882*^9}, {3.6425314082820387`*^9, 
   3.64253150795218*^9}, {3.6425315514062414`*^9, 3.6425315622862563`*^9}, {
   3.6425315928842998`*^9, 3.6425316444823723`*^9}, {3.642531691449439*^9, 
   3.6425317249694867`*^9}, {3.6425319206627626`*^9, 
   3.6425319318037777`*^9}, {3.642532056447954*^9, 3.6425320886969995`*^9}, {
   3.642532138244069*^9, 3.6425321476280828`*^9}, 3.642532244681219*^9, {
   3.6425323095393105`*^9, 3.6425323484653654`*^9}, {3.6425323843774157`*^9, 
   3.642532444282503*^9}, {3.642532501847584*^9, 3.6425325024575853`*^9}, {
   3.6425325615806684`*^9, 3.642532601869725*^9}, {3.642532707053873*^9, 
   3.6425327454539275`*^9}, {3.6425327819739795`*^9, 
   3.6425327821139793`*^9}, {3.642532815416026*^9, 3.6425328677931004`*^9}, {
   3.6425329233521786`*^9, 3.642532926542183*^9}, {3.642533062098374*^9, 
   3.642533259736653*^9}, {3.642533571219092*^9, 3.642533595639126*^9}, {
   3.642533784734393*^9, 3.64253385364149*^9}, {3.6425339204625874`*^9, 
   3.642533928552599*^9}, {3.642533971415659*^9, 3.642533983913677*^9}, {
   3.642534058391782*^9, 3.642534134649889*^9}, 3.6425342296930227`*^9, {
   3.642534352895197*^9, 3.6425345223634353`*^9}, {3.642534700581686*^9, 
   3.6425347028516893`*^9}, {3.642534759857769*^9, 3.6425347601777697`*^9}, {
   3.6425348824019413`*^9, 3.6425348994869657`*^9}, {3.642535074718212*^9, 
   3.6425352725904903`*^9}, {3.6425353223105607`*^9, 
   3.6425353314005733`*^9}, {3.6425353699746275`*^9, 
   3.6425353984366674`*^9}, {3.64253546901377*^9, 3.642535556605893*^9}, {
   3.642535660427039*^9, 3.6425356605370398`*^9}, {3.642535706873105*^9, 
   3.6425357137931147`*^9}, {3.6425384922410283`*^9, 3.642538496281034*^9}, 
   3.6785566714495325`*^9, {3.6785587960190516`*^9, 3.6785588947867002`*^9}, {
   3.6785593039071007`*^9, 3.678559305379185*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"1c94271e-f3c7-4616-9a8e-db171f72cf9c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PairConnect3 (Connect a dot in frame(n) to the nearest dot in frame(n-1) \
which is less than the determined jumping distance > there is no conversion, \
but diversion) \
\>", "Subsection",
 CellChangeTimes->{{3.678559583698104*^9, 3.678559593562668*^9}, {
  3.6785687791460533`*^9, 3.6785688974738216`*^9}, {3.6785689412813272`*^9, 
  3.678568949921821*^9}},ExpressionUUID->"c5864982-ac8c-46e4-8600-\
292f2b6d096b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "used", " ", "with", " ", 
     "LinkTracks", " ", "or", " ", "LinkTracks2", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", "A", " ", "cordinate", " ", "of", " ", 
     "each", " ", "dots", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", " ", "is", " ", "compared", " ", "with", " ", "dots", " ", "at", " ",
      "frame", "#", " ", "N", " ", "by", " ", "Table", " ", "function", 
     "\[IndentingNewLine]", "\t", "Those", " ", "dots", " ", "located"}], " ",
     "+", 
    RowBox[{
     RowBox[{"/", 
      RowBox[{"-", " ", "\"\<dist_\>\""}]}], " ", "are", " ", "listed", " ", 
     "as", " ", "\"\<potentialDots\>\"", "\[IndentingNewLine]", "\t", "If", 
     " ", "the", " ", "nearest", " ", "dots", " ", "in", " ", 
     "\"\<potentialDots\>\"", " ", "is", " ", "actually", " ", "less", " ", 
     "than", " ", "\"\<dist_\>\"", "\[IndentingNewLine]", "\t", "the", " ", 
     "track", " ", "number", " ", "of", " ", "the", " ", "dot", " ", "is", 
     " ", "given", " ", "to", " ", "the", " ", "current", " ", "dot", " ", 
     "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", "\[IndentingNewLine]", "\t", "This", " ", "will", " ", "ensure", " ",
      "there", " ", "is", " ", "no", " ", "conversion", " ", "in", " ", 
     "tracks", "\[IndentingNewLine]", "\t", "If", " ", "there", " ", "is", 
     " ", "no", " ", "dots", " ", "closeby", " ", "in", " ", "frame", " ", 
     "#N"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "current", " ", "dot", " ", "gets", " ", "the", " ", "new", 
     " ", "track", " ", "number", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
     "list1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ":", 
    " ", 
    RowBox[{"the", " ", "latest", " ", 
     RowBox[{"(", "biggest", ")"}], " ", "track", " ", "number", " ", "being",
      " ", "used", " ", 
     RowBox[{"(", "newticker", ")"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
     "list1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ":", 
    " ", 
    RowBox[{
    "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", "points",
      " ", "with", " ", "a", " ", "track", " ", "number", " ", "at", " ", 
     "frame", "#", " ", "N", " ", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"list2", ":", "    ", 
      RowBox[{
       RowBox[{
       "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", 
        "points", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
       RowBox[{
       "1", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t ", "out"}]}], 
      ":", "      ", 
      RowBox[{
       RowBox[{
       "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", 
        "points", " ", "with", " ", "a", " ", "track", " ", "number", " ", 
        "at", " ", "frame", "#", " ", "N"}], "+", "1"}]}]}]}]}], 
  "\[IndentingNewLine]", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6786311463602543`*^9, 3.6786316118118763`*^9}, {
  3.6786336143174133`*^9, 3.6786336993652773`*^9}, {3.6786337329091964`*^9, 
  3.6786338276456146`*^9}, {3.6786442408382154`*^9, 3.67864462992647*^9}, {
  3.678644735598514*^9, 3.678644831406994*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"69c93b80-9ad2-4cd5-828e-4c305da2a48e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "list1", ",", "list2", ",", "out", ",", "mypos"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mypos", "=", 
          RowBox[{
          "list2", "\[LeftDoubleBracket]", "myi", "\[RightDoubleBracket]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"potentialDots", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}]}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"potentialDots", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newticker", "+=", "1"}], ";", 
            RowBox[{"out", "=", 
             RowBox[{"{", 
              RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"potentialDot", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"potentialDots", ",", 
                 RowBox[{"x_", "/;", 
                  RowBox[{
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"potentialDots", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
                     "mypos"}], "]"}]}]}]}]}], "]"}], ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"mypos", ",", 
                 RowBox[{
                 "potentialDot", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ">", "dist"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"newticker", "+=", "1"}], ";", 
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "potentialDot", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "mypos"}], "}"}]}], 
               ";"}]}], "]"}]}]}], "]"}], ";", "out"}], ",", 
        RowBox[{"{", 
         RowBox[{"myi", ",", "1", ",", 
          RowBox[{"Length", "@", "list2"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newticker", ",", "out"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678559612091728*^9, 3.678559616794997*^9}, {
   3.6785597764591293`*^9, 3.678559889284582*^9}, {3.6785600026430664`*^9, 
   3.6785600028040757`*^9}, {3.6785645606417685`*^9, 3.6785646495908566`*^9}, 
   3.6785661846406565`*^9, 3.6785662164474754`*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"dd76e305-9bfd-41d7-aa04-90b0b0766153"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairConnect4 (PairConnect3 + removing diversion)", "Subsection",
 CellChangeTimes->{{3.678559583698104*^9, 3.678559593562668*^9}, {
  3.67856877593787*^9, 3.678568776041876*^9}, {3.678568958833331*^9, 
  3.6785689735461726`*^9}},ExpressionUUID->"6f3a9e22-1b0e-4cb3-8696-\
14fcc8a658ce"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "used", " ", "with", " ", 
     "LinkTracks", " ", "or", " ", "LinkTracks2", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", "After", " ", "connecting", " ", "all", " ",
      "dots", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", " ", "to", " ", "dots", " ", "at", " ", "frame", "#", " ", "N", 
     "\[IndentingNewLine]", "\t", "finding", " ", "redundant", " ", "track", 
     " ", "numbers", " ", "by", " ", "using", " ", "RedundantTrack", " ", 
     "function", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"RedundantTrack", "[", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "5", ",", "1", ",", "6", ",", "7", ",", "2", ",", 
        "2", ",", "5"}], "}"}], "]"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "4", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "7", "}"}], ",", 
           RowBox[{"{", "8", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"{", "9", "}"}]}], "}"}]}], "}"}]}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "redundant", " ", 
     "track", " ", "numbers", " ", "means", " ", "track", " ", "gets", " ", 
     "split", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", "\[IndentingNewLine]", "\t", "in", " ", "order", " ", "to", " ", 
     "avoid", " ", "this"}]}], ",", " ", 
   RowBox[{
   "choosing", " ", "the", " ", "nearest", " ", "point", " ", "and", " ", 
    "assign", " ", "a", " ", "new", " ", "track", " ", "number", " ", "to", 
    " ", "the", " ", "other", " ", "points"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.678644657461045*^9, 3.6786447316622887`*^9}, {
  3.678644841734585*^9, 3.678644919664042*^9}, {3.678644955945117*^9, 
  3.678645062191194*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"247742ff-d160-46e7-914f-90aeea0a72df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RedundantTrack", "[", 
   RowBox[{"list_", ",", 
    RowBox[{"test_", ":", " ", "Identity"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Composition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"list", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], "&"}],
      ",", 
     RowBox[{
      RowBox[{"GatherBy", "[", 
       RowBox[{"#", ",", "test"}], "]"}], "&"}]}], "]"}], "[", "list", 
   "]"}]}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"7713582a-fd17-4e38-adbd-467b7f14e503"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect4", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "list1", ",", "list2", ",", "out", ",", "mypos", ",", 
      "myRedundant", ",", "null", ",", "tempOriginalPoint", ",", 
      "tempNewPoints", ",", "tempTruePoint", ",", "tempOutlierPointPosi"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mypos", "=", 
          RowBox[{
          "list2", "\[LeftDoubleBracket]", "myi", "\[RightDoubleBracket]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"potentialDots", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}]}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"potentialDots", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newticker", "+=", "1"}], ";", 
            RowBox[{"out", "=", 
             RowBox[{"{", 
              RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"potentialDot", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"potentialDots", ",", 
                 RowBox[{"x_", "/;", 
                  RowBox[{
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"potentialDots", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
                     "mypos"}], "]"}]}]}]}]}], "]"}], ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"mypos", ",", 
                 RowBox[{
                 "potentialDot", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ">", "dist"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"newticker", "+=", "1"}], ";", 
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "potentialDot", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "mypos"}], "}"}]}], 
               ";"}]}], "]"}]}]}], "]"}], ";", "out"}], ",", 
        RowBox[{"{", 
         RowBox[{"myi", ",", "1", ",", 
          RowBox[{"Length", "@", "list2"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"myRedundant", "=", 
      RowBox[{"RedundantTrack", "[", 
       RowBox[{"out", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"null", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempOriginalPoint", "=", 
          RowBox[{"Extract", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"list1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "myj"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempNewPoints", "=", 
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "myj"}], "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempTruePoint", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"tempNewPoints", ",", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{"tempNewPoints", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"tempOriginalPoint", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
               "]"}]}]}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempOutlierPointPosi", "=", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "myj"}], "\[RightDoubleBracket]"}], ",", 
             "tempTruePoint"}], "]"}], "//", "Flatten"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"newticker", "+", "1"}], ",", 
           RowBox[{"newticker", "+", 
            RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{"tempOutlierPointPosi", ",", "1"}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"newticker", "+", "1"}], ",", 
            RowBox[{"newticker", "+", 
             RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"newticker", "=", 
          RowBox[{"newticker", "+", 
           RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"myj", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myRedundant", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newticker", ",", "out"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678559612091728*^9, 3.678559616794997*^9}, {
   3.6785597764591293`*^9, 3.678559889284582*^9}, {3.6785600026430664`*^9, 
   3.6785600028040757`*^9}, {3.6785645606417685`*^9, 3.6785646495908566`*^9}, 
   3.6785661846406565`*^9, 3.6785662164474754`*^9, {3.6785691452029905`*^9, 
   3.6785691752347083`*^9}, {3.6786294864193106`*^9, 
   3.6786294970029163`*^9}, {3.6786295295627785`*^9, 
   3.6786295693700557`*^9}, {3.6786296000998135`*^9, 3.678629674828087*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"01dd3399-191b-4eec-8a55-f09624257870"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinkTracks", "Subsection",
 CellChangeTimes->{{3.6425406972561293`*^9, 3.642540699196132*^9}, {
  3.6425407307771764`*^9, 3.642540734629182*^9}, {3.6483824467792892`*^9, 
  3.648382447886891*^9}},ExpressionUUID->"33132d20-7bb9-475c-a772-\
65342213d35d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkTracks", "[", 
   RowBox[{"testgreenP_", ",", "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list1", ",", "list2", ",", "listResult", ",", "listResultFrame", ",", 
      "listResultTrack"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list1", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{
           "testgreenP", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{
          "testgreenP", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "@", "list1"}], ",", "list1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"testgreenP", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listResult", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PairConnect4", "[", 
          RowBox[{"#1", ",", "#2", ",", "dist"}], "]"}], "&"}], ",", "list1", 
        ",", "list2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultFrame", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
          "listResult", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "i", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "j", ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"listResult", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
              "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "listResult"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrack", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"listResultFrame", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], ",", 
        "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"listResultFrame", ",", "listResultTrack"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.642537218408235*^9, 3.642537264040299*^9}, {
   3.642537296025344*^9, 3.6425373967124853`*^9}, {3.6425375490676994`*^9, 
   3.6425375491776996`*^9}, {3.6428863768161287`*^9, 
   3.6428863815353985`*^9}, {3.642886462952055*^9, 3.642886463968113*^9}, {
   3.642939120294883*^9, 3.642939135121731*^9}, {3.64293926676126*^9, 
   3.6429392677223153`*^9}, {3.6429393414655333`*^9, 
   3.6429393421455717`*^9}, {3.6430564615444183`*^9, 
   3.6430564648156056`*^9}, {3.678556682570169*^9, 3.678556741576544*^9}, {
   3.6785567816588364`*^9, 3.6785567968567057`*^9}, {3.6785568671847286`*^9, 
   3.6785568723050213`*^9}, 3.678556966680419*^9, {3.6785646596314306`*^9, 
   3.6785646597424374`*^9}, {3.678564878566953*^9, 3.6785648786709595`*^9}, {
   3.6785659857122784`*^9, 3.678565985832285*^9}, {3.6785672838895297`*^9, 
   3.678567283976535*^9}, {3.678567339273698*^9, 3.678567339384704*^9}, {
   3.6786298277868357`*^9, 3.6786298278828416`*^9}, {3.6786455094707775`*^9, 
   3.6786455421916485`*^9}, {3.6786456047912292`*^9, 3.678645677591393*^9}, {
   3.6786458595918026`*^9, 3.6786458778638477`*^9}, {3.6786459520160894`*^9, 
   3.67864598315987*^9}, {3.6786460706318736`*^9, 3.6786460973284006`*^9}, {
   3.67864615028743*^9, 3.6786461816002207`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d098258e-7b58-42a2-820d-5a03bf40a995"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinkTracks2", "Subsection",
 CellChangeTimes->{{3.6786311154964886`*^9, 
  3.678631122754904*^9}},ExpressionUUID->"a04c3b61-38a1-43d4-ba5c-\
66e90f98cba1"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "get", " ", "rid", " ", "of", " ", "tracks", " ", "which", " ", "last", 
    " ", "only", " ", "1", " ", "or", " ", "2", " ", "frame", 
    RowBox[{"(", "s", ")"}], " ", "and", " ", "re"}], "-", 
   RowBox[{"assign", " ", "consecutive", " ", "track", " ", "numbers"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6786451804919605`*^9, 3.6786452852309513`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"47ce27b1-92b2-401c-b425-9f7d6d9ae3ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkTracks2", "[", 
   RowBox[{"testgreenP_", ",", "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list1", ",", "list2", ",", "listResult", ",", "listResultFrame", ",", 
      "listResultTrack", ",", "listResultTrackL"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list1", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{
           "testgreenP", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{
          "testgreenP", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "@", "list1"}], ",", "list1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"testgreenP", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listResult", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PairConnect4", "[", 
          RowBox[{"#1", ",", "#2", ",", "dist"}], "]"}], "&"}], ",", "list1", 
        ",", "list2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultFrame", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
          "listResult", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "i", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "j", ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"listResult", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
              "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "listResult"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrack", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"listResultFrame", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], ",", 
        "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrackL", "=", 
      RowBox[{"Extract", "[", 
       RowBox[{"listResultTrack", ",", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Length", "/@", "listResultTrack"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "2"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listResultTrackL", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "listResultTrackL"}]}]}], ";", 
     "\[IndentingNewLine]", "listResultTrackL"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.678645143510845*^9, {3.6786462319861026`*^9, 3.6786462430877376`*^9}, {
   3.678646706939268*^9, 3.678646782449587*^9}, {3.67864688984873*^9, 
   3.678646931857133*^9}, 3.6786469851691823`*^9, {3.6786471294484344`*^9, 
   3.6786471353687735`*^9}, {3.678648850050847*^9, 3.6786488527139997`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"a0cc7a7c-820a-4bcb-97d5-f961f7be3d92"]
}, Closed]],

Cell[CellGroupData[{

Cell["Relinking", "Subsection",
 CellChangeTimes->{{3.6429485555685496`*^9, 
  3.642948561607895*^9}},ExpressionUUID->"b0a47a3e-b06a-47d9-bf2e-\
eb836351f867"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Only", " ", "the", " ", "longest", " ", "path", " ", "will", " ", "be", 
   " ", "taken", " ", "for", " ", "the", " ", "last", " ", "frame", " ", "if",
    " ", "the", " ", "track", " ", "split", " ", "in", " ", "the", " ", 
   "middle"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6430559206934834`*^9, 3.6430559317251143`*^9}, {
  3.6431167430053205`*^9, 3.6431168098051414`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"43cd7335-6459-4bfa-bdf5-37bf73abb8e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Relinking", "[", 
   RowBox[{
   "sortedbyframe_", ",", "sortedbytrack_", ",", "gap_", ",", "distance_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ftrackList", ",", "ltrackList", ",", "linkinglist", ",", "mytrack", ",",
       "mytrackN", ",", "myt", ",", "mypos", ",", "newrange", ",", "flag", 
      ",", "targetFrame", ",", "targetTracks", ",", "candidateTracks", ",", 
      "closestTrack", ",", "out", ",", "newlinkinglist", ",", 
      "newsortedbytrack", ",", "oldtrackN", ",", "newtrackN", ",", 
      "newsortedbyframe", ",", "oldtrackPos"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "extracting", " ", "the", " ", "begining", " ", "and", " ", "the", " ", 
      "ending", " ", "of", " ", "all", " ", "tracks"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ftrackList", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"First", "/@", 
          RowBox[{
          "sortedbytrack", "\[LeftDoubleBracket]", "All", 
           "\[RightDoubleBracket]"}]}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ftrackList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"ftrackList", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[LessEqual]",
           "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ltrackList", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{
         "sortedbytrack", "\[LeftDoubleBracket]", "All", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "relinking", " ", "tracks", " ", "and", " ", "making", " ", "a", " ", 
       "list"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"linkinglist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mytrack", "=", 
         RowBox[{
         "ftrackList", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mytrackN", "=", 
         RowBox[{
         "mytrack", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myt", "=", 
         RowBox[{"mytrack", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypos", "=", 
         RowBox[{"mytrack", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newrange", "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"myt", "-", "gap", "-", "1"}], ",", 
            RowBox[{"myt", "-", "2"}], ",", "1"}], "]"}], "//", "Reverse"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"targetFrame", "=", 
            RowBox[{
            "newrange", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"flag", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"targetTracks", "=", 
               RowBox[{"Extract", "[", 
                RowBox[{"ltrackList", ",", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "targetFrame"}], "]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"candidateTracks", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"targetTracks", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], 
                    ",", "mypos"}], "]"}], "<", "distance"}], "&"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "candidateTracks", "]"}], ">", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "candidateTracks", "]"}], 
                   "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"out", "=", 
                    RowBox[{"{", 
                    RowBox[{"mytrackN", ",", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", 
                   RowBox[{
                    RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"mytrackN", ",", "1"}], "\[RightDoubleBracket]"}],
                     "=", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{"flag", "=", "1"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"closestTrack", "=", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"candidateTracks", ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"#", ",", "mypos"}], "]"}], "&"}], "/@", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}]}],
                     ",", 
                    RowBox[{"Min", "[", "x", "]"}]}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"out", "=", 
                    RowBox[{"{", 
                    RowBox[{"mytrackN", ",", 
                    RowBox[{"closestTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", 
                   RowBox[{
                    RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"mytrackN", ",", "1"}], "\[RightDoubleBracket]"}],
                     "=", 
                    RowBox[{"closestTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{"flag", "=", "1"}], ";"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"out", "=", 
                  RowBox[{"{", "}"}]}], ";", 
                 RowBox[{"flag", "=", "0"}]}]}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "newrange", "]"}], ",", "1"}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"linkinglist", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"linkinglist", ",", "out"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ftrackList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "convert", " ", "old", " ", "track", " ", "numbers", " ", "to", " ", 
       "new", " ", "track", " ", "numbers", " ", "in", " ", 
       "\"\<sortedbytrack\>\"", " ", "and", " ", "\"\<sortedbyframe\>\""}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newlinkinglist", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"linkinglist", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newsortedbytrack", "=", "sortedbytrack"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newsortedbyframe", "=", "sortedbyframe"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"oldtrackN", "=", 
         RowBox[{"newlinkinglist", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newtrackN", "=", 
         RowBox[{"newlinkinglist", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newsortedbytrack", "\[LeftDoubleBracket]", 
          RowBox[{"oldtrackN", ",", "All", ",", "1"}], 
          "\[RightDoubleBracket]"}], "=", "newtrackN"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldtrackPos", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"newsortedbyframe", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2", ",", "All", ",", "1"}], 
                "\[RightDoubleBracket]"}], ",", "oldtrackN"}], "]"}], "//", 
             "Flatten"}], "//", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "4"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newsortedbyframe", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"newsortedbyframe", ",", 
           RowBox[{"oldtrackPos", " ", "\[Rule]", " ", "newtrackN"}]}], 
          "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "newlinkinglist", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newsortedbytrack", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"newsortedbytrack", "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "newsortedbyframe", ",", "newsortedbytrack", ",", "newlinkinglist"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.643045022540145*^9, 3.643045216993267*^9}, {
   3.6430452488580894`*^9, 3.643045276385664*^9}, {3.6430453376271667`*^9, 
   3.6430453986246557`*^9}, {3.6430569720696187`*^9, 
   3.6430570220844793`*^9}, {3.64305706195576*^9, 3.6430571061472874`*^9}, {
   3.6430573628279686`*^9, 3.6430573771327868`*^9}, {3.643057427907691*^9, 
   3.6430574393803473`*^9}, {3.6431331820155783`*^9, 
   3.6431332581189313`*^9}, {3.643136544192884*^9, 3.643136634932074*^9}, 
   3.6431370498418055`*^9, {3.643137451493778*^9, 3.6431374541959333`*^9}, {
   3.643137698250892*^9, 3.6431377016580873`*^9}, {3.643138000046154*^9, 
   3.6431380084446344`*^9}, {3.643138079340689*^9, 3.6431380961476507`*^9}, {
   3.6431381850367346`*^9, 3.643138198147485*^9}, {3.643139144227597*^9, 
   3.6431393006865463`*^9}, {3.6431398221283712`*^9, 
   3.6431398241664877`*^9}, {3.6431407049758673`*^9, 
   3.6431407055348988`*^9}, {3.643471534892849*^9, 3.643471536684952*^9}, {
   3.643471617238559*^9, 3.6434716488853693`*^9}, {3.6434717183183403`*^9, 
   3.6434717592526817`*^9}, 3.649472570771883*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"2a5aa042-bd26-4e87-86e6-50bc71c66ce6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sortedbyframe", ",", "sortedbytrack"}], "}"}], "=", 
    RowBox[{"LinkTracks", "[", 
     RowBox[{"testgreenP", ",", "1"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.643140617018836*^9, 3.6431406198890004`*^9}, {
  3.648304096465707*^9, 3.6483040988408427`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"de5bb7f5-9065-449e-9475-33833d5d59a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["ParticleFitting", "Subsection",
 CellChangeTimes->{{3.6515211610224323`*^9, 
  3.651521163990602*^9}},ExpressionUUID->"15f87806-614d-4021-acd6-\
582d93442541"],

Cell["\<\
When raw images are used for fitting, avgFrameN_ is used to shift frames such \
that the middle frame of running average is used for fitting.
For example when avgFrameN is 3, the centroid at the first time point in \
mylongtrack is determined from the average image of frame 1, 2 and 3. So \
frame 2 should be fitted with this initial guess.
When running averaged images are used for fitting, enter \
\[OpenCurlyDoubleQuote]1\[CloseCurlyDoubleQuote] at the last input instead of \
avgFrameN.\
\>", "Text",
 CellChangeTimes->{{3.6557286003930864`*^9, 
  3.655728889600628*^9}},ExpressionUUID->"319606ea-c52a-4438-b654-\
e1ea17f3e3d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingSee", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtrack_", ",", "pad_", ",", 
    "myTrimSize_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tempTime", ",", "tempCenter", ",", "frameShift"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tempTime", "=", 
        RowBox[{"mylongtrack", "\[LeftDoubleBracket]", 
         RowBox[{"t", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempCenter", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"mylongtrack", "\[LeftDoubleBracket]", 
          RowBox[{"t", ",", "2", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"frameShift", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ImageTrim", "[", 
        RowBox[{
         RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
          RowBox[{"channel", ",", 
           RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tempCenter", "-", "pad"}], ",", 
           RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], "]"}]}],
       "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"Length", "[", "mylongtrack", "]"}], ",", "1"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
  3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
  3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
  3.655581282500985*^9, 3.6555813891080823`*^9}, {3.6555814330835977`*^9, 
  3.65558148994785*^9}, {3.655581570579462*^9, 3.655581605779475*^9}, {
  3.655581714731707*^9, 3.6555817416352463`*^9}, {3.6556456138785295`*^9, 
  3.6556456600301685`*^9}, {3.655645691237954*^9, 3.6556457099260225`*^9}, {
  3.655646442718936*^9, 3.6556464690944448`*^9}, {3.6556603618410645`*^9, 
  3.655660361961071*^9}, {3.6557217222026763`*^9, 3.6557218284757547`*^9}, {
  3.6557218930834503`*^9, 3.6557219581311707`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"c681f31f-8d94-4c56-b0ad-92de4ae4b1cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFitting", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBGSigma", ",", 
      "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", 
      "myIntBGSigma90Conf", ",", "myFitData", ",", "CC", ",", "A", ",", "x0", 
      ",", "a", ",", "y0", ",", "b", ",", "x", ",", "y"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2", ",", "5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4", ",", "6"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", 
                 "myIntBGSigma", ",", "myAbsPos90Conf", ",", 
                 "myIntBGSigma90Conf", ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}]}], ",", "myPos", ",",
             "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"3693eb9a-0daa-4d83-9939-aa4f7b076299"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "input", " ", "does", " ", "not", " ", "have", " ", "color", " ", "code", 
    " ", "such", " ", "as", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], " ", "for", " ", "red"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ParticleFitting2", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
     "avgFrameN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempTime", ",", "tempCenter", ",", "frameShift", 
       ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
       "myFit", ",", "myPos", ",", "myPosImgCoordn", ",", "myAbsPos", ",", 
       "myIntBGSigma", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
       "myAbsPos90Conf", ",", "myIntBGSigma90Conf", ",", "myFitData", ",", 
       "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", 
       ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2", ",", "5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4", ",", "6"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", 
                 "myIntBGSigma", ",", "myAbsPos90Conf", ",", 
                 "myIntBGSigma90Conf"}], "}"}]}]}]}], ",", "myPos", ",", 
            "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"myAllParametersEach", "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
        "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"72483956-951e-413f-b741-07e2f6fe263d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"input", " ", "not", " ", "tracked"}], ",", " ", 
    RowBox[{
     RowBox[{
     "contains", " ", "multiple", " ", "information", " ", "from", " ", 
      "component", " ", 
      RowBox[{"measurments", ".", " ", "intensity"}], " ", "centroid", " ", 
      "is", " ", "the", " ", "first", " ", "component", "\[IndentingNewLine]",
       "   ", "fitted", " ", "result", " ", "is", " ", "appended", " ", 
      "after", " ", "the", " ", "component", " ", "measurments", " ", 
      "\[IndentingNewLine]", "    ", "output", " ", "list", " ", "has", " ", 
      "3", " ", "components", "\[IndentingNewLine]", "    ", "1.", " ", 
      "component", " ", "measurements"}], " ", "+", " ", 
     RowBox[{
     "fit", " ", "results", "\[IndentingNewLine]", "    ", "2.", " ", "fit", 
      " ", "centroid", " ", "in", " ", "the", " ", "cropped", " ", "data", 
      "\[IndentingNewLine]", "    ", "3.", " ", "cropped", " ", "data"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyParticleFitter", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mySpots_", ",", "pad_", ",", 
     "avgFrameN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempTime", ",", "tempCenter", ",", "frameShift", 
       ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
       "myFit", ",", "myPos", ",", "myPosImgCoordn", ",", "myAbsPos", ",", 
       "myIntBG", ",", "mySigma", ",", "myPos90Conf", ",", 
       "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", "myIntBG90Conf", 
       ",", "mySigma90Conf", ",", "myParametersAll", ",", "my90ConfAll", ",", 
       "myFitData", ",", "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", 
       "b", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"frameShift", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                 RowBox[{"frame", ",", "spot", ",", "2"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "spot", ",", "3", ",", "1"}], 
                  "\[RightDoubleBracket]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"spot", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mySpots", "\[LeftDoubleBracket]", "frame", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myParametersAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"myAbsPos", ",", "myIntBG", ",", "mySigma"}], "}"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"my90ConfAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{
             "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "mySigma90Conf"}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myAllParametersEach", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "mySpots", "\[LeftDoubleBracket]", "frame", 
                 "\[RightDoubleBracket]"}], ",", "myParametersAll", ",", 
                "my90ConfAll"}], "}"}]}], ",", "myPos", ",", "myData"}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myAllParametersEach", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              "]"}], "&"}], "/@", 
            RowBox[{
            "myAllParametersEach", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myAllParametersEach"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "mySpots"}], ",", "1"}], "}"}]}], "]"}], "//",
        "Transpose"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9, {3.716218610152887*^9, 
   3.7162186290729694`*^9}, {3.7162188409140854`*^9, 
   3.7162188503136234`*^9}, {3.716226078608058*^9, 3.7162261469599676`*^9}, {
   3.7162262473677106`*^9, 3.7162263090952415`*^9}, {3.716226339167961*^9, 
   3.716226369095673*^9}, {3.716230669451639*^9, 3.716230700595421*^9}, {
   3.7162308037553215`*^9, 3.7162308187311773`*^9}, {3.7162308814597654`*^9, 
   3.7162309845396614`*^9}, {3.7162310295472355`*^9, 3.71623108085117*^9}, {
   3.7162311195873857`*^9, 3.7162311493070855`*^9}, {3.716231257540276*^9, 
   3.716231299355668*^9}, {3.7162313301954317`*^9, 3.716231346324354*^9}, {
   3.716231384443535*^9, 3.7162314202995853`*^9}, {3.71623151356392*^9, 
   3.7162315421245537`*^9}, {3.7162392090030737`*^9, 
   3.7162392113062057`*^9}, {3.7162393595866866`*^9, 3.716239360106716*^9}, 
   3.7162394725941505`*^9, {3.7162408270356197`*^9, 3.716240911547454*^9}, {
   3.717510224470724*^9, 3.7175102282229395`*^9}, {3.7175103518710117`*^9, 
   3.717510486663721*^9}, {3.7175212119451723`*^9, 3.71752121784851*^9}, {
   3.718634324209139*^9, 3.718634335056759*^9}, {3.770146847353879*^9, 
   3.7701468551673255`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"1f872559-45a6-46f9-9164-a3f54a4433e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"input", " ", "not", " ", "tracked"}], ",", " ", 
    RowBox[{
     RowBox[{
     "contains", " ", "multiple", " ", "information", " ", "from", " ", 
      "component", " ", 
      RowBox[{"measurments", ".", " ", "intensity"}], " ", "centroid", " ", 
      "is", " ", "the", " ", "first", " ", "component", "\[IndentingNewLine]",
       "   ", "fitted", " ", "result", " ", "is", " ", "appended", " ", 
      "after", " ", "the", " ", "component", " ", "measurments", " ", 
      "\[IndentingNewLine]", "    ", "output", " ", "list", " ", "has", " ", 
      "3", " ", "components", "\[IndentingNewLine]", "    ", "1.", " ", 
      "component", " ", "measurements"}], " ", "+", " ", 
     RowBox[{
     "fit", " ", "results", "\[IndentingNewLine]", "    ", "2.", " ", "fit", 
      " ", "centroid", " ", "in", " ", "the", " ", "cropped", " ", "data", 
      "\[IndentingNewLine]", "    ", "3.", " ", "cropped", " ", "data"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyParticleFitterFixedSigma", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mySpots_", ",", "pad_", ",", 
     "avgFrameN_", ",", "sigma_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempTime", ",", "tempCenter", ",", "frameShift", 
       ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
       "myFit", ",", "myPos", ",", "myPosImgCoordn", ",", "myAbsPos", ",", 
       "myIntBG", ",", "mySigma", ",", "myPos90Conf", ",", 
       "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", "myIntBG90Conf", 
       ",", "mySigma90Conf", ",", "myParametersAll", ",", "my90ConfAll", ",", 
       "myFitData", ",", "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", 
       "b", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"frameShift", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                 RowBox[{"frame", ",", "spot", ",", "2"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "spot", ",", "3", ",", "1"}], 
                  "\[RightDoubleBracket]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"spot", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mySpots", "\[LeftDoubleBracket]", "frame", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "y0", ",", "x", ",", "y"}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myParametersAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"myAbsPos", ",", "myIntBG"}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"my90ConfAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"myAbsPos90Conf", ",", "myIntBG90Conf"}], "}"}]}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myAllParametersEach", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "mySpots", "\[LeftDoubleBracket]", "frame", 
                 "\[RightDoubleBracket]"}], ",", "myParametersAll", ",", 
                "my90ConfAll"}], "}"}]}], ",", "myPos", ",", "myData"}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myAllParametersEach", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              "]"}], "&"}], "/@", 
            RowBox[{
            "myAllParametersEach", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myAllParametersEach"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "mySpots"}], ",", "1"}], "}"}]}], "]"}], "//",
        "Transpose"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9, {3.716218610152887*^9, 
   3.7162186290729694`*^9}, {3.7162188409140854`*^9, 
   3.7162188503136234`*^9}, {3.716226078608058*^9, 3.7162261469599676`*^9}, {
   3.7162262473677106`*^9, 3.7162263090952415`*^9}, {3.716226339167961*^9, 
   3.716226369095673*^9}, {3.716230669451639*^9, 3.716230700595421*^9}, {
   3.7162308037553215`*^9, 3.7162308187311773`*^9}, {3.7162308814597654`*^9, 
   3.7162309845396614`*^9}, {3.7162310295472355`*^9, 3.71623108085117*^9}, {
   3.7162311195873857`*^9, 3.7162311493070855`*^9}, {3.716231257540276*^9, 
   3.716231299355668*^9}, {3.7162313301954317`*^9, 3.716231346324354*^9}, {
   3.716231384443535*^9, 3.7162314202995853`*^9}, {3.71623151356392*^9, 
   3.7162315421245537`*^9}, {3.7162392090030737`*^9, 
   3.7162392113062057`*^9}, {3.7162393595866866`*^9, 3.716239360106716*^9}, 
   3.7162394725941505`*^9, {3.7162408270356197`*^9, 3.716240911547454*^9}, {
   3.717510224470724*^9, 3.7175102282229395`*^9}, {3.7175103518710117`*^9, 
   3.717510486663721*^9}, {3.7175212119451723`*^9, 3.71752121784851*^9}, {
   3.718634324209139*^9, 3.718634335056759*^9}, {3.7701464364363756`*^9, 
   3.770146438363486*^9}, {3.7701464796988497`*^9, 3.7701466400560217`*^9}, {
   3.7701468590595484`*^9, 3.7701468969307146`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"5f422c0f-5fa6-4849-8224-d1c943889982"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"input", " ", "not", " ", "tracked"}], ",", " ", 
    RowBox[{
     RowBox[{
     "contains", " ", "multiple", " ", "information", " ", "from", " ", 
      "component", " ", 
      RowBox[{"measurments", ".", " ", "intensity"}], " ", "centroid", " ", 
      "is", " ", "the", " ", "first", " ", "component", "\[IndentingNewLine]",
       "   ", "fitted", " ", "result", " ", "is", " ", "appended", " ", 
      "after", " ", "the", " ", "component", " ", "measurments", " ", 
      "\[IndentingNewLine]", "    ", "output", " ", "list", " ", "has", " ", 
      "3", " ", "components", "\[IndentingNewLine]", "    ", "1.", " ", 
      "component", " ", "measurements"}], " ", "+", " ", 
     RowBox[{
     "fit", " ", "results", "\[IndentingNewLine]", "    ", "2.", " ", "fit", 
      " ", "centroid", " ", "in", " ", "the", " ", "cropped", " ", "data", 
      "\[IndentingNewLine]", "    ", "3.", " ", "cropped", " ", "data"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ParticleFitting3", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mySpots_", ",", "pad_", ",", 
     "avgFrameN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
       "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos",
        ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
       "mySigma", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
       "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "mySigma90Conf", ",", 
       "myParametersAll", ",", "my90ConfAll", ",", "myFitData", ",", "CC", 
       ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", ",", 
       "y"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "spot", ",", "2"}], 
                  "\[RightDoubleBracket]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"frame", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"spot", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mySpots", "\[LeftDoubleBracket]", "frame", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myParametersAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"myAbsPos", ",", "myIntBG", ",", "mySigma"}], "}"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"my90ConfAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{
             "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "mySigma90Conf"}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myAllParametersEach", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "mySpots", "\[LeftDoubleBracket]", "frame", 
                 "\[RightDoubleBracket]"}], ",", "myParametersAll", ",", 
                "my90ConfAll"}], "}"}]}], ",", "myPos", ",", "myData"}], 
            "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "mySpots"}], ",", "1"}], "}"}]}], "]"}], "//",
        "Transpose"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9, {3.716218610152887*^9, 
   3.7162186290729694`*^9}, {3.7162188409140854`*^9, 
   3.7162188503136234`*^9}, {3.716226078608058*^9, 3.7162261469599676`*^9}, {
   3.7162262473677106`*^9, 3.7162263090952415`*^9}, {3.716226339167961*^9, 
   3.716226369095673*^9}, {3.716230669451639*^9, 3.716230700595421*^9}, {
   3.7162308037553215`*^9, 3.7162308187311773`*^9}, {3.7162308814597654`*^9, 
   3.7162309845396614`*^9}, {3.7162310295472355`*^9, 3.71623108085117*^9}, {
   3.7162311195873857`*^9, 3.7162311493070855`*^9}, {3.716231257540276*^9, 
   3.716231299355668*^9}, {3.7162313301954317`*^9, 3.716231346324354*^9}, {
   3.716231384443535*^9, 3.7162314202995853`*^9}, {3.71623151356392*^9, 
   3.7162315421245537`*^9}, {3.7162392090030737`*^9, 
   3.7162392113062057`*^9}, {3.7162393595866866`*^9, 3.716239360106716*^9}, 
   3.7162394725941505`*^9, {3.7162408270356197`*^9, 3.716240911547454*^9}, {
   3.717520921320549*^9, 3.7175209600797663`*^9}, {3.717521047439763*^9, 
   3.717521100032771*^9}, {3.7175212011425543`*^9, 3.7175212022166157`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"d7dd54bd-7981-4fbd-8df7-153174503026"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingFixedSigma", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "sigma_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
      "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", 
      "myIntBG90Conf", ",", "myFitData", ",", "CC", ",", "A", ",", "x0", ",", 
      "y0", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "y0", ",", "x", ",", "y"}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", "myIntBG", 
                 ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"sigma", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "2"}], 
                    "}"}]}], "]"}], ",", "myAbsPos90Conf", ",", 
                 "myIntBG90Conf", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "4"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}]}], ",", "myPos", ",",
             "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.6558217347800684`*^9, 
   3.655821738523283*^9}, {3.655821772268213*^9, 3.6558218199079375`*^9}, {
   3.6558220477879715`*^9, 3.655822098179854*^9}, {3.655822176491333*^9, 
   3.6558222037238903`*^9}, {3.6558251922148223`*^9, 
   3.6558251961030445`*^9}, {3.6558252647589717`*^9, 
   3.6558252785097585`*^9}, {3.655825327463558*^9, 3.65582555844777*^9}, {
   3.6558273393006287`*^9, 3.6558273978079753`*^9}, {3.655834316381695*^9, 
   3.655834318069792*^9}, {3.6558443721728535`*^9, 3.6558444445739946`*^9}, {
   3.655844977494476*^9, 3.6558449788855553`*^9}, {3.6558453738731475`*^9, 
   3.655845391423151*^9}, {3.663965324194535*^9, 3.663965335002153*^9}, 
   3.663965615067172*^9, {3.6838988788284435`*^9, 3.68389888575784*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"a383b246-d449-4ec3-94ba-de89c3d09f0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingFixedSigmaInclinedBG", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "sigma_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
      "myInclinedBG", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
      "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "myInclinedBG90conf", ",", 
      "myFitData", ",", "CC", ",", "BGa", ",", "BGb", ",", "A", ",", "x0", 
      ",", "y0", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "BGa", ",", "BGb", ",", "A", ",", "x0", ",", "y0", 
                ",", "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", " ", "+", " ", 
                  RowBox[{"BGa", " ", "x"}], " ", "+", " ", 
                  RowBox[{"BGb", " ", "y"}], "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"BGa", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"BGb", ",", "0.01"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myInclinedBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myInclinedBG90conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", "myIntBG", 
                 ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"sigma", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "2"}], 
                    "}"}]}], "]"}], ",", "myAbsPos90Conf", ",", 
                 "myIntBG90Conf", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "4"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}], ",", "myInclinedBG", ",", 
                 "myInclinedBG90conf"}], "}"}]}]}]}], ",", "myPos", ",", 
            "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.6558217347800684`*^9, 
   3.655821738523283*^9}, {3.655821772268213*^9, 3.6558218199079375`*^9}, {
   3.6558220477879715`*^9, 3.655822098179854*^9}, {3.655822176491333*^9, 
   3.6558222037238903`*^9}, {3.6558251922148223`*^9, 
   3.6558251961030445`*^9}, {3.6558252647589717`*^9, 
   3.6558252785097585`*^9}, {3.655825327463558*^9, 3.65582555844777*^9}, {
   3.6558273393006287`*^9, 3.6558273978079753`*^9}, {3.655834316381695*^9, 
   3.655834318069792*^9}, {3.6558443721728535`*^9, 3.6558444445739946`*^9}, {
   3.655844977494476*^9, 3.6558449788855553`*^9}, {3.6558453738731475`*^9, 
   3.655845391423151*^9}, {3.663965485538763*^9, 3.6639655359626474`*^9}, 
   3.6639656173703036`*^9, {3.6639657258505087`*^9, 3.663965767234875*^9}, {
   3.6639658125564675`*^9, 3.6639658154426327`*^9}, {3.6639660619637327`*^9, 
   3.6639661631625214`*^9}, {3.663966219218727*^9, 3.6639662361706967`*^9}, {
   3.6639663351493583`*^9, 3.663966338347541*^9}, 3.68389895482279*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"d5879ee8-af25-405a-8814-d3a1f8ebc8b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["BeadsFitting", "Subsection",
 CellChangeTimes->{{3.651523106216691*^9, 
  3.6515231119520187`*^9}},ExpressionUUID->"34cedc17-308c-40ac-8650-\
47ed111a55a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsFitting", "[", 
   RowBox[{"myRefBeadsImg_", ",", "myPosGuess_", ",", "pad_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myTrimSize", ",", "myTrimImgs", ",", "myOrigins", ",", "tempCenter", 
      ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
      "myFit", ",", "CC", ",", "A", ",", "x", ",", "x0", ",", "a", ",", "y", 
      ",", "y0", ",", "b", ",", "myPos", ",", "myPosImgCoordn", ",", 
      "myAbsPos"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myTrimSize", "=", 
      RowBox[{
       RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempCenter", "=", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
            "myPosGuess", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myImgs", "=", 
             RowBox[{"ImageTrim", "[", 
              RowBox[{"myRefBeadsImg", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"tempCenter", "-", "pad"}], ",", 
                 RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"myOrigins", "=", 
             RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "myPosGuess", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myData", "=", 
      RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myFits", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempData3D", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  ",", 
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  ",", "#1"}], "}"}], "&"}], ",", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", 
           ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"myFit", "=", 
          RowBox[{"NonlinearModelFit", "[", 
           RowBox[{"tempData3D", ",", 
            RowBox[{"CC", "+", 
             RowBox[{"A", " ", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"CC", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"A", ",", 
                RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                  ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x0", ",", 
                RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y0", ",", 
                RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myFit", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
            "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPos", "=", 
      RowBox[{"myFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPosImgCoordn", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"myPos", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", "0.5"}],
          ",", 
         RowBox[{"myTrimSize", "-", 
          RowBox[{"myPos", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
          "0.5"}]}], "}"}], "//", "Thread"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myAbsPos", "=", 
      RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6483906843449163`*^9, 3.6483906948281345`*^9}, {
  3.6483907313009987`*^9, 3.64839074897783*^9}, {3.648390922446535*^9, 
  3.648391064072584*^9}, {3.6483911220930867`*^9, 3.648391274564155*^9}, {
  3.6483913389338684`*^9, 3.648391349604287*^9}, {3.648391401635379*^9, 
  3.6483914032577815`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"e8cf5d6a-b2b9-472e-9118-ed11507fe3a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsSorting", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPosSort", ",", "distanceOriginal", ",", "idx", ",", 
      "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myRedAbsPosSort", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"myRedAbsPos", ",", "myGreenAbsPos"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceOriginal", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos", ",", "myRedAbsPosSort"}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"distanceOriginal", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"x", ">", "dist"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"#", ",", "idx"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "myRedAbsPosSort", ",", "myGreenAbsPos", ",", "distanceOriginal"}], 
        "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6483909446005745`*^9, 3.648390951901387*^9}, {
  3.6483915027763567`*^9, 3.648391714274162*^9}, {3.6515238560495787`*^9, 
  3.6515239184811497`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"5e8f1361-4999-4d40-a0e6-6778ca4541be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsTransform", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw", ",", 
      "myTfFuncError", ",", "myTfFunc", ",", "myRedCorrPos", ",", 
      "distanceCorrected"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{"BeadsSorting", "[", 
       RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "dist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myTfFuncError", ",", "myTfFunc"}], "}"}], "=", 
      RowBox[{"FindGeometricTransform", "[", 
       RowBox[{"myGreenAbsPos4Calc", ",", "myRedAbsPos4Calc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myRedCorrPos", "=", 
      RowBox[{"myTfFunc", "[", "myRedAbsPos4Calc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceCorrected", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos4Calc", ",", "myRedCorrPos"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "myTfFuncError", ",", "myTfFunc", ",", "distanceRaw", ",", 
       "distanceCorrected"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.648392120969268*^9, 3.648392151951922*^9}, {
  3.6483921960239997`*^9, 3.6483921962424*^9}, {3.6484004568741035`*^9, 
  3.648400590161727*^9}, {3.648400991802699*^9, 3.6484010666779823`*^9}, {
  3.651523934337057*^9, 3.6515240057701426`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"7367a715-e1ff-4a88-972e-ad77450b2018"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsCheck", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw", ",", 
      "myRedCorrPos", ",", "distanceCorrected"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{"BeadsSorting", "[", 
       RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "dist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myRedCorrPos", "=", 
      RowBox[{"myTfFunc", "[", "myRedAbsPos4Calc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceCorrected", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos4Calc", ",", "myRedCorrPos"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Insert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"distanceRaw", ",", "distanceCorrected"}], "}"}], "//", 
         "Transpose"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Distance Before Correction\>\"", ",", 
          "\"\<Distance After Correction\>\""}], "}"}], ",", "1"}], "]"}], "//",
       "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6484012753809195`*^9, 3.648401405682372*^9}, 
   3.6515236689298763`*^9, 3.6515237173296447`*^9, {3.651524011241455*^9, 
   3.6515240637694597`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"50d1b750-3666-4ffd-b5a6-72cf4b4f7031"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FindOverlapDistance[track1,track2,\[Tau]] (measures average distance between \
two tracks when they overlap in time for at least time \[Tau], otherwise \
outputs -1)\
\>", "Subsection",
 CellChangeTimes->{{3.6792547892990313`*^9, 3.6792548292263145`*^9}, {
  3.6792560996119766`*^9, 3.6792561534200544`*^9}, {3.679256196156499*^9, 
  3.679256207268134*^9}},ExpressionUUID->"c3acbe8f-e3d7-4674-ba17-\
5430b497508b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindOverlapDist", "[", 
   RowBox[{"track1_", ",", "track2_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2", ",", "ol", ",", "avgpos1", ",", "avgpos2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"makes", " ", "tracks", " ", "have", " ", 
       RowBox[{"form", ":", " ", "t1"}]}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"track", "#"}], ",", "time1", ",", "x1", ",", "y1"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"track", "#"}], ",", "time2", ",", "x2", ",", "y2"}], 
          "}"}], " ", "..."}]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t1", "=", 
      RowBox[{
       RowBox[{"track1", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{
            "track1", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], "&"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"t2", "=", 
      RowBox[{
       RowBox[{"track2", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{
            "track2", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "following", " ", "just", " ", "sorts", " ", "by", " ", 
        "time", " ", "rather", " ", "than", " ", "track", " ", "#", " ", 
        "and", " ", 
        RowBox[{"splits", ".", " ", "If"}], " ", "the", " ", "two", " ", 
        "tracks", " ", "have", " ", "overlapping", " ", "time"}], ",", " ", 
       RowBox[{
       "then", " ", "the", " ", "split", " ", "will", " ", "contain", " ", 
        "2", " ", 
        RowBox[{"elements", ".", " ", "Thus"}]}], ",", " ", 
       RowBox[{
       "DeleteCases", " ", "eliminates", " ", "all", " ", "parts", " ", "of", 
        " ", "the", " ", "track", " ", "that", " ", "do", " ", "not", " ", 
        RowBox[{"overlap", ".", " ", "Finally"}]}], ",", " ", 
       RowBox[{
       "the", " ", "Transpose", " ", "command", " ", "gives", " ", "back", 
        " ", "a", " ", "list", " ", "of", " ", "overlapping", " ", "segments",
         " ", "of", " ", 
        RowBox[{"tracks", ":", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"segment", " ", "from", " ", "t1"}], ",", " ", 
            RowBox[{"segment", " ", "from", " ", "t2"}]}], "}"}], " ", "so", 
          " ", "the", " ", "mean", " ", "can", " ", "be", " ", "computed", 
          " ", "for", " ", 
          RowBox[{"each", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"t1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"t2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ol", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t1", ",", "t2"}], "}"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], "//", 
        RowBox[{
         RowBox[{"SplitBy", "[", 
          RowBox[{"#", ",", "First"}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], "<", "2"}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ol", "]"}], ">", "\[Tau]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"avgpos1", ",", "avgpos2"}], "}"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Mean", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "[", "ol", "]"}], ")"}]}], ")"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"avgpos1", ",", "avgpos2"}], "]"}]}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6786456735071197`*^9, 3.67864569624042*^9}, {
   3.678649737790583*^9, 3.678649747421134*^9}, {3.678649849596978*^9, 
   3.6786498560923495`*^9}, 3.678649893780505*^9, {3.678651646039729*^9, 
   3.678651754831951*^9}, {3.6786518947939568`*^9, 3.678651906719639*^9}, {
   3.678654891133279*^9, 3.678655133120904*^9}, {3.678655265255536*^9, 
   3.678655271542347*^9}, {3.678655312398819*^9, 3.678655481487516*^9}, {
   3.6786590429146595`*^9, 3.678659058140286*^9}, 3.678659148324044*^9, {
   3.678659360531217*^9, 3.678659413025309*^9}, {3.6786594573761873`*^9, 
   3.6786595006038632`*^9}, {3.678661648900236*^9, 3.6786616602726564`*^9}, {
   3.6786617455580063`*^9, 3.678661846568184*^9}, {3.678908725814332*^9, 
   3.678908744530402*^9}, {3.6792561705500345`*^9, 3.679256182637726*^9}, {
   3.6950519040325556`*^9, 3.6950519333132305`*^9}, {3.695053212489395*^9, 
   3.6950532203608456`*^9}, {3.6950535043610897`*^9, 
   3.6950535108654613`*^9}, {3.695053543785344*^9, 3.695053560233285*^9}, {
   3.6950536245939665`*^9, 3.69505365595376*^9}, {3.695053690908759*^9, 
   3.6950536944499617`*^9}, {3.6950542281774893`*^9, 3.695054243346357*^9}, {
   3.6950542754901953`*^9, 3.695054390329764*^9}, {3.6950544941787033`*^9, 
   3.6950545192341366`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"59fcb5af-abf3-487e-80eb-7d2b5e42c4e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ColorLinker[gbtrackpairs, greentracklist, blueflag] \[Rule] bluetracklist \
connected to greentracklist\
\>", "Subsection",
 CellChangeTimes->{{3.6806246269012165`*^9, 3.680624764997115*^9}, {
  3.6806247965259185`*^9, 
  3.680624857013378*^9}},ExpressionUUID->"35c19298-b199-4b8e-a2e2-\
67d2b6e4b74a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"This", " ", "returns", " ", "all", " ", "green", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"or", " ", "blue"}], ",", " ", 
      RowBox[{
       RowBox[{"specified", " ", "by", " ", "colorN"}], " ", "=", " ", 
       RowBox[{
       "1", " ", "for", " ", "green", " ", "and", " ", "2", " ", "for", " ", 
        "blue"}]}]}], ")"}], " ", "elements", " ", "of", " ", "gbpairs", " ", 
    "whose", " ", "blue", " ", 
    RowBox[{"(", 
     RowBox[{"or", " ", "green"}], ")"}], " ", "element", " ", "is", " ", "a",
     " ", "member", " ", "of", " ", "colorList"}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ColorLinker", "[", 
    RowBox[{"pairs_", ",", "colorList_", ",", "colorN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"colorList", ",", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"colorN", "\[Equal]", "1"}], ",", "2", ",", "1"}], 
              "]"}], "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "colorN"}], "\[RightDoubleBracket]"}], "//", 
      "Union"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6805740062990694`*^9, 3.6805740406204433`*^9}, {
   3.6805741188562174`*^9, 3.6805741787253094`*^9}, {3.6805742783761835`*^9, 
   3.6805744551618032`*^9}, {3.680574568875996*^9, 3.6805745770167227`*^9}, {
   3.6805746087046037`*^9, 3.680574638548729*^9}, {3.6805746814887447`*^9, 
   3.680574736205081*^9}, {3.6805747827626133`*^9, 3.6805747852001743`*^9}, {
   3.6805752554891725`*^9, 3.6805752772550993`*^9}, {3.680575586323535*^9, 
   3.680575588370466*^9}, {3.6805756485840797`*^9, 3.6805756489434566`*^9}, {
   3.6805757700250216`*^9, 3.6805757790564346`*^9}, {3.680577674705389*^9, 
   3.6805778461890535`*^9}, {3.6805780041356936`*^9, 3.680578086949133*^9}, 
   3.680580011546554*^9, {3.680582146697378*^9, 3.680582190295504*^9}, {
   3.680582634441224*^9, 3.680582676237847*^9}, {3.680611589887657*^9, 
   3.680611591153296*^9}, {3.6806117919141035`*^9, 3.680611804492385*^9}, {
   3.6806144134000797`*^9, 3.6806144195720625`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"55471e2b-443c-4c68-b9c6-964851130635"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CrossPairFinder[gbtrackpairs] \[Rule] list of green tracks gi connected to \
list of blue tracks bi : {{g1,b1}, {g2, b2}, ...}\
\>", "Subsection",
 CellChangeTimes->{{3.6805823863330293`*^9, 3.6805823912862163`*^9}, 
   3.680624601365756*^9, {3.68062478274113*^9, 3.6806247899335413`*^9}, {
   3.6806248648218246`*^9, 3.6806249434613223`*^9}, 3.6806252236703496`*^9, {
   3.715628406372265*^9, 
   3.715628413204655*^9}},ExpressionUUID->"c2553a79-340b-401e-beb0-\
9eb1e1d4ceea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossPairFinder", "[", "myGBpairs_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b1", ",", "g1", ",", "seed", ",", 
      RowBox[{"myFlag", "=", "0"}], ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"seed", "=", 
         RowBox[{"{", 
          RowBox[{"myGBpairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "}"}]}], ";", 
        " ", 
        RowBox[{"(*", 
         RowBox[{
         "seed", " ", "with", " ", "ith", " ", "green", " ", "element", " ", 
          "from", " ", "pair", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"myFlag", "\[Equal]", "0"}], " ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"b1", "=", 
            RowBox[{
             RowBox[{"ColorLinker", "[", 
              RowBox[{"myGBpairs", ",", "seed", ",", "2"}], "]"}], "//", 
             "Union"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "bluelist", " ", "b1", " ", "connected", " ", "to", " ", 
             "greenlist", " ", "seed"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"g1", "=", 
            RowBox[{
             RowBox[{"ColorLinker", "[", 
              RowBox[{"myGBpairs", ",", "b1", ",", "1"}], "]"}], "//", 
             "Union"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "greenlist", " ", "g1", " ", "connected", " ", "to", " ", 
             "bluelist", " ", "b1"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"g1", "\[Equal]", "seed"}], ",", 
             RowBox[{"myFlag", "=", "1"}], ",", " ", 
             RowBox[{"seed", "=", "g1"}]}], "]"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
            "exit", " ", "if", " ", "greenlist", " ", "g1", " ", "is", " ", 
             "the", " ", "same", " ", "as", " ", "seed"}], ";", " ", 
            RowBox[{"if", " ", "not"}]}], ",", " ", 
           RowBox[{"g1", " ", "becomes", " ", "new", " ", "seed"}]}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myFlag", "=", "0"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "repeat", " ", "loop", " ", "for", " ", "all", " ", "possible", " ", 
          "green", " ", "seeds"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"g1", ",", "b1"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "myGBpairs", "]"}], ",", "1"}], "}"}]}], 
      "]"}], "//", "Union"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6805804083588796`*^9, 3.680580496547429*^9}, {
   3.6805806479556093`*^9, 3.6805806957530966`*^9}, {3.6805808476007257`*^9, 
   3.680580847819522*^9}, {3.680580927929554*^9, 3.6805809299138975`*^9}, {
   3.6805822183190556`*^9, 3.6805823167853155`*^9}, {3.680582445147624*^9, 
   3.680582489650468*^9}, 3.6805825196701097`*^9, {3.6805826935160985`*^9, 
   3.6805827655538387`*^9}, {3.68061140063095*^9, 3.680611502910879*^9}, {
   3.6806115504808807`*^9, 3.680611563652952*^9}, {3.680611606508988*^9, 
   3.68061164941532*^9}, {3.680611719298317*^9, 3.680611763017613*^9}, {
   3.6806118326217384`*^9, 3.680611837434298*^9}, {3.6806118732598915`*^9, 
   3.6806119010954266`*^9}, {3.680612028677389*^9, 3.6806120313336725`*^9}, {
   3.680612125630992*^9, 3.6806121606332965`*^9}, {3.680612400194989*^9, 
   3.680612531452464*^9}, {3.680612562975997*^9, 3.680612651693954*^9}, {
   3.680612698670108*^9, 3.680612704732683*^9}, {3.680612737749642*^9, 
   3.6806127839376864`*^9}, {3.6806128376774015`*^9, 3.68061283875551*^9}, {
   3.6806129034791393`*^9, 3.680612931182576*^9}, {3.680612991955402*^9, 
   3.6806130150338707`*^9}, {3.680613258192689*^9, 3.680613259848961*^9}, {
   3.680613998596075*^9, 3.680614023940117*^9}, {3.680614216257804*^9, 
   3.6806142169140077`*^9}, {3.6806144254002414`*^9, 
   3.6806144270565624`*^9}, {3.680623480818158*^9, 3.6806235013184032`*^9}, 
   3.680624604283923*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"d1bd9974-d7f1-47e7-ab6a-e0c236e0c6d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectByColor", "Subsection",
 CellChangeTimes->{{3.68184476959031*^9, 3.681844775966675*^9}, {
  3.681844807942504*^9, 3.681844812318754*^9}, {3.6818451029743786`*^9, 
  3.68184510719862*^9}, {3.681848738193301*^9, 
  3.681848741585495*^9}},ExpressionUUID->"7b107ae1-c8ef-4f7e-ad33-\
e85ce5d6c16e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect2Colors", "[", 
   RowBox[{
   "track1_", ",", "track2_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxTrack1", ",", "idxTrack2", ",", "myAllLink", ",", "tempTrack1", ",", 
      "tempTrack2", ",", "myLinkList", ",", "newTrack1", ",", "newTrack2", 
      ",", "myMergedTrack", ",", "bigTrack1", ",", "bigTrack2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
     "Getting", " ", "color", " ", "index", " ", "assuming", " ", "the", " ", 
      "tracks", " ", "have", " ", "never", " ", "been", " ", "connected", " ",
       "with", " ", "any", " ", "other", " ", "colors"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"idxTrack1", "=", 
      RowBox[{"track1", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idxTrack2", "=", 
      RowBox[{"track2", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Creating", " ", "linking", " ", "pair", " ", "list"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"myAllLink", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempTrack1", "=", 
          RowBox[{
          "track1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tempTrack2", "=", 
          RowBox[{
          "track2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"FindOverlapDist", "[", 
          RowBox[{"tempTrack1", ",", "tempTrack2", ",", "minOverlapTime"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "track1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "track2"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myLinkList", "=", 
      RowBox[{"CrossPairFinder", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"myAllLink", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "\[LessEqual]", "x", "<", "maxOverlapDistance"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Preparing", " ", "output", " ", "track"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", "track1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", "track2"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Connecting", " ", "tracks"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myMergedTrack", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"track1", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"track2", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "}"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
             "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"SplitBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
            "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[Equal]", "idxTrack1"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "  ", 
        RowBox[{"(*", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "automatically", " ", 
          "deletes", " ", "times", " ", "where", " ", "three", " ", "or", " ",
           "more", " ", "points", " ", "appears", " ", "at", " ", "once"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "automatically", " ", 
          "deletes", " ", "times", " ", "where", " ", "there", " ", "is", " ",
           "overlap", " ", "in", " ", "multiple", " ", "tracks", " ", "in", 
          " ", "track1"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", 
        RowBox[{"(*", 
         RowBox[{
         "Choose", " ", "to", " ", "label", " ", "big", " ", "track", " ", 
          "as", " ", "lowest", " ", 
          RowBox[{"#", "'"}], "d", " ", "track1"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"idxTrack1", "+", "idxTrack2"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Change", " ", "color", " ", "index", " ", "to", " ", "two", " ", 
          "colors", " ", "from", " ", "one", " ", "color"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack1"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "lowest", " ", "#", " ", "track1", " ", "that", " ", "should", " ", 
           "be", " ", "linked", " ", "is", " ", "replaced", " ", "with", " ", 
           "bigTrack1"}], ";", " ", 
          RowBox[{"others", " ", "become", " ", 
           RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTrack2", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[Equal]", "idxTrack2"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack2", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack2", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"idxTrack1", "+", "idxTrack2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack2"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "myLinkList"}], ",", "1"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Now", " ", "get", " ", "rid", " ", "of", " ", "the", " ", 
       RowBox[{"{", "}"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack1"}]}]}], ";", 
     RowBox[{"(*", "renumber", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack2", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrack1", ",", "newTrack2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6818477833286858`*^9, 3.6818479300650787`*^9}, 
   3.681847962152914*^9, {3.6818480224173613`*^9, 3.681848083193837*^9}, {
   3.681848114416623*^9, 3.6818481247852163`*^9}, {3.6818487447936783`*^9, 
   3.6818487458577394`*^9}, {3.6818533936295767`*^9, 3.681853409781501*^9}, {
   3.682708447520831*^9, 3.6827084621686687`*^9}, {3.6827085690727835`*^9, 
   3.6827086288092003`*^9}, {3.6827087069206676`*^9, 3.68270872880892*^9}, {
   3.682766907607557*^9, 3.6827669156630173`*^9}, {3.68276707498313*^9, 
   3.6827671445201073`*^9}, {3.682768646177997*^9, 3.6827686940657363`*^9}, {
   3.6827687722172065`*^9, 3.682768776041425*^9}, {3.6827688265133123`*^9, 
   3.6827688825615177`*^9}, {3.6827689192496157`*^9, 3.682768923001831*^9}, {
   3.682769039177476*^9, 3.6827691459455824`*^9}, {3.682770721506699*^9, 
   3.682770737554617*^9}, {3.682860302066414*^9, 3.6828603066736774`*^9}, {
   3.6828603498911495`*^9, 3.682860543546226*^9}, {3.6828605761940937`*^9, 
   3.6828605966112614`*^9}, {3.682861188652124*^9, 3.6828612173707666`*^9}, {
   3.6828614396034775`*^9, 3.6828617892354755`*^9}, {3.682861825644558*^9, 
   3.6828618869800663`*^9}, 3.682862876700675*^9, {3.682863100068451*^9, 
   3.6828631120611367`*^9}, 3.6828635003333445`*^9, {3.6828721540043063`*^9, 
   3.6828721618757563`*^9}, {3.682885069295019*^9, 3.68288507107012*^9}, {
   3.6832990650866437`*^9, 3.6832990971674786`*^9}, {3.6832991433351192`*^9, 
   3.6832991439671555`*^9}, {3.6832995779349775`*^9, 
   3.6832996392954865`*^9}, {3.6832996727033978`*^9, 3.683299686272174*^9}, {
   3.683299717889982*^9, 3.6832997212561746`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"5949f831-9ad6-4d4e-afc3-8c73c12a52e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect2ColorsFor3", "[", 
   RowBox[{
   "track1_", ",", "track2_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_", ",", "track1Color_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxTrack1", ",", "idxTrack2", ",", "myAllLink", ",", "tempTrack1", ",", 
      "tempTrack2", ",", "myLinkList", ",", "newTrack1", ",", "newTrack2", 
      ",", "myMergedTrack", ",", "bigTrack1", ",", "bigTrack2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllLink", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempTrack1", "=", 
          RowBox[{
          "track1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tempTrack2", "=", 
          RowBox[{
          "track2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"FindOverlapDist", "[", 
          RowBox[{"tempTrack1", ",", "tempTrack2", ",", "minOverlapTime"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "track1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "track2"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myLinkList", "=", 
      RowBox[{"CrossPairFinder", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"myAllLink", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "\[LessEqual]", "x", "<", "maxOverlapDistance"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", "track1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myMergedTrack", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"track1", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"track2", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "}"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
             "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"SplitBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
            "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", "track1Color"}], 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}]}], "]"}], 
              ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"idxTrack1", "=", 
         RowBox[{"Total", "@", 
          RowBox[{"track1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1", 
            ",", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"idxTrack2", "=", 
         RowBox[{"Total", "@", 
          RowBox[{"track2", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", "1", 
            ",", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"idxTrack1", "+", "idxTrack2"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "0"}]}], "\[Rule]", "1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack1"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "myLinkList"}], ",", "1"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"track2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
            "Flatten"}], "//", "Sort"}], ")"}]}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrack1", ",", "newTrack2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6833889497817545`*^9, 3.683389048590406*^9}, {
  3.6833892503099437`*^9, 3.6833892517180243`*^9}, {3.695053735866331*^9, 
  3.695053742513711*^9}, {3.69505533034753*^9, 3.695055330827557*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"7e74beb0-2562-419b-a59e-340dcf8671a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect3Colors", "[", 
   RowBox[{
   "trackr_", ",", "trackg_", ",", "trackb_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "trackgb", ",", "trackbAlone", ",", "trackrgb", ",", "newTrackr", ",", 
      "trackbr", ",", "trackrAlone1", ",", "trackgbr", ",", "newTrackg", ",", 
      "trackgr", ",", "trackrAlone2", ",", "trackbgr", ",", "newTrackb", ",", 
      "dum"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgb", ",", "trackbAlone"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackb", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackrgb", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackr", ",", "trackgb", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackrgb", ",", "trackbAlone", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackbr", ",", "trackrAlone1"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackb", ",", "trackr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgbr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackbr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackg", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackgbr", ",", "trackrAlone1", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgr", ",", "trackrAlone2"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackbgr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackb", ",", "trackgr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackb", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackbgr", ",", "trackrAlone2", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrackr", ",", "newTrackg", ",", "newTrackb"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6833890896927567`*^9, 3.6833892422454824`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"9a80c090-7bc0-47f8-84b7-21da8f5c3bd6"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectTracks[tracks_,listConnectTracks, (renumberQ)]", "Subsection",
 CellChangeTimes->{{3.67925864456554*^9, 3.6792586589813643`*^9}, {
  3.679260491399173*^9, 
  3.6792605037188773`*^9}},ExpressionUUID->"375fabfc-537b-4e00-a5f7-\
38fbb96f9ab0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracks", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newTracksList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTracksList", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTracksList"}]}]}], ";", 
     "\[IndentingNewLine]", "newTracksList"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.679260438412142*^9, 3.679260486195875*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"34de6b27-6377-4071-89a4-b240db734b6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracks", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_", ",", "renumberQ_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newTracksList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"renumberQ", ",", 
       RowBox[{
        RowBox[{"newTracksList", "=", 
         RowBox[{"SplitBy", "[", 
          RowBox[{
           RowBox[{"Sort", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "newTracksList"}]}]}]}], ",", 
       "newTracksList"}], "]"}], ";", "\[IndentingNewLine]", 
     "newTracksList"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.679260438412142*^9, 3.679260467243791*^9}, {
  3.6792605093571997`*^9, 3.67926051250838*^9}, {3.679260779604657*^9, 
  3.6792608012368946`*^9}, {3.679260951305478*^9, 3.6792609531485834`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"7961cdd5-2ef1-4bd7-8eb3-38a9c1dec976"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracksFilled", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newTracksList", ",", "spotEnd", ",", "spotStart", ",", "missingNum", 
      ",", "fillingNum", ",", "fillingPos", ",", "fillingSpots"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"spotEnd", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Last", "@", 
            RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
             RowBox[{
             "listConnectTracks", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ")"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"spotStart", "=", 
         RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", "1", ",",
            "2"}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingNum", "=", 
         RowBox[{
          RowBox[{
          "spotStart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
          "spotEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"missingNum", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fillingNum", "=", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "spotEnd", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "+", "1"}], ",", 
              RowBox[{
               RowBox[{
               "spotStart", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "-", "1"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fillingPos", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Plus", "[", 
               RowBox[{"#", ",", 
                RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}]}],
                "]"}], "&"}], "/@", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", 
               RowBox[{
                RowBox[{"Range", "@", "missingNum"}], "/", 
                RowBox[{"(", 
                 RowBox[{"missingNum", "+", "1"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"spotStart", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], 
                "-", 
                RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fillingSpots", "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
                RowBox[{
                "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ",", 
              "missingNum"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fillingSpots", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{"fillingNum", ",", "fillingPos"}], "}"}]}], "//", 
              "Flatten"}], "//", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
             RowBox[{
             "listConnectTracks", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
               RowBox[{
               "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], "+",
                "missingNum"}], ",", "fillingSpots"}], "]"}]}]}]}], "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "listConnectTracks"}], "-", "1"}], ",", 
         "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTracksList", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTracksList"}]}]}], ";", 
     "\[IndentingNewLine]", "newTracksList"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6818437818788157`*^9, 3.681843790654318*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"e8acae78-ce0e-490d-9cd9-490870b4bc93"]
}, Closed]],

Cell[CellGroupData[{

Cell["TrackFiller", "Subsection",
 CellChangeTimes->{{3.681819224690225*^9, 
  3.68181922983352*^9}},ExpressionUUID->"2a735256-94d2-4f2a-ac1f-\
49713f46a7e4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "This", " ", "module", " ", "fills", " ", "any", " ", "gaps", " ", "in", 
   " ", "tracks", " ", "by", " ", "interpolating", " ", "the", " ", 
   "position", " ", "from", " ", "the", " ", "last", " ", "postion", " ", 
   "before", " ", "the", " ", "gap", " ", "and", " ", "the", " ", "first", 
   " ", "position", " ", "after", " ", "the", " ", "gap"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.681839614018428*^9, 3.681839638313818*^9}, {
  3.681839694090008*^9, 3.681839739850625*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"3805a56c-ee52-4108-964c-3cfa77c43a0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrackFiller", "[", "tracksList_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "filledTracksList", ",", "myIdx", ",", "missingStart", ",", "missingNum",
       ",", "missingStartShifted", ",", "spotEnd", ",", "spotStart", ",", 
      "fillingNum", ",", "fillingPos", ",", "fillingSpots", ","}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filledTracksList", "=", "tracksList"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myIdx", "=", 
         RowBox[{
          RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{"2", ";;"}], ",", "2", ",", "1"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{";;", 
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{
               "filledTracksList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "-", "1"}]}], ",", "2", ",", 
            "1"}], "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingStart", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"myIdx", ",", 
             RowBox[{"x_", "/;", 
              RowBox[{"x", ">", "1"}]}]}], "]"}], "+", "1"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingNum", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"myIdx", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "1"}]}]}], "]"}], "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"missingStart", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"missingStartShifted", "=", "missingStart"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"missingStartShifted", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"missingStart", "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FoldList", "[", 
                RowBox[{"Plus", ",", "missingNum"}], "]"}], ")"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{
                RowBox[{"Length", "@", "missingNum"}], "-", "1"}]}], 
              "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"spotEnd", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                  "\[RightDoubleBracket]"}], ")"}], "\[LeftDoubleBracket]", 
                "2", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"spotStart", "=", 
               RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", 
                 RowBox[{
                 "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], ",", "2"}], 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"fillingNum", "=", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "spotEnd", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "+", "1"}], ",", 
                 RowBox[{
                  RowBox[{
                  "spotStart", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "-", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fillingPos", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Plus", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Outer", "[", 
                 RowBox[{"Times", ",", 
                  RowBox[{
                   RowBox[{"Range", "@", 
                    RowBox[{
                    "missingNum", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "missingNum", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "+", "1"}], ")"}]}], ",", 
                  RowBox[{
                   RowBox[{"spotStart", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}],
                    "-", 
                   RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fillingSpots", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "missingNum", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fillingSpots", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "@", 
                  RowBox[{"{", 
                   RowBox[{"fillingNum", ",", "fillingPos"}], "}"}]}], "//", 
                 "Flatten"}], "//", 
                RowBox[{
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "filledTracksList", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                   "filledTracksList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "fillingSpots", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "+", "k", "-", "1"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", 
                  RowBox[{
                  "missingNum", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", "1"}], "}"}]}], "]"}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "@", "missingStart"}], ",", "1"}], "}"}]}], 
            "]"}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "filledTracksList"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "filledTracksList"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.681819232566676*^9, 3.681819281457472*^9}, {
  3.681836758312091*^9, 3.681836906328557*^9}, {3.681836938336388*^9, 
  3.681836980535802*^9}, {3.681837014016717*^9, 3.681837143512123*^9}, {
  3.6818371739048615`*^9, 3.6818373862010045`*^9}, {3.6818390382424955`*^9, 
  3.68183903989859*^9}, {3.681839128498658*^9, 3.6818391529510565`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"266eeab2-059a-4c81-8b56-efccb51887b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindConnectableTracks", "Subsection",
 CellChangeTimes->{{3.679313898838685*^9, 
  3.6793139041269875`*^9}},ExpressionUUID->"df42858d-8eb6-430d-baab-\
004a77ced840"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindConnectableTracks2", "[", 
   RowBox[{
   "tracksList_", ",", "myMaxN_", ",", "dist_", ",", "time_", ",", 
    "trackNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allTracksStart", ",", "timeEnd", ",", "posiEnd", ",", "afterTracks", 
      ",", "listConnectTracks", ",", "tempConnectTracks", ",", 
      "tempConnectTracks2", ",", "tempConnectTracks3", ",", 
      "posiConnectTracks", ",", "tempTrack", ",", "tempFrame"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allTracksStart", "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"trackNumber", "+", "1"}], ")"}], ";;"}], ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeEnd", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "@", 
         RowBox[{
         "tracksList", "\[LeftDoubleBracket]", "trackNumber", 
          "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posiEnd", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "@", 
         RowBox[{
         "tracksList", "\[LeftDoubleBracket]", "trackNumber", 
          "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"afterTracks", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"allTracksStart", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"timeEnd", "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
           "\[LessEqual]", 
           RowBox[{"timeEnd", "+", "time"}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "-", "dist"}], "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "+", "dist"}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             "-", "dist"}], "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             "+", "dist"}]}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listConnectTracks", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"trackNumber", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"afterTracks", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"afterTracks", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
        "tracksList", "\[LeftDoubleBracket]", "listConnectTracks", 
         "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"tracksList", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempConnectTracks", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tempConnectTracks", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks2", "=", 
      RowBox[{
       RowBox[{"tempConnectTracks", "//", "Sort"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks3", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tempConnectTracks2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"tempConnectTracks2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], "}"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"posiConnectTracks", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", "myMaxN"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
           "myMaxN"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tempFrame", "=", 
         RowBox[{"tempConnectTracks3", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{
         RowBox[{"posiConnectTracks", "\[LeftDoubleBracket]", 
          RowBox[{"tempFrame", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"tempConnectTracks3", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "tempConnectTracks3"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"listConnectTracks", ",", "posiConnectTracks"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6787314149002867`*^9, 3.678731473628646*^9}, {
   3.678731527835746*^9, 3.678731651943845*^9}, {3.67873192075622*^9, 
   3.678731925884513*^9}, {3.6787323688368483`*^9, 3.678732492620929*^9}, {
   3.6787335929338627`*^9, 3.678733599774254*^9}, {3.6787336336611924`*^9, 
   3.6787336361663356`*^9}, 3.6790900466130695`*^9, {3.679090105420433*^9, 
   3.6790901372212524`*^9}, {3.67909033683667*^9, 3.6790904911094933`*^9}, {
   3.6791367729136615`*^9, 3.67913678355427*^9}, {3.6791370766180325`*^9, 
   3.6791371439218817`*^9}, {3.6791371846022086`*^9, 
   3.6791372102186737`*^9}, {3.6791372727062483`*^9, 3.679137333898748*^9}, {
   3.679137417098507*^9, 3.6791374283151484`*^9}, {3.6791501942853203`*^9, 
   3.6791502799182177`*^9}, {3.679152732282485*^9, 3.6791527339295793`*^9}, {
   3.6792419937019463`*^9, 3.679242050430191*^9}, {3.679250900469384*^9, 
   3.679250901061418*^9}, {3.679258064987171*^9, 3.6792580677713304`*^9}, {
   3.6792585280766582`*^9, 3.6792585508039584`*^9}, {3.6792616162782936`*^9, 
   3.6792616315821686`*^9}, {3.6792620662780323`*^9, 3.679262089254346*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"4fd90806-9be8-4a25-a36c-77dffc74a978"]
}, Closed]],

Cell[CellGroupData[{

Cell["NearestNeighborLinking", "Subsection",
 CellChangeTimes->{{3.713636244958868*^9, 
  3.713636252095276*^9}},ExpressionUUID->"0ea5db5a-8ce4-4f8b-9e03-\
9d993d23342d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Using", " ", "a", " ", "globally", " ", "determined", " ", 
    RowBox[{"(", "automatic", ")"}], " ", "threshod", " ", "for", " ", 
    "binarization"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NearestNeighborLinking1", "[", 
    RowBox[{
    "img_", ",", "channel_", ",", "startFrame_", ",", "startPosition_", ",", 
     "pad_", ",", "bandpass_", ",", "dotsize_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newPos", ",", "myTrack", ",", "myTrimImg", ",", "tempOrigin", ",", 
       "myNewTempCenterList", ",", "tempCenter", ",", "flagFin", ",", 
       "euList"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newPos", "=", "startPosition"}], ";", "\[IndentingNewLine]", 
      RowBox[{"myTrack", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"myTrimImg", "=", 
           RowBox[{"ImageTrim", "[", 
            RowBox[{
             RowBox[{"img", "\[LeftDoubleBracket]", 
              RowBox[{"channel", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "-", "pad"}], ",", 
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "+", "pad", "-", 
                "0.1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tempOrigin", "=", 
           RowBox[{
            RowBox[{"Ceiling", "@", "newPos"}], "-", "pad", "-", "1"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"myNewTempCenterList", "=", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{
             RowBox[{"ImageMultiply", "[", 
              RowBox[{"myTrimImg", ",", 
               RowBox[{"SelectComponents", "[", 
                RowBox[{
                 RowBox[{"Binarize", "[", 
                  RowBox[{"BandPass", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "@", "myTrimImg"}], ",", 
                    "bandpass"}], "]"}], "]"}], ",", "\"\<Count\>\"", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", "#", "<", 
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
               "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
               "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
               "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
               "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"myNewTempCenterList", "=", 
              RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
             RowBox[{"tempCenter", "=", 
              RowBox[{
              "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"myNewTempCenterList", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "tempOrigin"}], "*", "1.0"}], ",", "0", ",", 
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                 "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"myNewTempCenterList", "=", 
                RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"euList", "=", 
                    RowBox[{
                    RowBox[{"N", "@", "Total"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pad", ",", "pad"}], "}"}], "+", "0.5", "-", 
                    "#"}], ")"}], "^", "2"}], "&"}], "/@", 
                    RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Min", "@", "euList"}]}], "]"}]}], ")"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
               RowBox[{"tempCenter", "=", 
                RowBox[{
                "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newPos", "=", 
           RowBox[{"tempOrigin", "+", "tempCenter"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "+=", "tempOrigin"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myNewTempCenterList"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "startFrame", ",", 
           RowBox[{"Length", "@", 
            RowBox[{
            "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7136232245561433`*^9, 3.7136232269002776`*^9}, {
   3.7136232829164815`*^9, 3.7136233141482677`*^9}, {3.71362348569308*^9, 
   3.7136235304126377`*^9}, {3.7136235713409786`*^9, 
   3.7136236995503116`*^9}, {3.713623731533141*^9, 3.71362378763735*^9}, {
   3.7136238545101748`*^9, 3.713623869126011*^9}, {3.713626004392141*^9, 
   3.713626012959631*^9}, {3.7136331241973705`*^9, 3.7136331300937076`*^9}, 
   3.7168389349994345`*^9, {3.7168389704584627`*^9, 3.7168389918586864`*^9}, {
   3.7168391921041403`*^9, 3.7168392837123795`*^9}, {3.7168969767182307`*^9, 
   3.716896976846238*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"2faf830e-7352-4971-ba87-4416dedebc68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Using", " ", "user", " ", "defined", " ", "threshod", " ", "for", " ", 
    "binarization"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NearestNeighborLinking2", "[", 
    RowBox[{
    "img_", ",", "channel_", ",", "startFrame_", ",", "startPosition_", ",", 
     "pad_", ",", "threshold1_", ",", "bandpass_", ",", "max_", ",", 
     "threshold2_", ",", "dotsize_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newPos", ",", "myTrack", ",", "myTrimImg", ",", "tempOrigin", ",", 
       "myNewTempCenterList", ",", "tempCenter", ",", "flagFin", ",", 
       "euList"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newPos", "=", "startPosition"}], ";", "\[IndentingNewLine]", 
      RowBox[{"myTrack", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"myTrimImg", "=", 
           RowBox[{"ImageTrim", "[", 
            RowBox[{
             RowBox[{"img", "\[LeftDoubleBracket]", 
              RowBox[{"channel", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "-", "pad"}], ",", 
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "+", "pad", "-", 
                "0.1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tempOrigin", "=", 
           RowBox[{
            RowBox[{"Ceiling", "@", "newPos"}], "-", "pad", "-", "1"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"myNewTempCenterList", "=", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{
             RowBox[{"ImageMultiply", "[", 
              RowBox[{"myTrimImg", ",", 
               RowBox[{"SelectComponents", "[", 
                RowBox[{
                 RowBox[{"Binarize", "[", 
                  RowBox[{
                   RowBox[{"BandPass", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{"myTrimImg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "threshold1"}], "]"}], ",", "bandpass"}], "]"}], ",", 
                   RowBox[{"max", "*", "threshold2"}]}], "]"}], ",", 
                 "\"\<Count\>\"", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", "#", "<", 
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
               "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
               "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
               "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
               "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"myNewTempCenterList", "=", 
              RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
             RowBox[{"tempCenter", "=", 
              RowBox[{
              "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"myNewTempCenterList", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "tempOrigin"}], "*", "1.0"}], ",", "0", ",", 
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                 "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"myNewTempCenterList", "=", 
                RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"euList", "=", 
                    RowBox[{
                    RowBox[{"N", "@", "Total"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pad", ",", "pad"}], "}"}], "+", "0.5", "-", 
                    "#"}], ")"}], "^", "2"}], "&"}], "/@", 
                    RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Min", "@", "euList"}]}], "]"}]}], ")"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
               RowBox[{"tempCenter", "=", 
                RowBox[{
                "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newPos", "=", 
           RowBox[{"tempOrigin", "+", "tempCenter"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "+=", "tempOrigin"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myNewTempCenterList"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "startFrame", ",", 
           RowBox[{"Length", "@", 
            RowBox[{
            "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7136232245561433`*^9, 3.7136232269002776`*^9}, {
   3.7136232829164815`*^9, 3.7136233141482677`*^9}, {3.71362348569308*^9, 
   3.7136235304126377`*^9}, {3.7136235713409786`*^9, 
   3.7136236995503116`*^9}, {3.713623731533141*^9, 3.71362378763735*^9}, {
   3.7136238545101748`*^9, 3.713623869126011*^9}, {3.713626004392141*^9, 
   3.713626012959631*^9}, {3.7136331241973705`*^9, 3.7136331300937076`*^9}, 
   3.7152803087122173`*^9, {3.7152803820724134`*^9, 3.715280394208107*^9}, {
   3.715280439327688*^9, 3.715280447024128*^9}, {3.715283100618905*^9, 
   3.7152831529468985`*^9}, 3.7153683920062933`*^9, {3.715368447870489*^9, 
   3.715368465935522*^9}, 3.715368830591379*^9, {3.715368926510865*^9, 
   3.715368926989893*^9}, {3.7153689807669687`*^9, 3.7153689824550653`*^9}, {
   3.715369125431243*^9, 3.7153691860067077`*^9}, {3.715369559759085*^9, 
   3.715369565031387*^9}, {3.7153745206118298`*^9, 3.715374526583171*^9}, {
   3.715734175657922*^9, 3.715734182007285*^9}, {3.7157351145786247`*^9, 
   3.7157351553949594`*^9}, {3.7157353126509542`*^9, 
   3.7157353399945183`*^9}, {3.7157353767066174`*^9, 
   3.7157353768666267`*^9}, {3.7157360009653234`*^9, 3.71573600615562*^9}, {
   3.715950921504075*^9, 3.7159509387910633`*^9}, {3.7159515373592997`*^9, 
   3.7159515669839945`*^9}, {3.7168049211329527`*^9, 3.716804930300477*^9}, {
   3.716808616344307*^9, 3.7168087186411576`*^9}, {3.7168087925193834`*^9, 
   3.716808881312462*^9}, {3.7168089824322453`*^9, 3.7168090069846497`*^9}, {
   3.716809281840371*^9, 3.7168092844645205`*^9}, {3.716809665465313*^9, 
   3.7168097154961743`*^9}, {3.716809806893402*^9, 3.7168098210342107`*^9}, {
   3.7168098925092993`*^9, 3.7168099200168724`*^9}, {3.7168294690890155`*^9, 
   3.716829476072415*^9}, {3.7168318680432277`*^9, 3.716831870338359*^9}, {
   3.7168366670147133`*^9, 3.716836667678751*^9}, {3.716839289000682*^9, 
   3.7168393122970147`*^9}, {3.716896979182372*^9, 3.7168969793343806`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"37fceca0-686c-4dcc-a76d-900739511464"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NearestNeighborLinking3D2", "[", 
   RowBox[{
   "img_", ",", "channel_", ",", "startFrame_", ",", "startPosition_", ",", 
    "pad_", ",", "threshold1_", ",", "bandpass_", ",", "max_", ",", 
    "threshold2_", ",", "dotsize_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newPos", ",", "myTrack", ",", "myTrimImg", ",", "tempOrigin", ",", 
      "myNewTempCenterList", ",", "tempCenter", ",", "flagFin", ",", 
      "euList"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newPos", "=", "startPosition"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myTrack", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myTrimImg", "=", 
          RowBox[{"ImageTrim", "[", 
           RowBox[{
            RowBox[{"img", "\[LeftDoubleBracket]", 
             RowBox[{"channel", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Ceiling", "@", "newPos"}], "-", "pad"}], ",", 
              RowBox[{
               RowBox[{"Ceiling", "@", "newPos"}], "+", "pad", "-", "0.1"}]}],
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempOrigin", "=", 
          RowBox[{
           RowBox[{"Ceiling", "@", "newPos"}], "-", "pad", "-", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myNewTempCenterList", "=", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{
            RowBox[{"ImageMultiply", "[", 
             RowBox[{"myTrimImg", ",", 
              RowBox[{"SelectComponents", "[", 
               RowBox[{
                RowBox[{"Binarize", "[", 
                 RowBox[{
                  RowBox[{"BandPass", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{"myTrimImg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "threshold1"}], "]"}], ",", "bandpass"}], "]"}], ",", 
                  RowBox[{"max", "*", "threshold2"}]}], "]"}], ",", 
                "\"\<Count\>\"", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "dotsize", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "<", "#", "<", 
                  RowBox[{
                  "dotsize", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
              "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
              "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
              "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
              "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], "}"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", "1"}],
            ",", 
           RowBox[{
            RowBox[{"myNewTempCenterList", "=", 
             RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
            RowBox[{"tempCenter", "=", 
             RowBox[{
             "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{"myNewTempCenterList", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "tempOrigin"}], "*", "1.0"}], ",", "0", ",", 
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myNewTempCenterList", "=", 
               RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"euList", "=", 
                    RowBox[{
                    RowBox[{"N", "@", "Total"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pad", ",", "pad"}], "}"}], "+", "0.5", "-", 
                    "#"}], ")"}], "^", "2"}], "&"}], "/@", 
                    RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Min", "@", "euList"}]}], "]"}]}], ")"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
                  "2"}], "\[RightDoubleBracket]"}]}], ";", 
              RowBox[{"tempCenter", "=", 
               RowBox[{
               "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newPos", "=", 
          RowBox[{"tempOrigin", "+", "tempCenter"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "+=", "tempOrigin"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         "myNewTempCenterList"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "startFrame", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7186461866496315`*^9, 3.718646187089657*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"4cad4ff6-f0a9-4c81-bb9d-a18d50bbc031"]
}, Closed]],

Cell[CellGroupData[{

Cell["ClickAndTrack", "Subsection",
 CellChangeTimes->{{3.713636223270627*^9, 
  3.7136362302310257`*^9}},ExpressionUUID->"5bd3dea6-8876-4c76-8b5d-\
bb9b57373ca2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClickAndTrack", "[", 
   RowBox[{"imgRaw_", ",", "img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImgRaw", "=", "imgRaw"}], ",", 
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "avgFrameN", ",", 
      "threshold1", ",", "threshold2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
           "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold2", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ",", 
           "\"\<_thblue2.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Nimg", "=", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myImg", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"spotType", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"binarizeMethod", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trackChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"dispChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trimPad", "=", "15"}], ",", "zoom", ",", 
         RowBox[{"myt", "=", "1"}], ",", "mycurpoints", ",", "newPos", ",", 
         "bandpass", ",", "dotsize", ",", "max", ",", "th2", ",", "myTrimImg",
          ",", "tempOrigin", ",", "myNewTempCenterList", ",", "tempCenter", 
         ",", "flagFin", ",", "euList", ",", "myTrack", ",", "myIdx", ",", 
         "myFitAllParameters", ",", "myFitPos", ",", "myFitData", ",", 
         "myFit", ",", "myColor", ",", "flagFileName", ",", "myFilename", ",",
          "myTruckNum"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "flagFileName", "=", "\"\<No track is saved in this session\>\""}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myFit", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
           "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Panel", "@", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Spot:        \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"spotType", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"spotType", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"spotType", "=", "#"}]}], "]"}], ")"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "1", "\[Rule]", "\"\<Difraction Limitted Spot\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Blob\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Binarization:           \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"binarizeMethod", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"binarizeMethod", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"binarizeMethod", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Automatic\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<User-defined\>\""}]}], 
                    "}"}]}], "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Channel: \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"trackChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"trackChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"trackChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Display Channel:    \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"dispChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"dispChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"dispChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Trim Size: \>\"", ",", 
                    RowBox[{"Spacer", "[", "45", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "trimPad", "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "3"}]}], "]"}]}], 
                   "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Track Particle\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "=", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "@", "Nimg"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}], "}"}], ",", "Nimg"}], 
                    "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"spotType", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "100"}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1000"}], "}"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"max", ",", "th2"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Re-Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Refill Gaps\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myIdx", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "-", "#1"}], "\[Equal]", "1"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "Nimg"}], "]"}]}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ",", "2", ",", 
                    "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ")"}]}], "*", 
                    "#"}]}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", "myIdx"}], ",", "1"}], "}"}]}], 
                    "]"}], ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    "\"\<No Track\>\""}], "]"}]}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track Gauss\>\"", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}]}]}], "}"}], "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}]}], "*)"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete Current Position\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete All Subsequent Positions\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}]}], ";"}]}], "]"}]}], "}"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Gaussian Fit\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"myFit", "=", 
                    RowBox[{"ParticleFitting2", "[", 
                    RowBox[{"myImgRaw", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "myTrack"}], ",", "3"}], "]"}]}], 
                    "}"}]}], "}"}], ",", "trimPad", ",", "avgFrameN"}], 
                    "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ","}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Save Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myColor", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\"\<red\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "2", "}"}]}], ",", "\"\<green\>\"", ",", 
                    "\"\<blue\>\""}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myTrackNum", "=", 
                    RowBox[{"1", "+", 
                    RowBox[{"Length", "@", 
                    RowBox[{"FileNames", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<*_myTrack_\>\"", "<>", "myColor", "<>", 
                    "\"\<*\>\""}], ",", 
                    RowBox[{"DirectoryName", "@", "analysisFolder"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"myFilename", "=", 
                    RowBox[{
                    "\"\<_myTrack_\>\"", "<>", "myColor", "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"ToString", "@", "myTrackNum"}], "<>", 
                    "\"\<.dat\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "myTrackNum"}], "]"}], "&"}], "/@", 
                    "myTrack"}], ")"}], ">>", 
                    RowBox[{"analysisFolder", "<>", "myFilename"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flagFileName", "=", 
                    RowBox[{
                    "\"\<Saved File Name : \>\"", "<>", "myFilename"}]}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", "flagFileName"}]}], "}"}]}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<time points   \>\"", ",", 
                 RowBox[{"Slider", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "myt", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Nimg", ",", "1"}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"600", ",", "20"}], "}"}]}]}], "]"}], " ", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<-\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", ">", "1"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "-", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<+\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", "<", "Nimg"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "+", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Spacer", "[", "10", "]"}], ",", 
                 RowBox[{"Dynamic", "[", "myt", "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"LocatorPane", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "mycurpoints", "]"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}],
                   "]"}], ",", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "+", "20", "-", 
                    "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}]}],
                 "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Spacer", "@", "3"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Yellow", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}], 
                    ",", "4"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "+", "20", "-", "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}]}],
                 "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7168388001647224`*^9, 3.71683883334162*^9}, {
   3.716839082028844*^9, 3.7168391614443865`*^9}, {3.7168393298620195`*^9, 
   3.716839335454339*^9}, {3.716839373916539*^9, 3.7168393764626846`*^9}, 
   3.71683966555122*^9, {3.7168400979099493`*^9, 3.716840153254115*^9}, {
   3.716840224542192*^9, 3.716840239119026*^9}, {3.7168935523053656`*^9, 
   3.716893562503949*^9}, {3.7168940576642704`*^9, 3.7168940650236917`*^9}, {
   3.7168941014087725`*^9, 3.71689411080031*^9}, {3.7168942481301646`*^9, 
   3.7168942542975173`*^9}, {3.71689439229041*^9, 3.716894417553855*^9}, 
   3.7168945363936524`*^9, {3.716894611569952*^9, 3.716894625553752*^9}, {
   3.716894744377548*^9, 3.716894764441696*^9}, 3.716894795376465*^9, {
   3.716894840953072*^9, 3.7168948413850965`*^9}, {3.716894906081797*^9, 
   3.7168950553133326`*^9}, {3.716895087010146*^9, 3.7168950889132547`*^9}, {
   3.716895138994119*^9, 3.7168951419212866`*^9}, {3.716895527874362*^9, 
   3.716895567746642*^9}, {3.7168957632518244`*^9, 3.716895771691307*^9}, {
   3.716895837002043*^9, 3.7168958392191696`*^9}, {3.716895894179313*^9, 
   3.716895933690573*^9}, {3.7168959856735463`*^9, 3.716896009002881*^9}, {
   3.716896048459138*^9, 3.7168961133958516`*^9}, {3.716896435499275*^9, 
   3.716896552626974*^9}, {3.7168965961954665`*^9, 3.7168966636353235`*^9}, 
   3.7168968967406564`*^9, {3.7168969951732864`*^9, 3.716897003571767*^9}, 
   3.7173599520836353`*^9, {3.717437650744745*^9, 3.7174376677057147`*^9}, {
   3.7174377325444236`*^9, 3.7174377344255314`*^9}, {3.717442673174011*^9, 
   3.717442685477715*^9}, {3.717442719365653*^9, 3.7174427617820797`*^9}, {
   3.717515242111717*^9, 3.717515259174693*^9}, 3.717515878791133*^9, {
   3.717515928638984*^9, 3.7175159500952115`*^9}, {3.717516026280569*^9, 
   3.717516073215254*^9}, {3.7175190913628817`*^9, 3.717519102474517*^9}, {
   3.7175191332742786`*^9, 3.71751914623402*^9}, {3.7175192069064903`*^9, 
   3.7175192202502537`*^9}, {3.7175192675549593`*^9, 3.717519273914323*^9}, 
   3.717519694043353*^9, {3.7175284753156133`*^9, 3.71752849099551*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"7a14c906-df1b-4174-9bd1-4b20d3555fcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClickAndTrack3D", "[", 
   RowBox[{"(*", 
    RowBox[{"imgRaw_", ","}], "*)"}], 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImgRaw", "=", "imgRaw"}], ",", 
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "avgFrameN", ",", 
      "threshold1", ",", "threshold2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ","}], 
           "*)"}], "\"\<_thblue.dat\>\"", "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold2", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ","}],
            "*)"}], "\"\<_thblue2.dat\>\"", "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Nimg", "=", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myImg", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"spotType", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"binarizeMethod", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trackChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"dispChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trimPad", "=", "15"}], ",", "zoom", ",", 
         RowBox[{"myt", "=", "1"}], ",", "mycurpoints", ",", "newPos", ",", 
         "bandpass", ",", "dotsize", ",", "max", ",", "th2", ",", "myTrimImg",
          ",", "tempOrigin", ",", "myNewTempCenterList", ",", "tempCenter", 
         ",", "flagFin", ",", "euList", ",", "myTrack", ",", "myIdx", ",", 
         "myFitAllParameters", ",", "myFitPos", ",", "myFitData", ",", 
         "myFit", ",", "myColor", ",", "flagFileName", ",", "myFilename", ",",
          "myTruckNum"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "flagFileName", "=", "\"\<No track is saved in this session\>\""}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myFit", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
           "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Panel", "@", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Spot:        \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"spotType", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"spotType", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"spotType", "=", "#"}]}], "]"}], ")"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "1", "\[Rule]", "\"\<Difraction Limitted Spot\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Blob\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Binarization:           \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"binarizeMethod", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"binarizeMethod", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"binarizeMethod", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Automatic\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<User-defined\>\""}]}], 
                    "}"}]}], "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Channel: \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"trackChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"trackChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"trackChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Display Channel:    \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"dispChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"dispChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"dispChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Trim Size: \>\"", ",", 
                    RowBox[{"Spacer", "[", "45", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "trimPad", "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "3"}]}], "]"}]}], 
                   "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Track Particle\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "=", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "@", "Nimg"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}], "}"}], ",", "Nimg"}], 
                    "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"spotType", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "100"}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1000"}], "}"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"max", ",", "th2"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Re-Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Refill Gaps\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myIdx", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "-", "#1"}], "\[Equal]", "1"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "Nimg"}], "]"}]}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ",", "2", ",", 
                    "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ")"}]}], "*", 
                    "#"}]}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", "myIdx"}], ",", "1"}], "}"}]}], 
                    "]"}], ";"}]}], "]"}]}], 
                   RowBox[{"(*", 
                    RowBox[{",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    "\"\<No Track\>\""}], "]"}]}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track Gauss\>\"", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}]}]}], "}"}], "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}]}], "*)"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete Current Position\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete All Subsequent Positions\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}]}], ";"}]}], "]"}]}], "}"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Gaussian Fit\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"myFit", "=", 
                    RowBox[{"ParticleFitting2", "[", 
                    RowBox[{"myImgRaw", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "myTrack"}], ",", "3"}], "]"}]}], 
                    "}"}]}], "}"}], ",", "trimPad", ",", "avgFrameN"}], 
                    "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ","}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Save Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myColor", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\"\<red\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "2", "}"}]}], ",", "\"\<green\>\"", ",", 
                    "\"\<blue\>\""}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myTrackNum", "=", 
                    RowBox[{"1", "+", 
                    RowBox[{"Length", "@", 
                    RowBox[{"FileNames", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<*_myTrack_\>\"", "<>", "myColor", "<>", 
                    "\"\<*\>\""}], ",", 
                    RowBox[{"DirectoryName", "@", "analysisFolder"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"myFilename", "=", 
                    RowBox[{
                    "\"\<_myTrack_\>\"", "<>", "myColor", "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"ToString", "@", "myTrackNum"}], "<>", 
                    "\"\<.dat\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "myTrackNum"}], "]"}], "&"}], "/@", 
                    "myTrack"}], ")"}], ">>", 
                    RowBox[{"analysisFolder", "<>", "myFilename"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flagFileName", "=", 
                    RowBox[{
                    "\"\<Saved File Name : \>\"", "<>", "myFilename"}]}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", "flagFileName"}]}], "}"}]}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<time points   \>\"", ",", 
                 RowBox[{"Slider", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "myt", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Nimg", ",", "1"}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"600", ",", "20"}], "}"}]}]}], "]"}], " ", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<-\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", ">", "1"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "-", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<+\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", "<", "Nimg"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "+", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Spacer", "[", "10", "]"}], ",", 
                 RowBox[{"Dynamic", "[", "myt", "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"LocatorPane", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "mycurpoints", "]"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}],
                   "]"}], ",", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "+", "20", "-", 
                    "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}]}],
                 "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Spacer", "@", "3"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Yellow", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}], 
                    ",", "4"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "+", "20", "-", "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}]}],
                 "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7168388001647224`*^9, 3.71683883334162*^9}, {
   3.716839082028844*^9, 3.7168391614443865`*^9}, {3.7168393298620195`*^9, 
   3.716839335454339*^9}, {3.716839373916539*^9, 3.7168393764626846`*^9}, 
   3.71683966555122*^9, {3.7168400979099493`*^9, 3.716840153254115*^9}, {
   3.716840224542192*^9, 3.716840239119026*^9}, {3.7168935523053656`*^9, 
   3.716893562503949*^9}, {3.7168940576642704`*^9, 3.7168940650236917`*^9}, {
   3.7168941014087725`*^9, 3.71689411080031*^9}, {3.7168942481301646`*^9, 
   3.7168942542975173`*^9}, {3.71689439229041*^9, 3.716894417553855*^9}, 
   3.7168945363936524`*^9, {3.716894611569952*^9, 3.716894625553752*^9}, {
   3.716894744377548*^9, 3.716894764441696*^9}, 3.716894795376465*^9, {
   3.716894840953072*^9, 3.7168948413850965`*^9}, {3.716894906081797*^9, 
   3.7168950553133326`*^9}, {3.716895087010146*^9, 3.7168950889132547`*^9}, {
   3.716895138994119*^9, 3.7168951419212866`*^9}, {3.716895527874362*^9, 
   3.716895567746642*^9}, {3.7168957632518244`*^9, 3.716895771691307*^9}, {
   3.716895837002043*^9, 3.7168958392191696`*^9}, {3.716895894179313*^9, 
   3.716895933690573*^9}, {3.7168959856735463`*^9, 3.716896009002881*^9}, {
   3.716896048459138*^9, 3.7168961133958516`*^9}, {3.716896435499275*^9, 
   3.716896552626974*^9}, {3.7168965961954665`*^9, 3.7168966636353235`*^9}, 
   3.7168968967406564`*^9, {3.7168969951732864`*^9, 3.716897003571767*^9}, 
   3.7173599520836353`*^9, {3.717437650744745*^9, 3.7174376677057147`*^9}, {
   3.7174377325444236`*^9, 3.7174377344255314`*^9}, {3.717442673174011*^9, 
   3.717442685477715*^9}, {3.717442719365653*^9, 3.7174427617820797`*^9}, {
   3.717515242111717*^9, 3.717515259174693*^9}, 3.717515878791133*^9, {
   3.717515928638984*^9, 3.7175159500952115`*^9}, {3.717516026280569*^9, 
   3.717516073215254*^9}, {3.7175190913628817`*^9, 3.717519102474517*^9}, {
   3.7175191332742786`*^9, 3.71751914623402*^9}, {3.7175192069064903`*^9, 
   3.7175192202502537`*^9}, {3.7175192675549593`*^9, 3.717519273914323*^9}, 
   3.717519694043353*^9, {3.7175284753156133`*^9, 3.71752849099551*^9}, {
   3.7186459457108507`*^9, 3.718645992157507*^9}, {3.718646096302464*^9, 
   3.7186461076941156`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"f02a97c5-692b-4d86-b52d-39ca3775a965"]
}, Closed]],

Cell[CellGroupData[{

Cell["FilterFitOutlier", "Subsection",
 CellChangeTimes->{{3.71629985262469*^9, 3.7162998590880604`*^9}, {
  3.7177712559439316`*^9, 
  3.7177712581020555`*^9}},ExpressionUUID->"05aed639-cd8e-42d5-b3e5-\
5d8bf0f76702"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "removes", " ", "outliers", " ", "based", 
     " ", "on", " ", "intensity"}], ",", " ", 
    RowBox[{
    "90", "%", " ", "confidence", " ", "interval", " ", "of", " ", "xy", " ", 
     "positions", " ", "and", " ", "the", " ", "size", " ", "of", " ", 
     "sigma"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FilterFitOutlier", "[", 
    RowBox[{"mySpotsFit_", ",", "maxDxy_", ",", "maxSig_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "idxInt", ",", "idxX90Conf", ",", "idxY90Conf", ",", "idxSigX", ",", 
       "idxSigY", ",", "idxOutliers"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idxInt", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "2", ",", "1"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"x", "<", "0"}], "||", 
           RowBox[{"x", ">", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idxX90Conf", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Differences", "/@", "#"}], "&"}], "/@", 
            RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "5", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "maxDxy"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxY90Conf", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Differences", "/@", "#"}], "&"}], "/@", 
            RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "5", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "maxDxy"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxSigX", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "3", ",", "1"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Abs", "@", "x"}], ">", "maxSig"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxSigY", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "3", ",", "2"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Abs", "@", "x"}], ">", "maxSig"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxOutliers", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
        "idxInt", ",", "idxX90Conf", ",", "idxY90Conf", ",", "idxSigX", ",", 
         "idxSigY"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", 
       RowBox[{"mySpotsFit", ",", "idxOutliers"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7163079773033953`*^9, 3.7163080736239047`*^9}, {
  3.716308283583914*^9, 3.7163083117995276`*^9}, {3.7163083677277265`*^9, 
  3.7163083737850733`*^9}, {3.7175241617528915`*^9, 3.7175241618648977`*^9}, {
  3.7175242033692713`*^9, 3.717524205240379*^9}, {3.7175242379372487`*^9, 
  3.717524239273325*^9}, {3.7175250840096416`*^9, 3.7175250850256996`*^9}, {
  3.717771260303181*^9, 3.7177712633193536`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"e2591b70-619e-41a7-a6f9-cda3bab1a0d8"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpotLocationOnCell", "Subsection",
 CellChangeTimes->{{3.716315153980878*^9, 
  3.716315185436677*^9}},ExpressionUUID->"6da35232-a8e0-4082-a236-\
1228e9f73ea9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "to", " ", "show", " ", "cell", " ", "movie", " ", "with",
     " ", "tracked", " ", "spot", " ", "positions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SpotLocationOnCell", "[", 
    RowBox[{
    "myColMovie_", ",", "thred_", ",", "redSpots_", ",", "thgreen_", ",", 
     "greenSpots_", ",", "thblue_", ",", "blueSpots_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"th", ",", "colCircle", ",", "spots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"color", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"th", "=", "thred"}], ";", 
           RowBox[{"colCircle", "=", "Red"}], ";", 
           RowBox[{"spots", "=", "redSpots"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"color", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{"th", "=", "thgreen"}], ";", 
             RowBox[{"colCircle", "=", "Green"}], ";", 
             RowBox[{"spots", "=", "greenSpots"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"th", "=", "thblue"}], ";", 
             RowBox[{"colCircle", "=", "Blue"}], ";", 
             RowBox[{"spots", "=", "blueSpots"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ImageAdjust", "[", 
           RowBox[{
            RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
             RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "th"}], "]"}], 
          ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"colCircle", ",", 
               RowBox[{"Circle", "[", 
                RowBox[{"#", ",", "7"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{
            "spots", "\[LeftDoubleBracket]", "frame", 
             "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"color", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
           RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"frame", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myColMovie", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"RadioButtonBar", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716315179996366*^9, 3.7163153405015464`*^9}, {
  3.716560508065325*^9, 3.7165605535859284`*^9}, {3.717941332702766*^9, 
  3.7179413338548317`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"251715b3-d8bf-4edd-9387-b0ae059f7cb0"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShiftingDataPoints", "Subsection",
 CellChangeTimes->{{3.716560254248807*^9, 
  3.7165602596331153`*^9}},ExpressionUUID->"af1d4fe6-9a4d-4736-a9ed-\
b3886f5709a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "function", " ", "to", " ", "shift", " ", "dataset", " ", "using", " ", 
     RowBox[{"offset", ".", " ", "The"}], " ", "data", " ", "first", " ", 
     "get", " ", "interpolated", " ", "linearly"}], ",", " ", "shifted", ",", 
    " ", 
    RowBox[{"and", " ", "then", " ", "resampled"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ShiftingDataPointsMin", "[", 
    RowBox[{
    "myData_", ",", "myOffset_", ",", "myResolution_", ",", "flagFill_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myDataInterpolFunc", ",", "myDataInterpol", ",", "myDataResample", ",",
        "myStart", ",", "myFillSize"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myDataInterpolFunc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"#", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "/@",
         "myData"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myDataInterpol", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"#", ",", 
           RowBox[{"1", "+", 
            RowBox[{"myResolution", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{
                "myData", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "@", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
        "myDataInterpolFunc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myStart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", 
            RowBox[{"Min", "@", "#"}]}], ")"}], "+", "1"}], "&"}], "@", 
        RowBox[{"Round", "@", 
         RowBox[{"(", 
          RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"myDataInterpol", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{
            "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             ";;"}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "myDataInterpol"}], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"myDataResample", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{";;", "All", ";;", "myResolution"}]}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flagFill", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myFillSize", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "@", "#"}], "-", "#"}], "&"}], "@", 
           RowBox[{"(", 
            RowBox[{"Length", "/@", "myDataResample"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myDataResample", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                "myDataResample", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                  "myFillSize", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "myDataResample"}], ",", "1"}], "}"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "myDataResample"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7165605573051414`*^9, 3.716560608545072*^9}, {
  3.716561843233692*^9, 3.716561867770096*^9}, {3.7165619129386787`*^9, 
  3.7165619648906507`*^9}, {3.716562014898511*^9, 3.7165620674995193`*^9}, {
  3.7165622401223927`*^9, 3.71656230388504*^9}, {3.719179697118103*^9, 
  3.719179697448122*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"20f493cd-1eb0-42d6-b204-70304a008f8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "function", " ", "to", " ", "shift", " ", "dataset", " ", "using", " ", 
     RowBox[{"offset", ".", " ", "The"}], " ", "data", " ", "first", " ", 
     "get", " ", "interpolated", " ", "linearly"}], ",", " ", "shifted", ",", 
    " ", 
    RowBox[{"and", " ", "then", " ", "resampled"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ShiftingDataPointsMean", "[", 
    RowBox[{
    "myData_", ",", "myOffset_", ",", "myResolution_", ",", "flagFill_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myDataInterpolFunc", ",", "myDataInterpol", ",", "myDataResample", ",",
        "myStart", ",", "myFillSize"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myDataInterpolFunc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"#", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "/@",
         "myData"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"myDataInterpol", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "+", 
              RowBox[{"myResolution", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{
                  "myData", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Length", "@", 
                RowBox[{
                "myData", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
          "myDataInterpolFunc"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myDataInterpol", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
           "myDataInterpolFunc", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"1", "+", 
            RowBox[{"myResolution", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{
                "myData", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "@", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"myStart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "@", 
             RowBox[{"Mean", "@", "#"}]}]}], ")"}], "+", "1"}], "&"}], "@", 
        RowBox[{"Round", "@", 
         RowBox[{"(", 
          RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             "<", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{
               "myDataInterpol", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{
                  RowBox[{"Abs", "@", 
                   RowBox[{
                   "myStart", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}]}], "]"}]}], "]"}],
              ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"myDataInterpol", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
              "myStart", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ";;"}]}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "myDataInterpol"}], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"myDataResample", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{";;", "All", ";;", "myResolution"}]}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flagFill", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myFillSize", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "@", "#"}], "-", "#"}], "&"}], "@", 
           RowBox[{"(", 
            RowBox[{"Length", "/@", "myDataResample"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myDataResample", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "myDataResample", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "}"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                  "myFillSize", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "myDataResample"}], ",", "1"}], "}"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "myDataResample"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7165605573051414`*^9, 3.716560608545072*^9}, {
  3.716561843233692*^9, 3.716561867770096*^9}, {3.7165619129386787`*^9, 
  3.7165619648906507`*^9}, {3.716562014898511*^9, 3.7165620674995193`*^9}, {
  3.7165622401223927`*^9, 3.71656230388504*^9}, {3.719179683469322*^9, 
  3.7191797314300656`*^9}, {3.719179788574334*^9, 3.719179792402553*^9}, {
  3.7191798644536743`*^9, 3.719179906585084*^9}, {3.719179950272583*^9, 
  3.7191799523847036`*^9}, {3.7191799877867284`*^9, 3.7191800430728903`*^9}, {
  3.7191811621428976`*^9, 3.7191811691833005`*^9}, {3.7191812719011755`*^9, 
  3.719181400047505*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"b3635c1a-e6b7-4ff0-9db2-4da7186095f2"],

Cell[CellGroupData[{

Cell[BoxData["myAllBlueNum"], "Input",
 CellChangeTimes->{{3.719180074599694*^9, 3.7191800776318674`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"ac2bac5e-94bb-4b07-9cbb-d8d0b523f6b2"],

Cell[BoxData["myAllBlueNum"], "Output",
 CellChangeTimes->{3.7191800780388904`*^9, 3.7192753228915844`*^9, 
  3.770033856044629*^9, 3.770051848328209*^9, 3.770383423404255*^9, 
  3.770575079992008*^9, 3.770585695290124*^9, 3.770659963089489*^9, 
  3.7707332100490475`*^9, 3.7711816301192026`*^9, 3.771187190914667*^9, 
  3.7730759675378003`*^9, 3.7735922362498646`*^9, 3.7735945409460154`*^9, 
  3.7735999858434443`*^9, 3.773600861573422*^9, 3.774357021605279*^9, 
  3.774372646362464*^9, 3.7743752364195213`*^9, 3.776698810881424*^9, 
  3.7766992152696238`*^9, 3.776799630566327*^9, 3.7780025865413*^9, 
  3.779734934625207*^9, 3.7797367031431837`*^9, 3.7802356113961535`*^9, 
  3.780235673774523*^9, 3.801444299370466*^9, 3.8066831507424636`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"82f79d86-e302-4221-98b1-dbcccd738e89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShiftingDataPointsMin", "[", 
  RowBox[{"myAllBlueNum", ",", "myOffset", ",", "10", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7191801413095093`*^9, 3.7191801424475746`*^9}, {
  3.719180303829805*^9, 3.7191803089981003`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"b51d076a-0b00-4264-9992-5cbeb9d246c6"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.719180143055609*^9, {3.7191803061819396`*^9, 3.7191803093571215`*^9}, 
   3.719275322900585*^9, 3.77003385606463*^9, 3.770051848328209*^9, 
   3.7703834234222555`*^9, 3.770575079992008*^9, 3.770585695316101*^9, 
   3.770659963118412*^9, 3.770733210080307*^9, 3.771181630137124*^9, 
   3.771187190932619*^9, 3.773075967556799*^9, 3.773592236267826*^9, 
   3.773594540961604*^9, 3.773599985859064*^9, 3.773600861589043*^9, 
   3.774357021620886*^9, 3.774372646378083*^9, 3.774375236435115*^9, 
   3.7766988108970757`*^9, 3.776699215285265*^9, 3.776799630592256*^9, 
   3.7780025865602503`*^9, 3.7797349346431584`*^9, 3.7797367031640987`*^9, 
   3.7802356116646476`*^9, 3.780235673790172*^9, 3.8014442994064198`*^9, 
   3.8066831514492598`*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"28ae79f9-455e-41d8-9bf0-0453e663e231"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShiftingDataPointsMean", "[", 
  RowBox[{"myAllBlueNum", ",", "myOffset", ",", "10", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7191800920226903`*^9, 3.7191801038313656`*^9}, {
  3.719180266734683*^9, 3.719180273886092*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"b23294e1-679d-4627-a8b4-937b1f7b4db9"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7191801046694136`*^9, {3.7191802686637936`*^9, 3.7191802742191114`*^9}, 
   3.7191811789278574`*^9, 3.719181244954634*^9, 3.719181406637882*^9, 
   3.7192753229105854`*^9, 3.770033856072631*^9, 3.770051848343809*^9, 
   3.770383423442257*^9, 3.7705750800076084`*^9, 3.770585695356944*^9, 
   3.770659963135417*^9, 3.77073321009592*^9, 3.7711816301540794`*^9, 
   3.7711871909506035`*^9, 3.7730759675756974`*^9, 3.773592236284772*^9, 
   3.7735945409772267`*^9, 3.7735999858746853`*^9, 3.773600861620286*^9, 
   3.774357021636521*^9, 3.7743726463936768`*^9, 3.774375236466358*^9, 
   3.776698810934832*^9, 3.776699215316475*^9, 3.776799630616192*^9, 
   3.7780025865792*^9, 3.779734934662136*^9, 3.7797367031840725`*^9, 
   3.7802356118565817`*^9, 3.7802356738279505`*^9, 3.801444299494278*^9, 
   3.8066831516158147`*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"8ed45768-70e3-45c5-8a64-254541bda5bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "-", 
       RowBox[{"Round", "@", 
        RowBox[{"Mean", "@", "#"}]}]}], ")"}], "+", "1"}], "&"}], "@", 
   RowBox[{"Round", "@", 
    RowBox[{"(", 
     RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.719179582229532*^9, 3.7191795903429956`*^9}, {
  3.7191796645742416`*^9, 3.719179665504295*^9}, {3.7191801959186325`*^9, 
  3.7191801962156496`*^9}, {3.719180399238262*^9, 3.7191803998402967`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"b765382c-0285-4a4a-8585-621aee182f0d"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"Round", "[", 
   RowBox[{"10", " ", "myOffset"}], "]"}], "-", 
  RowBox[{"Round", "[", 
   RowBox[{"Mean", "[", 
    RowBox[{"Round", "[", 
     RowBox[{"10", " ", "myOffset"}], "]"}], "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.719179587760848*^9, 3.71917959076902*^9}, 
   3.719179665886317*^9, 3.7191801966906767`*^9, 3.7191804002473197`*^9, 
   3.719275322919586*^9, 3.7700338561038303`*^9, 3.770051848343809*^9, 
   3.770383423461258*^9, 3.7705750800076084`*^9, 3.7705856953823957`*^9, 
   3.770659963163322*^9, 3.770733210120816*^9, 3.7711816301710634`*^9, 
   3.7711871909685545`*^9, 3.7730759675956454`*^9, 3.773592236300729*^9, 
   3.7735945409928513`*^9, 3.773599985890308*^9, 3.7736008616424522`*^9, 
   3.774357021652116*^9, 3.77437264640933*^9, 3.7743752364819784`*^9, 
   3.7766988109660783`*^9, 3.77669921534772*^9, 3.7767996306391582`*^9, 
   3.778002586596182*^9, 3.7797349346790648`*^9, 3.7797367032040215`*^9, 
   3.7802356120142684`*^9, 3.780235673843569*^9, 3.8014442995262337`*^9, 
   3.806683151712557*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"ed82752c-9453-4f36-b3eb-d35f59cdaebc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myData", "=", "myAllBlueNum"}], ";"}]], "Input",
 CellChangeTimes->{{3.719180438472506*^9, 3.719180459119687*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"96de9f6d-8637-4732-8886-bdb481e00ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myDataInterpolFunc", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"#", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "/@", 
    "myData"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7191804712213793`*^9, 3.7191804737265224`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"fe7566b6-5b81-45e2-a971-c3fe890e3681"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myDataInterpol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"#", ",", 
       RowBox[{"1", "+", 
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{
            "myData", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myData", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
    "myDataInterpolFunc"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7191804803899035`*^9, 3.719180491302528*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"3ea3a148-f01c-4333-a301-501a178f55ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myStart", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "-", 
       RowBox[{"Round", "@", 
        RowBox[{"Mean", "@", "#"}]}]}], ")"}], "+", "1"}], "&"}], "@", 
   RowBox[{"Round", "@", 
    RowBox[{"(", 
     RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7191805015741153`*^9, 3.7191805059663663`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"3309a44e-c280-4a6f-8986-bd4af09f3331"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"Round", "[", 
   RowBox[{"10", " ", "myOffset"}], "]"}], "-", 
  RowBox[{"Round", "[", 
   RowBox[{"Mean", "[", 
    RowBox[{"Round", "[", 
     RowBox[{"10", " ", "myOffset"}], "]"}], "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7191805019321356`*^9, 3.719180506498397*^9}, 
   3.7192753229485874`*^9, 3.770033856168231*^9, 3.770051848376009*^9, 
   3.7703834235272617`*^9, 3.7705750800388083`*^9, 3.770585695476037*^9, 
   3.7706599632201405`*^9, 3.7707332101876664`*^9, 3.7711816302338967`*^9, 
   3.7711871910333505`*^9, 3.7730759676654587`*^9, 3.7735922363655553`*^9, 
   3.773594541055332*^9, 3.7735999859684134`*^9, 3.7736008617201366`*^9, 
   3.774357021717017*^9, 3.7743726464561925`*^9, 3.774375236560113*^9, 
   3.7766988110663424`*^9, 3.7766992154414454`*^9, 3.776799630722907*^9, 
   3.778002586658986*^9, 3.779734934782817*^9, 3.779736703270812*^9, 
   3.780235612139239*^9, 3.780235673993474*^9, 3.801444299658087*^9, 
   3.8066831518521805`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"2e1be8be-398b-410b-82b2-01fd027ec068"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myDataResample", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{
           "myDataInterpol", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{
               "myStart", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "+", "1"}]}], "]"}]}], "]"}], 
         ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"myDataInterpol", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{
          "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ";;"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "myDataInterpol"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7191805189151073`*^9, 3.719180548408794*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"3f734ecf-f2e4-48bb-84c5-8677c5f84473"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"myDataResample", "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", 
    RowBox[{";;", "All", ";;", "10"}]}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.719180590590207*^9, 3.7191805950374613`*^9}, {
  3.7191806311665277`*^9, 3.719180647382455*^9}, {3.7191809433513837`*^9, 
  3.71918094433644*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"39c797b8-d7cb-48db-a8b1-11268c4b8e70"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7191805953744802`*^9, {3.7191806317475605`*^9, 3.719180647763477*^9}, 
   3.719180944709461*^9, 3.7192753229645886`*^9, 3.7700338562150307`*^9, 
   3.770051848376009*^9, 3.7703834235602636`*^9, 3.770575080054408*^9, 
   3.7705856955249066`*^9, 3.7706599632521095`*^9, 3.770733210221545*^9, 
   3.7711816302937107`*^9, 3.77118719106742*^9, 3.7730759677053533`*^9, 
   3.7735922364016523`*^9, 3.773594541088261*^9, 3.773599986015277*^9, 
   3.7736008617513804`*^9, 3.77435702174829*^9, 3.7743726464868*^9, 
   3.774375236591328*^9, 3.7766988111197076`*^9, 3.776699215488336*^9, 
   3.7767996307647977`*^9, 3.7780025867021284`*^9, 3.779734934822708*^9, 
   3.7797367033117027`*^9, 3.7802356122044306`*^9, 3.780235674028079*^9, 
   3.8014442997259984`*^9, 3.8066831519479237`*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"59d1e897-7c50-4ae9-9032-8c9d66b20ddd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myFillSize", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Max", "@", "#"}], "-", "#"}], "&"}], "@", 
   RowBox[{"(", 
    RowBox[{"Length", "/@", "test"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7191809637905526`*^9, 3.7191809659096737`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"772bfdd8-6fa7-417a-ae26-756b2ffb9457"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7191809663016963`*^9, 3.7192753229725895`*^9, 
  3.770033856230631*^9, 3.7700518483916087`*^9, 3.7703834235812645`*^9, 
  3.770575080054408*^9, 3.7705856955508814`*^9, 3.7706599632700596`*^9, 
  3.7707332102385416`*^9, 3.7711816303156757`*^9, 3.77118719108537*^9, 
  3.7730759677253733`*^9, 3.7735922364176087`*^9, 3.773594541103883*^9, 
  3.7735999860309*^9, 3.773600861757886*^9, 3.7743570217639112`*^9, 
  3.774372646502454*^9, 3.774375236618101*^9, 3.7766988111509547`*^9, 
  3.776699215519554*^9, 3.776799630788732*^9, 3.7780025867260637`*^9, 
  3.7797349348436527`*^9, 3.7797367033296547`*^9, 3.780235612235675*^9, 
  3.780235674059348*^9, 3.8014442997579207`*^9, 3.806683151960889*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"27b6265c-deb0-4dce-8e68-82c29dff5b05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myDataResample", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "test", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "}"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{
          "myFillSize", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "test"}], ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.719180990174062*^9, 3.719181003766839*^9}, {
  3.7191811294150257`*^9, 3.7191811316221523`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"fbec1b03-41a2-4f89-a9e3-2f1167cc0deb"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7191810043928747`*^9, 3.719181132144182*^9, 
  3.7192753229815893`*^9, 3.7700338562472315`*^9, 3.7700518483916087`*^9, 
  3.770383423601266*^9, 3.7705750800700083`*^9, 3.7705856955897846`*^9, 
  3.7706599632870126`*^9, 3.7707332102555246`*^9, 3.7711816303326187`*^9, 
  3.7711871911033196`*^9, 3.773075967745249*^9, 3.7735922364355607`*^9, 
  3.77359454112331*^9, 3.7735999860465198`*^9, 3.77360086177351*^9, 
  3.774357021779533*^9, 3.7743726465336957`*^9, 3.7743752366336937`*^9, 
  3.7766988111821966`*^9, 3.776699215550798*^9, 3.7767996308136635`*^9, 
  3.7780025867460155`*^9, 3.7797349348645663`*^9, 3.779736703348605*^9, 
  3.780235612286766*^9, 3.7802356740905643`*^9, 3.8014442997858887`*^9, 
  3.8066831520307045`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"40702cd9-0a93-41fe-9709-86fc9dfef1ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConstantArray", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ","}], "]"}]], "Input",
 CellChangeTimes->{{3.7191810874156237`*^9, 3.7191810930729475`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"0edbd7d1-cb5c-49f4-9e93-e3146aecceca"],

Cell[BoxData[
 TemplateBox[{
  "ConstantArray", "ilsmn", 
   "\"Single or list of non-negative machine-sized integers expected at \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"ConstantArray\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
\\\"}\\\"}], \\\",\\\", \\\"Null\\\"}], \\\"]\\\"}]\\).\"", 2, 130, 11, 
   21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.719275323011591*^9, 3.770033856278431*^9, 
  3.770051848454009*^9, 3.7703834236192675`*^9, 3.7705750801012087`*^9, 
  3.770585695614388*^9, 3.770659963304942*^9, 3.770733210274404*^9, 
  3.771181630350582*^9, 3.77118719112224*^9, 3.773075967765235*^9, 
  3.7735922364924088`*^9, 3.7735945411657963`*^9, 3.773599986109005*^9, 
  3.773600861789133*^9, 3.774357021810773*^9, 3.774372646564917*^9, 
  3.774375236649315*^9, 3.7766988112980585`*^9, 3.7766992155820646`*^9, 
  3.7767996313961124`*^9, 3.7780025868128366`*^9, 3.7797349349343805`*^9, 
  3.7797367033975058`*^9, 3.780235612326711*^9, 3.7802356741126904`*^9, 
  3.801444299817844*^9, 3.806683152114478*^9},
 CellLabel->
  "During evaluation of \
In[130]:=",ExpressionUUID->"c2ac2155-1933-478d-a227-0d4ac3b5e4b6"],

Cell[BoxData[
 RowBox[{"ConstantArray", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "Null"}], "]"}]], "Output",
 CellChangeTimes->{3.7192753230305924`*^9, 3.770033856278431*^9, 
  3.770051848454009*^9, 3.7703834236212673`*^9, 3.7705750801012087`*^9, 
  3.77058569561738*^9, 3.7706599633069344`*^9, 3.770733210277396*^9, 
  3.7711816303525486`*^9, 3.771187191124273*^9, 3.7730759677672234`*^9, 
  3.773592236494404*^9, 3.7735945411814284`*^9, 3.773599986109005*^9, 
  3.7736008618047533`*^9, 3.774357021810773*^9, 3.774372646564917*^9, 
  3.774375236649315*^9, 3.7766988112980585`*^9, 3.7766992155820646`*^9, 
  3.776799631414072*^9, 3.7780025868148327`*^9, 3.7797349349364023`*^9, 
  3.7797367034009204`*^9, 3.7802356123307047`*^9, 3.7802356741126904`*^9, 
  3.8014442998218384`*^9, 3.806683152120463*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"d8f3eef4-638f-4836-9f31-5222f60be3dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"test", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}],
       "}"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{
       "myFillSize", "\[LeftDoubleBracket]", "10", 
        "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.719181021471852*^9, 3.719181039160864*^9}, {
  3.719181108247815*^9, 3.7191811206005216`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"21f759d0-4589-471a-bfb6-3c9d542f706f"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"10\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \\\
\"}\\\"}]\\) does not exist.\"", 2, 131, 12, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.719275323051594*^9, 3.770033856294031*^9, 
  3.7700518485008087`*^9, 3.7703834236402683`*^9, 3.7705750801168084`*^9, 
  3.770585695643344*^9, 3.770659963323862*^9, 3.770733210304324*^9, 
  3.771181630369539*^9, 3.771187191143211*^9, 3.7730759677861347`*^9, 
  3.7735922365113583`*^9, 3.773594541197042*^9, 3.773599986124627*^9, 
  3.7736008618203754`*^9, 3.7743570218263764`*^9, 3.774372646576378*^9, 
  3.7743752366805916`*^9, 3.7766988113358374`*^9, 3.77669921561331*^9, 
  3.7767996315367303`*^9, 3.7780025868307896`*^9, 3.779734934955325*^9, 
  3.779736703416848*^9, 3.7802356123666573`*^9, 3.7802356741492653`*^9, 
  3.80144429985779*^9, 3.8066831521832943`*^9},
 CellLabel->
  "During evaluation of \
In[131]:=",ExpressionUUID->"a0a9d929-e0a0-49ae-ab2f-27d02553e422"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"10\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \\\
\"}\\\"}]\\) does not exist.\"", 2, 131, 13, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.719275323051594*^9, 3.770033856294031*^9, 
  3.7700518485008087`*^9, 3.7703834236402683`*^9, 3.7705750801168084`*^9, 
  3.770585695643344*^9, 3.770659963323862*^9, 3.770733210304324*^9, 
  3.771181630369539*^9, 3.771187191143211*^9, 3.7730759677861347`*^9, 
  3.7735922365113583`*^9, 3.773594541197042*^9, 3.773599986124627*^9, 
  3.7736008618203754`*^9, 3.7743570218263764`*^9, 3.774372646576378*^9, 
  3.7743752366805916`*^9, 3.7766988113358374`*^9, 3.77669921561331*^9, 
  3.7767996315367303`*^9, 3.7780025868307896`*^9, 3.779734934955325*^9, 
  3.779736703416848*^9, 3.7802356123666573`*^9, 3.7802356741492653`*^9, 
  3.80144429985779*^9, 3.806683152189288*^9},
 CellLabel->
  "During evaluation of \
In[131]:=",ExpressionUUID->"3f5e5c5f-0669-4291-8f0c-5bbc58de7f53"],

Cell[BoxData[
 TemplateBox[{
  "ConstantArray", "ilsmn", 
   "\"Single or list of non-negative machine-sized integers expected at \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"ConstantArray\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
\\\"}\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"10\\\", \\\"\[RightDoubleBracket]\\\"}]}], \
\\\"]\\\"}]\\).\"", 2, 131, 14, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.719275323051594*^9, 3.770033856294031*^9, 
  3.7700518485008087`*^9, 3.7703834236402683`*^9, 3.7705750801168084`*^9, 
  3.770585695643344*^9, 3.770659963323862*^9, 3.770733210304324*^9, 
  3.771181630369539*^9, 3.771187191143211*^9, 3.7730759677861347`*^9, 
  3.7735922365113583`*^9, 3.773594541197042*^9, 3.773599986124627*^9, 
  3.7736008618203754`*^9, 3.7743570218263764`*^9, 3.774372646576378*^9, 
  3.7743752366805916`*^9, 3.7766988113358374`*^9, 3.77669921561331*^9, 
  3.7767996315367303`*^9, 3.7780025868307896`*^9, 3.779734934955325*^9, 
  3.779736703416848*^9, 3.7802356123666573`*^9, 3.7802356741492653`*^9, 
  3.80144429985779*^9, 3.806683152192271*^9},
 CellLabel->
  "During evaluation of \
In[131]:=",ExpressionUUID->"678d8f4f-d06f-4b0e-af9e-30fccd5f7a20"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "10", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "10", 
      "\[RightDoubleBracket]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7191810396638927`*^9, {3.7191811113849945`*^9, 3.719181121031546*^9}, 
   3.7192753231005964`*^9, 3.770033856294031*^9, 3.770051848532009*^9, 
   3.770383423646269*^9, 3.7705750801324086`*^9, 3.770585695649294*^9, 
   3.770659963328849*^9, 3.7707332103083143`*^9, 3.77118163038546*^9, 
   3.771187191149168*^9, 3.773075967790124*^9, 3.773592236516345*^9, 
   3.7735945412126594`*^9, 3.7735999861402473`*^9, 3.7736008618203754`*^9, 
   3.774357022123171*^9, 3.7743726465905685`*^9, 3.774375236689355*^9, 
   3.7766988114139414`*^9, 3.77669921561331*^9, 3.776799631596596*^9, 
   3.7780025868357763`*^9, 3.77973493496031*^9, 3.7797367034228315`*^9, 
   3.7802356123786416`*^9, 3.7802356741572523`*^9, 3.801444299869774*^9, 
   3.806683152195263*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"9b283026-81a1-4b85-8ca8-ee6f5ef4604e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myDataResample", "\[LeftDoubleBracket]", "10", 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.719180521905278*^9, 3.7191805658947945`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"209f364c-34e6-49a6-9a84-ca1511fceb70"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"10\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \\\
\"}\\\"}]\\) does not exist.\"", 2, 132, 15, 21656097636267026757, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7192753231095967`*^9, 3.7700338563096313`*^9, 
  3.770051848532009*^9, 3.7703834236642694`*^9, 3.7705750801334085`*^9, 
  3.770585695674227*^9, 3.7706599633448067`*^9, 3.7707332103242702`*^9, 
  3.771181630401449*^9, 3.771187191166608*^9, 3.773075967809074*^9, 
  3.7735922365303073`*^9, 3.77359454122828*^9, 3.7735999861558685`*^9, 
  3.7736008618359957`*^9, 3.7743570221856565`*^9, 3.774372646591572*^9, 
  3.7743752367080555`*^9, 3.7766988114361362`*^9, 3.776699215675765*^9, 
  3.776799631617547*^9, 3.7780025868627043`*^9, 3.779734934978294*^9, 
  3.7797367034408245`*^9, 3.780235612419443*^9, 3.7802356741890388`*^9, 
  3.801444299901731*^9, 3.806683152208228*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"623b0101-4b5a-47fb-b96a-2f71113ee366"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "10", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.7191805337029533`*^9, 3.719180578008487*^9}, 
   3.719275323125598*^9, 3.7700338563252316`*^9, 3.7700518485476093`*^9, 
   3.77038342366627*^9, 3.7705750801334085`*^9, 3.7705856956772203`*^9, 
   3.7706599633468237`*^9, 3.7707332103262763`*^9, 3.7711816304034433`*^9, 
   3.771187191168603*^9, 3.7730759678130927`*^9, 3.773592236533307*^9, 
   3.77359454122828*^9, 3.7735999861714897`*^9, 3.7736008618359957`*^9, 
   3.7743570221856565`*^9, 3.774372646607195*^9, 3.7743752367080555`*^9, 
   3.7766988114361362`*^9, 3.776699215675765*^9, 3.7767996316225014`*^9, 
   3.7780025868646984`*^9, 3.779734934980298*^9, 3.7797367034437747`*^9, 
   3.780235612423439*^9, 3.7802356741890388`*^9, 3.801444299905753*^9, 
   3.8066831522122173`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"9b433462-a225-4288-8c1a-de3896e567db"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["MyCropMaker", "Subsection",
 CellChangeTimes->{{3.7700623148358955`*^9, 
  3.77006231701402*^9}},ExpressionUUID->"77d9164b-9545-42ca-90b1-\
ca3a3955caa5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCropMaker", "[", 
   RowBox[{
   "myColMovie_", ",", "myRNAtracks_", ",", "pad_", ",", "analysisFolder_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myTfFunc", ",", "avgFrameN", ",", "myCrops", ",", "tempTime", ",", 
      "tempCenter", ",", "tempCenterColReg", ",", "tempRed", ",", "tempGreen",
       ",", "tempBlue", ",", "myCropsAvg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myTfFunc", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<TransformationFunction.m\>\"", ",", 
           RowBox[{"ParentDirectory", "@", 
            RowBox[{"DirectoryName", "@", "analysisFolder"}]}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<*avgFrameN*\>\"", ",", 
           RowBox[{"DirectoryName", "@", "analysisFolder"}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myCrops", "=", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempTime", "=", 
            RowBox[{"myRNAtracks", "\[LeftDoubleBracket]", 
             RowBox[{"track", ",", "frame", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenter", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myRNAtracks", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame", ",", "3", ",", "1"}], 
              "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"tempCenterColReg", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myTfFunc", "@", 
              RowBox[{"myRNAtracks", "\[LeftDoubleBracket]", 
               RowBox[{"track", ",", "frame", ",", "3", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}], 
            "=", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenter", "-", "pad"}], ",", 
                  RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                  RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                 "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"3", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                  RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                 "}"}]}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"{", 
            RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myRNAtracks", "\[LeftDoubleBracket]", "track", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"track", ",", "1", ",", 
          RowBox[{"Length", "@", "myRNAtracks"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myCrops", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<_Crops.m\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsAvg", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "/@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "/@", "myCrops"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myCropsAvg", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<_Crops_AVG.m\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"myCrops", ",", "myCropsAvg"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.770061372235982*^9, 3.7700614588589363`*^9}, {
   3.7700615868472567`*^9, 3.7700616476927366`*^9}, {3.770061695371464*^9, 
   3.7700617288113766`*^9}, 3.770061791345953*^9, {3.7700619982097855`*^9, 
   3.7700620066472683`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"2ba8d386-1ae2-463c-a8a1-67e497491363"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyAutoCategorization", "Subsection",
 CellChangeTimes->{{3.7700634137497497`*^9, 
  3.7700634182230053`*^9}},ExpressionUUID->"6ced526a-ebf7-4b33-8a7e-\
e99105ba7b65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyAutoCategorization", "[", 
   RowBox[{
   "myCropsAvg_", ",", "myRNAtracks_", ",", "lowpass_", ",", "highpass_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myCropsAvgBandPass", ",", "myCropsAvgBinari", ",", 
      "myCropsAvgBinariSort", ",", "myCropsAvgBinariData", ",", 
      "myCropsAvgBinariDataDigital", ",", "idx1", ",", "idx2", ",", "idx3", 
      ",", "idx4", ",", "idx", ",", "myAvgCropsCategorized", ",", 
      "myRNAtracksCategorized"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myCropsAvgBandPass", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BandPass", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"lowpass", ",", "highpass"}], "}"}]}], "]"}], "&"}], "/@",
          "#"}], "&"}], "/@", "myCropsAvg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myCropsAvgBinari", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Binarize", "/@", "#"}], "&"}], "/@", 
       "myCropsAvgBandPass"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myCropsAvgBinariSort", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"SelectComponents", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#AdjacentBorderCount", "==", "0"}], "&&", 
              RowBox[{"#Count", " ", ">", "3"}]}], "&"}]}], "]"}], "&"}], "/@",
          "#"}], "&"}], "/@", "myCropsAvgBinari"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsAvgBinariData", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ComponentMeasurements", "[", 
             RowBox[{"#", ",", "\"\<Count\>\""}], "]"}], "&"}], "/@", "#"}], 
          "&"}], "/@", "myCropsAvgBinariSort"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myCropsAvgBinariData", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"myCropsAvgBinariData", ",", 
          RowBox[{"{", "}"}]}], "]"}], "//", "Flatten"}], 
       "\[RightDoubleBracket]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", "\[Rule]", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myCropsAvgBinariDataDigital", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Total", "/@", 
         RowBox[{"myCropsAvgBinariData", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
        ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myCropsAvgBinariDataDigital", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "#"}]}], ",", "#"}], "}"}]}], "&"}], "@", 
       RowBox[{"myCropsAvgBinariDataDigital", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"idx1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cases", "[", 
         RowBox[{"myCropsAvgBinariDataDigital", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}], "&&", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}]}]}]}], "]"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cases", "[", 
         RowBox[{"myCropsAvgBinariDataDigital", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ">", "0"}], 
            "&&", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}]}]}]}], "]"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx3", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cases", "[", 
         RowBox[{"myCropsAvgBinariDataDigital", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}], "&&", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ">", 
             "0"}]}]}]}], "]"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx4", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cases", "[", 
         RowBox[{"myCropsAvgBinariDataDigital", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ">", "0"}], 
            "&&", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ">", 
             "0"}]}]}]}], "]"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{"{", 
       RowBox[{"idx1", ",", "idx2", ",", "idx3", ",", "idx4"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myAvgCropsCategorized", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ImageAdjust", "/@", "#"}], "&"}], "/@", "#"}], "&"}], "/@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"myCropsAvg", "\[LeftDoubleBracket]", 
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4", ",", "1"}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myRNAtracksCategorized", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"myRNAtracks", "\[LeftDoubleBracket]", 
         RowBox[{
         "idx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"myAvgCropsCategorized", ",", "myRNAtracksCategorized"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7700626016843023`*^9, 3.770062698488839*^9}, {
  3.770062728707567*^9, 3.770062800867695*^9}, {3.7700629054366755`*^9, 
  3.77006298138402*^9}, {3.7700630132658434`*^9, 3.7700630168380475`*^9}, {
  3.7700637536631913`*^9, 3.7700638451614246`*^9}, {3.7700660083521523`*^9, 
  3.7700660198828115`*^9}, {3.770066066256464*^9, 3.7700660760490246`*^9}, {
  3.7703836152242265`*^9, 3.7703836414317255`*^9}, {3.770383680200943*^9, 
  3.7703836816300244`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"c8989dc6-9cc9-4577-843e-d8b27ba4d99c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyCategoryHandChecker", "Subsection",
 CellChangeTimes->{{3.770129091047276*^9, 
  3.770129107481216*^9}},ExpressionUUID->"58464248-74c7-4dcd-92b2-\
359be56116fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCategoryHandChecker", "[", 
   RowBox[{"myAvgCropsCategorized_", ",", "myRNAtracksCategorized_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myTFidx", ",", "myIdx", ",", "myIdxSplit"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myTFidx", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "True"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myIdx", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{
            "myTFidx", "\[LeftDoubleBracket]", "color", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAvgCropsCategorized", "\[LeftDoubleBracket]", "color", 
              "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"color", ",", "1", ",", 
            RowBox[{"Length", "@", "myAvgCropsCategorized"}], ",", "1"}], 
           "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myIdxSplit", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{";;", "3"}], "\[RightDoubleBracket]"}], "+", "1"}], 
             ",", "1"}], "]"}], ",", "#"}], "}"}]}], "&"}], "@", 
       RowBox[{"Accumulate", "@", 
        RowBox[{"(", 
         RowBox[{"Length", "/@", "myAvgCropsCategorized"}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myDynamicIdx", ",", "myDynamicIdxSplit", ",", "myIdxNomore"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myDynamicIdx", "=", "myIdx"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Column", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Grid", "@", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
               RowBox[{"Thread", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"\"\<Spot \>\"", "<>", 
                    RowBox[{"ToString", "@", "spot"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"spot", ",", "1", ",", 
                    RowBox[{"Length", "@", "myIdx"}], ",", "1"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"myAvgCropsCategorized", ",", "1"}], "]"}], ",", 
                  RowBox[{"Partition", "[", 
                   RowBox[{
                    RowBox[{"Checkbox", "/@", 
                    RowBox[{"ToExpression", "/@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<Dynamic@myDynamicIdx\[LeftDoubleBracket]\>\"", "<>", 
                    RowBox[{"ToString", "@", "spot"}], "<>", "\"\<,\>\"", "<>", 
                    RowBox[{"ToString", "@", "color"}], "<>", 
                    "\"\<\[RightDoubleBracket]\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"color", ",", "1", ",", "3", ",", "1"}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"spot", ",", "1", ",", 
                    RowBox[{"Length", "@", "myDynamicIdx"}], ",", "1"}], 
                    "}"}]}], "]"}]}]}]}], ",", "3"}], "]"}]}], "}"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\>\"", ",", "\"\<R\>\"", ",", "\"\<G\>\"", ",", 
                "\"\<B\>\"", ",", "\"\<R\>\"", ",", "\"\<G\>\"", ",", 
                "\"\<B\>\""}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Done Checking!\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myDynamicIdxSplit", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"myDynamicIdx", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"myIdxSplit", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "1"}], "\[RightDoubleBracket]"}], ";;", 
                   RowBox[{"myIdxSplit", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"color", ",", "1", ",", 
                   RowBox[{"Length", "@", "myIdxSplit"}], ",", "1"}], "}"}]}],
                 "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"myRNAtracksHC", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"myRNAtracksCategorized", "\[LeftDoubleBracket]", 
                  RowBox[{"color", ",", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Equal]", 
                    RowBox[{
                    "myTFidx", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "&"}], "/@", 
                    RowBox[{
                    "myDynamicIdxSplit", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], ",", "True"}], "]"}]}]}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"color", ",", "1", ",", "4", ",", "1"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"myAvgCropsHC", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"myAvgCropsCategorized", "\[LeftDoubleBracket]", 
                  RowBox[{"color", ",", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Equal]", 
                    RowBox[{
                    "myTFidx", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "&"}], "/@", 
                    RowBox[{
                    "myDynamicIdxSplit", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], ",", "True"}], "]"}]}]}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"color", ",", "1", ",", "4", ",", "1"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"myIdxNomore", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Equal]", 
                    RowBox[{
                    "myTFidx", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "&"}], "/@", 
                    RowBox[{
                    "myDynamicIdxSplit", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], ",", "False"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"color", ",", "1", ",", 
                   RowBox[{"Length", "@", "myDynamicIdxSplit"}], ",", "1"}], 
                  "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myDynamicIdxSplit", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "spot"}], "\[RightDoubleBracket]"}],
                     "\[Equal]", 
                    RowBox[{
                    "myTFidx", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "myRNAtracksHC", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    "myRNAtracksHC", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myRNAtracksCategorized", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "spot"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "myAvgCropsHC", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    "myAvgCropsHC", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myAvgCropsCategorized", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "spot"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "@", "myTFidx"}], ",", "1"}], "}"}]}], 
                   "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"spot", ",", 
                    RowBox[{
                    "myIdxNomore", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"color", ",", "1", ",", "4", ",", "1"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myAvgCropsHC", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Last", "/@", 
                  RowBox[{"SortBy", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myRNAtracksHC", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "#", "}"}], "&"}], "/@", 
                    RowBox[{
                    "myAvgCropsHC", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ",", "First"}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"color", ",", "1", ",", "4", ",", "1"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"myRNAtracksHC", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"SortBy", "[", 
                  RowBox[{"#", ",", "First"}], "]"}], "&"}], "/@", 
                "myRNAtracksHC"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"myRNAtracksHC", ">>", 
               RowBox[{"analysisFolder", "<>", "\"\<_myRNAtracksHC.m\>\""}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"myAvgCropsHC", ">>", 
               RowBox[{"analysisFolder", "<>", "\"\<_myAvgCropsHC.m\>\""}]}], 
              ";"}]}], "]"}]}], "}"}]}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7701237752262287`*^9, 3.770123813872439*^9}, {
   3.770123908933876*^9, 3.770123996102862*^9}, {3.7701241156827016`*^9, 
   3.7701241947842255`*^9}, {3.770124467177806*^9, 3.770124472075086*^9}, {
   3.7701245147535267`*^9, 3.7701246400786953`*^9}, {3.7701246725505524`*^9, 
   3.7701246838141966`*^9}, {3.7701247444716663`*^9, 
   3.7701247786746225`*^9}, {3.7701248223881226`*^9, 3.770124915244434*^9}, 
   3.770124965419304*^9, 3.770125618912681*^9, {3.7701258517720003`*^9, 
   3.7701258773554635`*^9}, {3.770125921739002*^9, 3.77012592205902*^9}, {
   3.7701259955452237`*^9, 3.770125999412445*^9}, {3.7701265538681574`*^9, 
   3.770126587684092*^9}, {3.7701287237662687`*^9, 3.7701287321017456`*^9}, {
   3.7701289482481084`*^9, 3.7701289970619*^9}, {3.770129100890839*^9, 
   3.7701291023099203`*^9}, {3.7703971823712225`*^9, 3.7703971855884066`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"8b2c2e83-d9c4-4082-9883-686125fcf6d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyCategorizedTrackFitter", "Subsection",
 CellChangeTimes->{{3.770138699728861*^9, 
  3.77013871124152*^9}},ExpressionUUID->"0cce9ee1-607d-4dfc-9512-\
515965c88d35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCategorizedTrackFitter", "[", 
   RowBox[{
   "myRNAtracksHC_", ",", "myColMovie_", ",", "analysisFolder_", ",", 
    "sigma_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRNAtracksHCColReg", ",", "myTfFunc", ",", "avgFrameN", ",", 
      "myRedfitsR", ",", "myRedfitsY", ",", "myRedfitsP", ",", "myRedfitsW", 
      ",", "myGreenfitsY", ",", "myGreenfitsW", ",", "myBluefitsP", ",", 
      "myBluefitsW", ",", "myAllfits"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myRNAtracksHCColReg", "=", "myRNAtracksHC"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myTfFunc", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParentDirectory", "@", 
          RowBox[{"DirectoryName", "@", "analysisFolder"}]}], "<>", 
         "\"\</TransformationFunction.m\>\""}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myRNAtracksHCColReg", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "All", ",", "3", ",", "1"}], 
       "\[RightDoubleBracket]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"myTfFunc", "/@", "#"}], "&"}], "/@", "#"}], "&"}], "/@", 
       RowBox[{"myRNAtracksHC", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "All", ",", "3", ",", "1"}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myRedfitsR", ",", "myRedCroppedDataR", ",", "myRedCentersR"}], 
          "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "1", ",", 
           RowBox[{
           "myRNAtracksHC", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedfitsR", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myRedfitsR", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myRedfitsR.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myRedfitsY", ",", "myRedCroppedDataY", ",", "myRedCentersY"}], 
          "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "1", ",", 
           RowBox[{
           "myRNAtracksHC", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedfitsY", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myRedfitsY", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myRedfitsY.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "3", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myRedfitsP", ",", "myRedCroppedDataP", ",", "myRedCentersP"}], 
          "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "1", ",", 
           RowBox[{
           "myRNAtracksHC", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedfitsP", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myRedfitsP", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myRedfitsP.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myRedfitsW", ",", "myRedCroppedDataW", ",", "myRedCentersW"}], 
          "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "1", ",", 
           RowBox[{
           "myRNAtracksHC", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myRedfitsW", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myRedfitsW", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myRedfitsW.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myGreenfitsY", ",", "myGreenCroppedDataY", ",", 
           "myGreenCentersY"}], "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "2", ",", 
           RowBox[{
           "myRNAtracksHCColReg", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myGreenfitsY", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myGreenfitsY", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myGreenfitsY.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myGreenfitsW", ",", "myGreenCroppedDataW", ",", 
           "myGreenCentersW"}], "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "2", ",", 
           RowBox[{
           "myRNAtracksHCColReg", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myGreenfitsW", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myGreenfitsW", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myGreenfitsW.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "3", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myBluefitsP", ",", "myBlueCroppedDataP", ",", "myBlueCentersP"}], 
          "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "3", ",", 
           RowBox[{
           "myRNAtracksHCColReg", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myBluefitsP", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myBluefitsP", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myBluefitsP.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myRNAtracksHC", "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "myBluefitsW", ",", "myBlueCroppedDataW", ",", "myBlueCentersW"}], 
          "}"}], "=", 
         RowBox[{"MyParticleFitterFixedSigma", "[", 
          RowBox[{"myColMovie", ",", "3", ",", 
           RowBox[{
           "myRNAtracksHCColReg", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], ",", "5", ",", "avgFrameN", ",", 
           "sigma"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myBluefitsW", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myBluefitsW", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<myBluefitsW.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myAllfits", "=", 
      RowBox[{"{", 
       RowBox[{
       "myRedfitsR", ",", "myRedfitsY", ",", "myRedfitsP", ",", "myRedfitsW", 
        ",", "myGreenfitsY", ",", "myGreenfitsW", ",", "myBluefitsP", ",", 
        "myBluefitsW"}], "}"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7701380504507246`*^9, 3.770138137717716*^9}, {
  3.7701382672801266`*^9, 3.7701383711200657`*^9}, {3.770138482580441*^9, 
  3.7701385912846584`*^9}, {3.7701391899469*^9, 3.770139238512678*^9}, {
  3.770146756914706*^9, 3.7701467811030893`*^9}, {3.7701469655676403`*^9, 
  3.770147002311742*^9}, {3.77038384781553*^9, 3.7703839208907094`*^9}, {
  3.771074827674245*^9, 3.7710748283545017`*^9}, {3.771867188857114*^9, 
  3.7718672290560226`*^9}, {3.771867723920988*^9, 3.771867966358942*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"5a67bdfc-c63a-4024-8ff3-007e0763bebd"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyFilterFitOutlierFixedSigma", "Subsection",
 CellChangeTimes->{{3.770383975730846*^9, 
  3.7703839835402927`*^9}},ExpressionUUID->"60f2b663-1a4e-4698-abaf-\
8a3000cf6072"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "removes", " ", "outliers", " ", "based", 
     " ", "on", " ", "intensity"}], ",", " ", 
    RowBox[{
    "90", "%", " ", "confidence", " ", "interval", " ", "of", " ", "xy", " ", 
     "positions", " ", "and", " ", "the", " ", "size", " ", "of", " ", 
     "sigma"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FilterFitOutlierFixedSigma", "[", 
    RowBox[{"mySpotsFit_", ",", "maxDxy_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "idxInt", ",", "idxX90Conf", ",", "idxY90Conf", ",", "idxOutliers"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idxInt", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "2", ",", "1"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"x", "<", "0"}], "||", 
           RowBox[{"x", ">", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idxX90Conf", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Differences", "/@", "#"}], "&"}], "/@", 
            RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "5", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "maxDxy"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxY90Conf", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Differences", "/@", "#"}], "&"}], "/@", 
            RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "5", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "maxDxy"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxOutliers", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"idxInt", ",", "idxX90Conf", ",", "idxY90Conf"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", 
       RowBox[{"mySpotsFit", ",", "idxOutliers"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7163079773033953`*^9, 3.7163080736239047`*^9}, {
  3.716308283583914*^9, 3.7163083117995276`*^9}, {3.7163083677277265`*^9, 
  3.7163083737850733`*^9}, {3.7175241617528915`*^9, 3.7175241618648977`*^9}, {
  3.7175242033692713`*^9, 3.717524205240379*^9}, {3.7175242379372487`*^9, 
  3.717524239273325*^9}, {3.7175250840096416`*^9, 3.7175250850256996`*^9}, {
  3.717771260303181*^9, 3.7177712633193536`*^9}, {3.770147439123726*^9, 
  3.770147465677245*^9}, {3.7703839912457333`*^9, 3.770383994050894*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"5108866f-07e0-4d2a-833b-e1a7931ba567"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetMyAllParameters", "Subsection",
 CellChangeTimes->{{3.7703914689004307`*^9, 
  3.770391479515038*^9}},ExpressionUUID->"369a8a96-8ba0-47a2-aa53-\
c3b2443bbb9f"],

Cell["\<\
Need to remove frames where red channel fail to fit. >> Now \
MyAllParametersFilter can be use to remove these..\
\>", "Text",
 CellChangeTimes->{{3.770588007087576*^9, 3.770588059460639*^9}, {
  3.770667646545768*^9, 
  3.770667676918949*^9}},ExpressionUUID->"976ab656-f957-4cd5-a372-\
88505f9fff12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetMyAllParameters", "[", 
   RowBox[{"myAllfits_", ",", "myAllfitsFiltered_", ",", "analysisFolder_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ch1", ",", "ch2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"preparing", " ", "empty", " ", "list", " ", "for", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"track", "#"}], ",", " ", 
        RowBox[{"frame", "#"}], ",", " ", "Ir", ",", " ", "Ig", ",", " ", 
        "Ib", ",", " ", "Xr", ",", " ", "Yr", ",", " ", "Xg", ",", " ", "Yg", 
        ",", " ", "Xb", ",", " ", "Yb"}], "}"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllParameters", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ",", "11"}], "}"}]}], "]"}], 
          "&"}], "/@", "#"}], "&"}], "/@", 
       RowBox[{"myAllfits", "\[LeftDoubleBracket]", 
        RowBox[{";;", "4"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"track", "#", " ", "and", " ", "frame", "#"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{";;", "4"}], ",", "All", ",", "All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"myAllfits", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{";;", "4"}], ",", "All", ",", "All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Red", " ", 
       "Only"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "3"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Yellow"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "3"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "2", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "track"}], "\[RightDoubleBracket]"}]}], ",",
               "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Purple"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "3"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "3", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "track"}], "\[RightDoubleBracket]"}]}], ",",
               "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "White"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"4", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"4", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "3"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "4", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"4", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{"4", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "track"}], "\[RightDoubleBracket]"}]}], ",",
               "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "4", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Green", " ", "channel", " ", "for", " ", "Yellow"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "5"}], ";", 
     RowBox[{"ch2", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "4"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"8", ",", "9"}], "}"}]}], "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Green", " ", "channel", " ", "for", " ", "White"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "6"}], ";", 
     RowBox[{"ch2", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "4"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"8", ",", "9"}], "}"}]}], "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Blue", " ", "channel", " ", "for", " ", "Purple"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "7"}], ";", 
     RowBox[{"ch2", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "5"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "11"}], "}"}]}], 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Blue", " ", "channel", " ", "for", " ", "White"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "8"}], ";", 
     RowBox[{"ch2", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myAllfits", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
           RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", "5"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", 
                "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"ch2", ",", "track", ",", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "11"}], "}"}]}], 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
               RowBox[{
               "ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
               "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"frame", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
                RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Delete", " ", "frames", " ", "which", " ", "there", " ", "is", " ", 
       "no", " ", "red", " ", "channel"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "All", ",", "All", ",", "3"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myAllParameters", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"myAllParameters", ",", "idx"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"myAllParameters", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<_myAllParameters.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "myAllParameters"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.770387303070159*^9, 3.77038732109619*^9}, {
   3.770387545478024*^9, 3.7703875890555162`*^9}, {3.7703876703741674`*^9, 
   3.770387702464003*^9}, {3.7703877374710054`*^9, 3.7703877437703657`*^9}, {
   3.770389205560975*^9, 3.770389324953804*^9}, {3.7703898040812087`*^9, 
   3.7703898070313773`*^9}, {3.770390390725763*^9, 3.770390400890344*^9}, {
   3.770391047230313*^9, 3.770391080315205*^9}, {3.770391111640997*^9, 
   3.770391202904217*^9}, {3.7703912341790056`*^9, 3.770391380505375*^9}, {
   3.770392689267232*^9, 3.7703927319226713`*^9}, {3.7703927621013975`*^9, 
   3.770392784616686*^9}, {3.770392825994052*^9, 3.770392847302271*^9}, {
   3.770392927848878*^9, 3.7703929306020355`*^9}, {3.770392973053464*^9, 
   3.770393037289138*^9}, {3.7703930853128843`*^9, 3.770393092591301*^9}, {
   3.770393162877321*^9, 3.770393417824903*^9}, {3.770393451311818*^9, 
   3.7703935095041466`*^9}, {3.7703936213275423`*^9, 
   3.7703936214465494`*^9}, {3.770394375500679*^9, 3.7703944088325853`*^9}, {
   3.7703944607865567`*^9, 3.770394476128434*^9}, {3.7705779776551037`*^9, 
   3.7705779820366387`*^9}, {3.7705784081866207`*^9, 3.7705784206588545`*^9}, 
   3.7705863758829727`*^9, {3.770586406216846*^9, 3.770586607844508*^9}, 
   3.770586714494574*^9, {3.7705869763116455`*^9, 3.770586977916005*^9}, {
   3.770587102345293*^9, 3.7705871113625154`*^9}, {3.7705872469114857`*^9, 
   3.7705872577497787`*^9}, {3.770735474458172*^9, 3.770735475110886*^9}, 
   3.771956323089353*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"210c85d5-076f-4ddf-a9bb-68bbeba53872"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetMyAllParametersOld", "[", 
   RowBox[{"myAllfits_", ",", "myAllfitsFiltered_", ",", "analysisFolder_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ch1", ",", "ch2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"preparing", " ", "empty", " ", "list", " ", "for", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"track", "#"}], ",", " ", 
        RowBox[{"frame", "#"}], ",", " ", "Ir", ",", " ", "Ig", ",", " ", 
        "Ib", ",", " ", "Xr", ",", " ", "Yr", ",", " ", "Xg", ",", " ", "Yg", 
        ",", " ", "Xb", ",", " ", "Yb"}], "}"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllParameters", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ",", "11"}], "}"}]}], "]"}], 
          "&"}], "/@", "#"}], "&"}], "/@", 
       RowBox[{"myAllfits", "\[LeftDoubleBracket]", 
        RowBox[{";;", "4"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"track", "#", " ", "and", " ", "frame", "#"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{";;", "4"}], ",", "All", ",", "All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"myAllfits", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{";;", "4"}], ",", "All", ",", "All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Red", " ", 
       "Only"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "3"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Yellow"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "3"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "2", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Purple"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "3"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "3", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Red", " ", "channel", " ", "for", " ", "Purple"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"4", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"4", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "3"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "4", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"4", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"4", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"4", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Green", " ", "channel", " ", "for", " ", "Yellow"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "5"}], ";", 
     RowBox[{"ch2", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "4"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}],
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"8", ",", "9"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Green", " ", "channel", " ", "for", " ", "White"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "6"}], ";", 
     RowBox[{"ch2", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "4"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}],
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"8", ",", "9"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Blue", " ", "channel", " ", "for", " ", "Purple"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "7"}], ";", 
     RowBox[{"ch2", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "5"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}],
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"10", ",", "11"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Intensity", " ", "&"}], " ", "XY", " ", "coordinate", " ", 
       "of", " ", "Blue", " ", "channel", " ", "for", " ", "White"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ch1", "=", "8"}], ";", 
     RowBox[{"ch2", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{
       RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
        RowBox[{"ch1", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"ch2", ",", "All", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",",
              "5"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{
            "ch1", ",", "track", ",", "frame", ",", "4", ",", "2", ",", "1"}],
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
            RowBox[{"ch2", ",", "track", ",", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"track", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"10", ",", "11"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
            RowBox[{"ch1", ",", "track", ",", "frame", ",", "4", ",", "1"}], 
            "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"myAllfitsFiltered", "\[LeftDoubleBracket]", 
             RowBox[{"ch1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
           "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"track", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myAllfitsFiltered", "\[LeftDoubleBracket]", "ch2", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Delete", " ", "frames", " ", "which", " ", "there", " ", "is", " ", 
       "no", " ", "red", " ", "channel"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "All", ",", "3"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myAllParameters", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"myAllParameters", ",", "idx"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myAllParameters", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<_myAllParameters.m\>\""}]}], ";", 
     "\[IndentingNewLine]", "myAllParameters"}]}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQvc/uUU6h+BvHv8LK+SD6p7d+N4g+dWzhBBCt9/P0
LBAte/PcPBBdJaS/GERfW/YDTDd93hhVBKQntM7LBNHOM5uWgmhuxodgutjy
+jsQvblW5gOI3hn33KEYSGuKcbmCaJ7mLx4gOuJ9TAiIztrlGgGiOXQmZIFo
rV4NvhIg3dZWKwyil9k5i4PoJ7uFpUC023l7eRBtsualIohm0vqtDaIfOAfr
gOhfWxcaguh5DistQbQa8yp7EP3h9SQHEM0sHOMJomenWmWC6Kxfmbkg+ofi
hhIQbVW9qglEK3mtA9MTWD88ANFdS6SeguhK7ZmvwfIyLW9B9JxvJu3ngLSq
zkEwfeYH614QHSY6dR+Ibm+qvHkZSIssaQHTeb2zu/Ol3jhuadoLpgEMbLnw

  "],
 CellLabel->
  "In[139]:=",ExpressionUUID->"242613e7-66b9-448f-a4cc-dc0bfd51f0b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyAllParametersFilter", "Subsection",
 CellChangeTimes->{{3.770667685721104*^9, 
  3.770667691230096*^9}},ExpressionUUID->"0172e43b-57b6-4dca-801c-\
11dcf485f632"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "flag", " ", "1", " ", "to", " ", "delete", " ", "only", " ", "the", " ", 
    "frame", " ", "in", " ", "which", " ", "the", " ", "red", " ", "channel", 
    " ", "fail", " ", "to", " ", "fit", "\[IndentingNewLine]", "  ", "flag", 
    " ", "2", " ", "to", " ", "delete", " ", "the", " ", "entire", " ", 
    "track", " ", "which", " ", "has", " ", "any", " ", "frame", " ", "in", 
    " ", "which", " ", "the", " ", "red", " ", "channel", " ", "fail", " ", 
    "to", " ", "fit"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyAllParametersFilter", "[", 
    RowBox[{"myAllParameters_", ",", "analysisFolder_", ",", "flag_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"idx", ",", "idx2", ",", "myAllParametersFiltered"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idx", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "3"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"idx", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Length", "@", "x"}], "\[Equal]", "1"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flag", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"myAllParametersFiltered", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"myAllParameters", ",", "idx"}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"flag", "\[Equal]", "2"}], ",", 
           RowBox[{
            RowBox[{"idx2", "=", 
             RowBox[{"idx", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{";;", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"myAllParametersFiltered", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"myAllParameters", ",", "idx2"}], "]"}]}], ";"}]}], 
          "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"myAllParametersFiltered", ">>", 
       RowBox[{
       "analysisFolder", "<>", "\"\<_myAllParametersFiltered.m\>\""}]}], ";", 
      "\[IndentingNewLine]", "myAllParametersFiltered"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7706687801399736`*^9, 3.7706688059411345`*^9}, {
  3.770735874561417*^9, 3.770735921263025*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"9e8ce18d-e1b8-4e9a-8b7f-8c0eb2fa7485"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyFitCropMaker", "Subsection",
 CellChangeTimes->{{3.7703983725082946`*^9, 
  3.770398375766481*^9}},ExpressionUUID->"68f243d2-7c88-4e2a-ad38-\
ec17ee052f48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyFitCropMaker", "[", 
   RowBox[{
   "myColMovie_", ",", "myAllParameters_", ",", "pad_", ",", 
    "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myTfFunc", ",", "avgFrameN", ",", "tempTime", ",", "tempCenter", ",", 
      "tempCenterColReg", ",", "tempCenterGreen", ",", "tempCenterBlue", ",", 
      "tempRed", ",", "tempGreen", ",", "tempBlue", ",", "myCropsR", ",", 
      "myCropsY", ",", "myCropsP", ",", "myCropsW", ",", "myCropsRAvg", ",", 
      "myCropsYAvg", ",", "myCropsPAvg", ",", "myCropsWAvg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myTfFunc", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<TransformationFunction.m\>\"", ",", 
           RowBox[{"ParentDirectory", "@", 
            RowBox[{"DirectoryName", "@", "analysisFolder"}]}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<*avgFrameN*\>\"", ",", 
           RowBox[{"DirectoryName", "@", "analysisFolder"}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myCropsR", "=", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempTime", "=", 
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "track", ",", "frame", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenter", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterColReg", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myTfFunc", "@", 
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "track", ",", "frame", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}], 
            "=", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenter", "-", "pad"}], ",", 
                  RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                  RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                 "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"3", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                  RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                 "}"}]}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"{", 
            RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
            "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"track", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myAllParameters", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsRAvg", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "/@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "/@", "myCropsR"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsY", "=", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempTime", "=", 
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "track", ",", "frame", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenter", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterGreen", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"8", ",", "9"}], "}"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterColReg", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myTfFunc", "@", 
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "track", ",", "frame", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}], 
            "=", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenter", "-", "pad"}], ",", 
                  RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NumericQ", "@", 
                 RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "track", ",", "frame", ",", "4"}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterGreen", "-", "pad"}], ",", 
                    RowBox[{"tempCenterGreen", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                    RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"3", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                  RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                 "}"}]}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"{", 
            RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
            "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"track", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myAllParameters", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsYAvg", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "/@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "/@", "myCropsY"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsP", "=", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempTime", "=", 
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "track", ",", "frame", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenter", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterBlue", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"10", ",", "11"}], "}"}]}], "\[RightDoubleBracket]"}],
              "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterColReg", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myTfFunc", "@", 
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "track", ",", "frame", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}], 
            "=", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenter", "-", "pad"}], ",", 
                  RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                  RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                 "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NumericQ", "@", 
                 RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
                  RowBox[{"3", ",", "track", ",", "frame", ",", "5"}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterBlue", "-", "pad"}], ",", 
                    RowBox[{"tempCenterBlue", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                    RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
            "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"track", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myAllParameters", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsPAvg", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "/@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "/@", "myCropsP"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsW", "=", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempTime", "=", 
            RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
             RowBox[{"4", ",", "track", ",", "frame", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenter", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"4", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "7"}], "}"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterGreen", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"4", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"8", ",", "9"}], "}"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterBlue", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"4", ",", "track", ",", "frame", ",", 
               RowBox[{"{", 
                RowBox[{"10", ",", "11"}], "}"}]}], "\[RightDoubleBracket]"}],
              "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"tempCenterColReg", "=", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"myTfFunc", "@", 
              RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
               RowBox[{"4", ",", "track", ",", "frame", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}], 
            "=", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", 
                  RowBox[{"tempTime", "+", 
                   RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempCenter", "-", "pad"}], ",", 
                  RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NumericQ", "@", 
                 RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "track", ",", "frame", ",", "4"}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterGreen", "-", "pad"}], ",", 
                    RowBox[{"tempCenterGreen", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                    RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              "\t       ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NumericQ", "@", 
                 RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "track", ",", "frame", ",", "5"}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterBlue", "-", "pad"}], ",", 
                    RowBox[{"tempCenterBlue", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"ImageTrim", "[", 
                 RowBox[{
                  RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", 
                    RowBox[{"tempTime", "+", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"avgFrameN", "/", "2"}], "]"}], "-", "1"}]}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tempCenterColReg", "-", "pad"}], ",", 
                    RowBox[{"tempCenterColReg", "+", "pad", "-", "0.1"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"tempRed", ",", "tempGreen", ",", "tempBlue"}], "}"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"myAllParameters", "\[LeftDoubleBracket]", 
              RowBox[{"4", ",", "track"}], "\[RightDoubleBracket]"}]}], ",", 
            "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"track", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myAllParameters", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myCropsWAvg", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "/@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "/@", "myCropsW"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myFitCrops", "=", 
      RowBox[{"{", 
       RowBox[{
       "myCropsR", ",", "myCropsY", ",", "myCropsP", ",", "myCropsW"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myFitCrops", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<_FitCrops.m\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myFitCropsAvg", "=", 
      RowBox[{"{", 
       RowBox[{
       "myCropsRAvg", ",", "myCropsYAvg", ",", "myCropsPAvg", ",", 
        "myCropsWAvg"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myFitCropsAvg", ">>", 
      RowBox[{"analysisFolder", "<>", "\"\<_FitCrops_AVG.m\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"myFitCrops", ",", "myFitCropsAvg"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.770061372235982*^9, 3.7700614588589363`*^9}, {
   3.7700615868472567`*^9, 3.7700616476927366`*^9}, {3.770061695371464*^9, 
   3.7700617288113766`*^9}, 3.770061791345953*^9, {3.7700619982097855`*^9, 
   3.7700620066472683`*^9}, {3.7703947597976594`*^9, 3.770394780334834*^9}, {
   3.7703948126246805`*^9, 3.770394835422985*^9}, {3.7703948690829105`*^9, 
   3.7703950511573243`*^9}, {3.770395084339222*^9, 3.770395219119931*^9}, {
   3.7703952628334312`*^9, 3.7703955600014286`*^9}, {3.7703955901931553`*^9, 
   3.7703956469053993`*^9}, {3.7703956871537013`*^9, 
   3.7703958223834357`*^9}, {3.7703963251021895`*^9, 
   3.7703964053097773`*^9}, {3.7703973968574905`*^9, 
   3.7703974394859285`*^9}, {3.770397478931185*^9, 3.7703975711584597`*^9}, {
   3.770397816785509*^9, 3.7703978221578164`*^9}, {3.7703978709796085`*^9, 
   3.770397873879775*^9}, {3.7703990844470153`*^9, 3.770399098070794*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"5a6a1aeb-b680-4107-91e1-9169c7e9b065"]
}, Closed]],

Cell[CellGroupData[{

Cell["MSDcalculator", "Subsection",
 CellChangeTimes->{{3.770476030412073*^9, 
  3.770476033602255*^9}},ExpressionUUID->"420b2eb0-dbcc-4e55-9c6f-\
0d5cf0e4c050"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSDcalculatorOldest", "[", 
   RowBox[{
   "myAllParameters_", ",", "maxDframe_", ",", "frameRate_", ",", 
    "pixelSize_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"frameRate", " ", "in", " ", "second"}], ",", " ", 
    RowBox[{"pixelSize", " ", "in", " ", "\[Micro]m"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersNM", ",", "myMSD", ",", "tempMaxDframe", ",", "sd", ",", 
      "deltaT", ",", "sdTime", ",", "msdTime"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllParametersNM", "=", "myAllParameters"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "All", ",", "2"}], 
       "\[RightDoubleBracket]"}], "*=", "frameRate"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "All", ",", "2"}], 
       "\[RightDoubleBracket]"}], "-=", "frameRate"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "All", ",", 
        RowBox[{"6", ";;"}]}], "\[RightDoubleBracket]"}], "*=", "pixelSize"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myMSD", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ">", 
              RowBox[{"maxDframe", "+", "1"}]}], ",", 
             RowBox[{"tempMaxDframe", "=", "maxDframe"}], ",", 
             RowBox[{"tempMaxDframe", "=", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                 RowBox[{"color", ",", "track"}], "\[RightDoubleBracket]"}]}],
                "-", "2"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"sd", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "/@", "#"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Differences", "[", 
                  RowBox[{
                   RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "track", ",", "All", ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], ",", "1", ",", "i"}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "tempMaxDframe", ",", "1"}], 
                  "}"}]}], "]"}], "^", "2"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"deltaT", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Differences", "[", 
               RowBox[{
                RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                 RowBox[{"color", ",", "track", ",", "All", ",", "2"}], 
                 "\[RightDoubleBracket]"}], ",", "1", ",", "i"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "tempMaxDframe", ",", "1"}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sdTime", "=", 
            RowBox[{"SplitBy", "[", 
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Thread", "/@", 
                  RowBox[{"Thread", "@", 
                   RowBox[{"{", 
                    RowBox[{"deltaT", ",", "sd"}], "}"}]}]}], ",", "1"}], 
                "]"}]}], ",", "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"msdTime", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Mean", "@", "#"}], ",", 
                RowBox[{"ErrorBar", "@", 
                 FractionBox[
                  RowBox[{"StandardDeviation", "@", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  RowBox[{"Sqrt", "@", 
                   RowBox[{"Length", "@", "#"}]}]]}]}], "}"}], "&"}], "/@", 
             "sdTime"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sdTime", ",", "msdTime"}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllParametersNM", "\[LeftDoubleBracket]", "color", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", 
          RowBox[{"Length", "@", "myAllParametersNM"}], ",", "1"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7704756188475323`*^9, 3.770475744125698*^9}, {
  3.770475814370716*^9, 3.770475815749795*^9}, {3.770475935041618*^9, 
  3.770475957505903*^9}, {3.7743737139036956`*^9, 3.7743737161531734`*^9}, {
  3.7743748392347975`*^9, 3.7743748396409063`*^9}, {3.774377016249753*^9, 
  3.7743770165309677`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"7644582b-571f-4cc3-8865-42f2696f4ea5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSDcalculatorOld", "[", 
   RowBox[{
   "myAllParameters_", ",", "maxDframe_", ",", "frameRate_", ",", 
    "pixelSize_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"frameRate", " ", "in", " ", "second"}], ",", " ", 
    RowBox[{"pixelSize", " ", "in", " ", "\[Micro]m"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersNM", ",", "myMSD", ",", "tempMaxDframe", ",", "sd", ",", 
      "deltaT", ",", "sdTime", ",", "msdTime"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllParametersNM", "=", "myAllParameters"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "All", ",", 
        RowBox[{"6", ";;"}]}], "\[RightDoubleBracket]"}], "*=", "pixelSize"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myMSD", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ">", 
              RowBox[{"maxDframe", "+", "1"}]}], ",", 
             RowBox[{"tempMaxDframe", "=", "maxDframe"}], ",", 
             RowBox[{"tempMaxDframe", "=", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                 RowBox[{"color", ",", "track"}], "\[RightDoubleBracket]"}]}],
                "-", "2"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"sd", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "/@", "#"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Differences", "[", 
                  RowBox[{
                   RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "track", ",", "All", ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], ",", "1", ",", "i"}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "tempMaxDframe", ",", "1"}], 
                  "}"}]}], "]"}], "^", "2"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"deltaT", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Differences", "[", 
               RowBox[{
                RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                 RowBox[{"color", ",", "track", ",", "All", ",", "2"}], 
                 "\[RightDoubleBracket]"}], ",", "1", ",", "i"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "tempMaxDframe", ",", "1"}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sdTime", "=", 
            RowBox[{"SplitBy", "[", 
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Thread", "/@", 
                  RowBox[{"Thread", "@", 
                   RowBox[{"{", 
                    RowBox[{"deltaT", ",", "sd"}], "}"}]}]}], ",", "1"}], 
                "]"}]}], ",", "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sdTime", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}],
             "*=", "frameRate"}], ";", "\[IndentingNewLine]", 
           RowBox[{"msdTime", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Mean", "@", "#"}], ",", 
                RowBox[{"ErrorBar", "@", 
                 FractionBox[
                  RowBox[{"StandardDeviation", "@", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  RowBox[{"Sqrt", "@", 
                   RowBox[{"Length", "@", "#"}]}]]}]}], "}"}], "&"}], "/@", 
             "sdTime"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sdTime", ",", "msdTime"}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllParametersNM", "\[LeftDoubleBracket]", "color", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", 
          RowBox[{"Length", "@", "myAllParametersNM"}], ",", "1"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7704756188475323`*^9, 3.770475744125698*^9}, {
   3.770475814370716*^9, 3.770475815749795*^9}, {3.770475935041618*^9, 
   3.770475957505903*^9}, {3.7743737139036956`*^9, 3.7743737161531734`*^9}, 
   3.7743748528913336`*^9, {3.7743749530951767`*^9, 3.774374975815963*^9}, {
   3.7743750320501103`*^9, 3.7743750328623943`*^9}, {3.7743770196893873`*^9, 
   3.774377023098465*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"bc741561-9da4-4437-bd0d-1e0168a08fa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSDcalculator", "[", 
   RowBox[{"myAllParameters_", ",", "maxDframe_", ",", "pixelSize_"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"frameRate", " ", "in", " ", "second"}], ",", " ", 
    RowBox[{"pixelSize", " ", "in", " ", "\[Micro]m"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersNM", ",", "myMSD", ",", "tempMaxDframe", ",", "sd", ",", 
      "deltaT", ",", "sdTime", ",", "msdTime"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllParametersNM", "=", "myAllParameters"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "All", ",", 
        RowBox[{"6", ";;"}]}], "\[RightDoubleBracket]"}], "*=", "pixelSize"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myMSD", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "track"}], "\[RightDoubleBracket]"}]}], 
              ">", 
              RowBox[{"maxDframe", "+", "1"}]}], ",", 
             RowBox[{"tempMaxDframe", "=", "maxDframe"}], ",", 
             RowBox[{"tempMaxDframe", "=", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                 RowBox[{"color", ",", "track"}], "\[RightDoubleBracket]"}]}],
                "-", "2"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"sd", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "/@", "#"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Differences", "[", 
                  RowBox[{
                   RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "track", ",", "All", ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], ",", "1", ",", "i"}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "tempMaxDframe", ",", "1"}], 
                  "}"}]}], "]"}], "^", "2"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"deltaT", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Differences", "[", 
               RowBox[{
                RowBox[{"myAllParametersNM", "\[LeftDoubleBracket]", 
                 RowBox[{"color", ",", "track", ",", "All", ",", "2"}], 
                 "\[RightDoubleBracket]"}], ",", "1", ",", "i"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "tempMaxDframe", ",", "1"}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sdTime", "=", 
            RowBox[{"SplitBy", "[", 
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Thread", "/@", 
                  RowBox[{"Thread", "@", 
                   RowBox[{"{", 
                    RowBox[{"deltaT", ",", "sd"}], "}"}]}]}], ",", "1"}], 
                "]"}]}], ",", "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"msdTime", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Mean", "@", "#"}], ",", 
                RowBox[{"ErrorBar", "@", 
                 FractionBox[
                  RowBox[{"StandardDeviation", "@", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  RowBox[{"Sqrt", "@", 
                   RowBox[{"Length", "@", "#"}]}]]}]}], "}"}], "&"}], "/@", 
             "sdTime"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"sdTime", ",", "msdTime"}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"track", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myAllParametersNM", "\[LeftDoubleBracket]", "color", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", 
          RowBox[{"Length", "@", "myAllParametersNM"}], ",", "1"}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.774377029318618*^9, 3.7743770404002743`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"bb225ba9-89f8-493c-9045-e0b8f1c7cb21"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Analysis", "Title",
 CellChangeTimes->{{3.77003337542465*^9, 
  3.770033377113057*^9}},ExpressionUUID->"dd294261-86e1-4c6d-a9c7-\
61d1f31cbd40"],

Cell[CellGroupData[{

Cell["1. Pre-process", "Chapter",
 CellChangeTimes->{{3.6483041433283873`*^9, 3.6483041519288793`*^9}, {
  3.770033380736884*^9, 3.770033385986718*^9}, {3.7700382130976524`*^9, 
  3.770038213363655*^9}},ExpressionUUID->"b2fc20ab-45c5-4ff1-bed1-\
28dcec16fc53"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["1. Reading in Images ",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.5831236302316623`*^9, 3.5831236326916656`*^9}, {
   3.6097111426870265`*^9, 3.6097111439581537`*^9}, {3.6422513183492937`*^9, 
   3.642251333965187*^9}, {3.6783136569918723`*^9, 3.6783136621191654`*^9}, 
   3.678316094481289*^9, {3.770038227332758*^9, 
   3.770038227597958*^9}},ExpressionUUID->"1ecf965e-e589-4c14-bb17-\
2a8a1d612fb1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"FileNameSetter", "[", 
    RowBox[{"Dynamic", "[", "mymovie", "]"}], "]"}], ",", 
   RowBox[{"Dynamic", "[", "mymovie", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.651503548625061*^9, 3.651503549729124*^9}, {
  3.6515036971455555`*^9, 3.6515037273852854`*^9}, {3.6515038052497387`*^9, 
  3.651503807864888*^9}, {3.6515048066830177`*^9, 3.6515048169146028`*^9}, {
  3.6515052946509275`*^9, 3.651505295114954*^9}, {3.6515053260127215`*^9, 
  3.651505326890772*^9}, {3.651521020023368*^9, 3.651521093823589*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"82b96eab-bff3-4f38-bad5-578a80fb5e57"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     Dynamic[$CellContext`mymovie], "Open", All},
    "FileNameSetterBoxes"], ",", 
   DynamicBox[ToBoxes[$CellContext`mymovie, StandardForm],
    ImageSizeCache->{478., {3., 10.}}]}], "}"}]], "Output",
 CellChangeTimes->{3.7152980864640465`*^9, 3.7735950361592917`*^9, 
  3.780235612997694*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"55fcff7c-9196-4a1b-a6e2-982700f95e3f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myColMovie", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", "mymovie", "]"}], "//", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectoryQ", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
        "\"\<Analysis\\\\\>\""}], ")"}]}], "\[Equal]", "False"}], ",", 
    RowBox[{"CreateDirectory", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
       "\"\<Analysis\\\\\>\""}], ")"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analysisFolder", "=", 
   RowBox[{
    RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
    "\"\<Analysis\\\\\>\"", "<>", 
    RowBox[{"StringDrop", "[", 
     RowBox[{
      RowBox[{"StringDelete", "[", 
       RowBox[{"mymovie", ",", 
        RowBox[{"DirectoryName", "[", "mymovie", "]"}]}], "]"}], ",", 
      RowBox[{"-", "4"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6515063970679827`*^9, 3.651506411178789*^9}, {
   3.6515066477483206`*^9, 3.6515066488673844`*^9}, {3.6515067054626217`*^9, 
   3.6515067061716623`*^9}, {3.6515265140116053`*^9, 3.651526514107611*^9}, {
   3.6783130580806165`*^9, 3.6783130585136414`*^9}, 3.7055111247331915`*^9, {
   3.801444329873703*^9, 3.8014443299696145`*^9}, 3.8014445099964886`*^9, {
   3.817570014683683*^9, 3.817570027016815*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"0846260c-1d40-4d90-a381-f14443dd67f8"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2. Reading in Parameters (if parameters exist)",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.678552493212551*^9, 3.6785525007159805`*^9}, {
  3.6786508024734793`*^9, 3.678650831977167*^9}, {3.770038229566165*^9, 
  3.7700382297845654`*^9}},ExpressionUUID->"06369ad6-88da-4fd6-b4a3-\
5658ff56fcd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myTfFunc", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryName", "@", "mymovie"}], "<>", 
      "\"\<TransformationFunction.m\>\""}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"myInvTfFunc", "=", " ", 
  RowBox[{"InverseFunction", "@", "myTfFunc"}]}]}], "Input",
 CellChangeTimes->{{3.806683429604861*^9, 3.8066834305384855`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"8272173b-8e96-4ab9-8cba-84e5aa14cc3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymask", "=", 
   RowBox[{"Import", "@", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.714760381291838*^9, 3.7147604017140064`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"ef058910-7086-4471-88b8-67e255c73b8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"avgFrameN", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myColMovieRunAv", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"avgFrameN", "\[Equal]", "1"}], ",", "myColMovie", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MovingAverage", "[", 
        RowBox[{"#", ",", "avgFrameN"}], "]"}], "&"}], "/@", "myColMovie"}]}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.715368132861471*^9, 3.7153681554617643`*^9}, 
   3.716828019728117*^9, {3.770064888402095*^9, 3.7700648886921115`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"b4c803e9-bfa8-4c70-9356-4a6a10fa7a38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myredtracks", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_redtracks.dat\>\""}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7700649449163275`*^9, 3.7700649909849625`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"d26526e0-7197-45d2-b3c3-21f249b8e3e6"]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Creating Transformation Function", "Section",
 CellChangeTimes->{{3.6515232012801285`*^9, 3.6515232091525784`*^9}, {
  3.7700382344266014`*^9, 
  3.770038234660602*^9}},ExpressionUUID->"9ac46a5c-7900-4f9a-b337-\
b06be2d90035"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dirBeads", "=", 
   RowBox[{
    RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", "\"\<Beads\>\""}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6515233788132825`*^9, 3.651523475464811*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"52cd9e9c-39ac-41b5-8c67-a62370b48e08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.tif\>\"", ",", "dirBeads"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myBeadsImgs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "@", 
      RowBox[{
      "myFiles", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "myFiles", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myDims", "=", 
   RowBox[{"ImageDimensions", "@", 
    RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorCombine", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ConstantImage", "[", 
        RowBox[{"0", ",", "myDims"}], "]"}]}], "}"}], "]"}], "//", 
    "ImageAdjust"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Choose an image to calculate the transformation function and CLICK\>\
\"", ",", 
     RowBox[{"nRefImg", "=", "data"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"data", ",", "1", ",", 
     RowBox[{"Length", "[", "myFiles", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6472842488313336`*^9, 3.6472842802491302`*^9}, {
  3.6472843380484366`*^9, 3.6472843498251104`*^9}, {3.6472843849931216`*^9, 
  3.6472846989050765`*^9}, {3.6476199272898703`*^9, 3.6476200105786343`*^9}, {
  3.6476207275146403`*^9, 3.6476207335459857`*^9}, {3.6476207720271864`*^9, 
  3.647620795722542*^9}, {3.6484024981878595`*^9, 3.6484025788674746`*^9}, {
  3.648402631659494*^9, 3.648402640107977*^9}, {3.64840269085988*^9, 
  3.6484027018515086`*^9}, {3.6485688255122385`*^9, 3.648568839433035*^9}, {
  3.6515234645531864`*^9, 3.6515234936248493`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"5ddefe19-dfb6-4316-8108-354eeb614dd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRefBeadsRedImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nRefImg", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myRefBeadsGreenImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nRefImg", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myRefBeadsRedImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdRed"}], "]"}], "&"}]}], ",", 
       RowBox[{"myRefBeadsGreenImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdGreen"}], "]"}], "&"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Choose thresholds and CLICK\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thRed", "=", "thresholdRed"}], ",", 
       RowBox[{"thGreen", "=", "thresholdGreen"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"thresholdRed", ",", "0.01", ",", "0.5", ",", "0.005"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"thresholdGreen", ",", "0.01", ",", "0.5", ",", "0.001"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.647284738342332*^9, 3.6472847566733804`*^9}, {
   3.6472870495625267`*^9, 3.6472870798832607`*^9}, {3.6476066050868835`*^9, 
   3.6476066416629763`*^9}, {3.647616071455329*^9, 3.6476160716063375`*^9}, {
   3.647620819450899*^9, 3.64762084254622*^9}, {3.648402606340046*^9, 
   3.6484026099952545`*^9}, {3.6484045377655168`*^9, 3.648404538013531*^9}, {
   3.648404585229232*^9, 3.648404587589367*^9}, {3.648568868680708*^9, 
   3.6485689240248733`*^9}, 3.648568962481073*^9, {3.65524317128572*^9, 
   3.6552431720297623`*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"cca7a0a9-938c-4317-97a6-0e1f671b30bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myRefBeadsRedImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myRefBeadsRedImg", ",", "thRed"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myRefBeadsGreenImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myRefBeadsGreenImg", ",", "thGreen"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{
  "\"\<   `` red particles and `` green particles were found.\>\"", ",", 
   RowBox[{"Length", "@", "myRedPosGuess"}], ",", 
   RowBox[{"Length", "@", "myGreenPosGuess"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6472871195535297`*^9, 3.6472871600828476`*^9}, {
  3.6472872536111975`*^9, 3.647287254323238*^9}, {3.647291607334216*^9, 
  3.647291611030427*^9}, {3.64760669330293*^9, 3.647606693582946*^9}, {
  3.647606739886594*^9, 3.6476068095835805`*^9}, {3.6476161035591655`*^9, 
  3.6476161113906136`*^9}, {3.647616714199092*^9, 3.64761671451111*^9}, {
  3.6476208578180933`*^9, 3.647620903682717*^9}, {3.648383804191662*^9, 
  3.648383913465254*^9}, {3.648384596706857*^9, 3.648384602902068*^9}, {
  3.648388533593933*^9, 3.648388542173948*^9}, {3.648388651943741*^9, 
  3.648388653191743*^9}, {3.6484031152761555`*^9, 3.648403123347617*^9}, {
  3.6485687322569046`*^9, 3.64856879756064*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"65c93276-f406-4876-9831-720f778aad0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myRefBeadsRedImg", ",", "myRedPosGuess", ",", "7"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myRefBeadsGreenImg", ",", "myGreenPosGuess", ",", "7"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "myTfFuncError", ",", "myTfFunc", ",", "distanceRaw", ",", 
     "distanceCorrected"}], "}"}], "=", 
   RowBox[{"BeadsTransform", "[", 
    RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"myTfFuncError", ",", "myTfFunc", ",", 
   RowBox[{
    RowBox[{"Insert", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"distanceRaw", ",", "distanceCorrected"}], "}"}], "//", 
       "Transpose"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Distance Before Correction\>\"", ",", 
        "\"\<Distance After Correction\>\""}], "}"}], ",", "1"}], "]"}], "//",
     "TableForm"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.6472917775439515`*^9, 3.6472918674140916`*^9}, {
   3.6472919395192156`*^9, 3.6472921294710803`*^9}, {3.64729216005583*^9, 
   3.647292204343363*^9}, {3.64729223768727*^9, 3.6472922638717675`*^9}, {
   3.6472923420242376`*^9, 3.647292344791396*^9}, {3.647292377799284*^9, 
   3.647292382471551*^9}, {3.647292597439847*^9, 3.6472926420633993`*^9}, {
   3.6476167011113434`*^9, 3.6476168305597477`*^9}, 3.647619593401773*^9, {
   3.6476200713801117`*^9, 3.647620079346567*^9}, {3.647620137890916*^9, 
   3.6476201587781105`*^9}, {3.6476209285711403`*^9, 3.647620985123375*^9}, {
   3.647621041082576*^9, 3.647621051891194*^9}, {3.647710782554494*^9, 
   3.647710782794508*^9}, {3.648384062470116*^9, 3.6483840627509165`*^9}, {
   3.6483842823091035`*^9, 3.6483842897503166`*^9}, {3.64838861160007*^9, 
   3.6483886246104927`*^9}, {3.648389210430524*^9, 3.6483892208045425`*^9}, {
   3.6483912901037827`*^9, 3.6483913257040453`*^9}, {3.6483913568583*^9, 
   3.648391371119725*^9}, {3.648391426798223*^9, 3.648391471012701*^9}, {
   3.6483917247137585`*^9, 3.6483917651700726`*^9}, {3.6484010898193054`*^9, 
   3.6484011325947523`*^9}, {3.6484011932102194`*^9, 3.64840120301078*^9}, {
   3.6485690330251074`*^9, 3.648569059400616*^9}, {3.6485690926485176`*^9, 
   3.6485690984008465`*^9}, {3.6485691294816246`*^9, 3.648569207153067*^9}, {
   3.6485692641953297`*^9, 3.648569271000719*^9}, {3.6485693716974783`*^9, 
   3.648569381953065*^9}, {3.6515236902010927`*^9, 3.6515237054009624`*^9}, {
   3.651524094618224*^9, 3.6515240992494893`*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"e5c26d46-df0f-47d9-a7c2-9fa256fa9424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
     "\"\<TransformationFunction.m\>\""}], ",", "myTfFunc"}], "]"}], 
  ";"}]], "Input",
 CellLabel->
  "In[332]:=",ExpressionUUID->"adad3120-379b-4502-b999-e1abd786ce3b"]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Checking Transformation Function", "Section",
 CellChangeTimes->{{3.6483887123676476`*^9, 3.6483887334296846`*^9}, {
  3.770038238144633*^9, 
  3.7700382384420333`*^9}},ExpressionUUID->"f57a5699-ab18-4bfa-ab47-\
94a39592d131"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorCombine", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ConstantImage", "[", 
        RowBox[{"0", ",", "myDims"}], "]"}]}], "}"}], "]"}], "//", 
    "ImageAdjust"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Choose an image to check the transformation function and CLICK\>\"", 
     ",", 
     RowBox[{"nCheckImg", "=", "data"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"data", ",", "1", ",", 
     RowBox[{"Length", "[", "myFiles", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.648404118652545*^9, 3.648404125492936*^9}, {
  3.64856940301727*^9, 3.6485694140098987`*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"9e0f783a-83be-4b36-b042-ad4404b98106"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCheckBeadsRedImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nCheckImg", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myCheckBeadsGreenImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nCheckImg", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myCheckBeadsRedImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdRed"}], "]"}], "&"}]}], ",", 
       RowBox[{"myCheckBeadsGreenImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdGreen"}], "]"}], "&"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Choose thresholds and CLICK\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thcRed", "=", "thresholdRed"}], ",", 
       RowBox[{"thcGreen", "=", "thresholdGreen"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"thresholdRed", ",", "0.01", ",", "0.5", ",", "0.005"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"thresholdGreen", ",", "0.01", ",", "0.5", ",", "0.005"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6483887532573195`*^9, 3.648388796801996*^9}, {
  3.648390090354471*^9, 3.6483900905260715`*^9}, {3.648401539475024*^9, 
  3.648401539675036*^9}, {3.648401584090576*^9, 3.648401584226584*^9}, {
  3.6484016287071285`*^9, 3.6484016531065235`*^9}, {3.648404129261152*^9, 
  3.648404129388159*^9}, {3.648404642357499*^9, 3.6484046502619514`*^9}, {
  3.6485694291687655`*^9, 3.648569447672824*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"c1126c24-25bf-4de2-9628-f3bfce155909"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedCheckPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myCheckBeadsRedImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myCheckBeadsRedImg", ",", "thcRed"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenCheckPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myCheckBeadsGreenImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myCheckBeadsGreenImg", ",", "thcGreen"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{
  "\"\<   `` red particles and `` green particles were found.\>\"", ",", 
   RowBox[{"Length", "@", "myRedCheckPosGuess"}], ",", 
   RowBox[{"Length", "@", "myGreenCheckPosGuess"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.648388871717328*^9, 3.648388885414152*^9}, {
  3.648388936491642*^9, 3.648388950095866*^9}, {3.648390120868125*^9, 
  3.6483901256573334`*^9}, {3.6484015647394695`*^9, 3.6484015650184855`*^9}, {
  3.6484016700824947`*^9, 3.6484016702105017`*^9}, {3.64840316133979*^9, 
  3.6484031700442877`*^9}, {3.648569478513588*^9, 3.6485694871920843`*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"bf93fbe6-fd0d-41a7-973d-4e6d9f5b7f7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedCheckAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myCheckBeadsRedImg", ",", "myRedCheckPosGuess", ",", "7"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenCheckAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myCheckBeadsGreenImg", ",", "myGreenCheckPosGuess", ",", "7"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BeadsCheck", "[", 
  RowBox[{"myRedCheckAbsPos", ",", "myGreenCheckAbsPos", ",", "5"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.648401215122473*^9, 3.648401263490239*^9}, {
  3.6484014630346527`*^9, 3.6484014855149384`*^9}, {3.648401597930368*^9, 
  3.6484016073389063`*^9}, {3.648569513968616*^9, 3.648569544265349*^9}, {
  3.651524125722003*^9, 3.6515241367216325`*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"f9223ac0-ffb6-4882-a766-373c3d68a1c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["5. Making Mask ", "Section",
 CellChangeTimes->{{3.678650616049817*^9, 3.6786506203690643`*^9}, {
  3.678650695665371*^9, 3.678650698023505*^9}, {3.770033688116804*^9, 
  3.770033688822806*^9}, {3.7700382402804484`*^9, 
  3.7700382404706573`*^9}},ExpressionUUID->"798ad17a-aa7c-4fda-a3c8-\
f8a26b2b986a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FileExistsQ", "[", 
      RowBox[{"analysisFolder", "<>", "\"\<_avg.tif\>\""}], "]"}], "\[Equal]",
      "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"avgImg", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"analysisFolder", "<>", "\"\<_avg.tif\>\""}], "]"}]}], ";"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"avgImg", "=", 
      RowBox[{"Mean", "/@", "myColMovie"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"analysisFolder", "<>", "\"\<_avg.tif\>\""}], ",", "avgImg"}], 
      "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"analysisFolder", "<>", "\"\<_max.tif\>\""}], "]"}], 
       "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxImg", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"analysisFolder", "<>", "\"\<_max.tif\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"maxImg", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageApply", "[", 
           RowBox[{"Max", ",", "#"}], "]"}], "&"}], "/@", "myColMovie"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"analysisFolder", "<>", "\"\<_max.tif\>\""}], ",", 
         "maxImg"}], "]"}]}]}], "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7055111477125063`*^9, 3.7055111969763236`*^9}, {
   3.7058709149805884`*^9, 3.7058710723565903`*^9}, {3.7058711497490163`*^9, 
   3.705871156053377*^9}, 3.770033301189541*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"1160ea42-162f-4797-9e4a-4a1bbb0e28dc"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"avgImg", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
    "//", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], "&"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Choose threshold such that the shape of the cell can be visualized \
and CLICK\>\"", ",", 
     RowBox[{"thtemp", "=", 
      RowBox[{"{", 
       RowBox[{"threshold1", ",", "threshold2"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"threshold1", ",", "0", ",", "0.2", ",", "0.001"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.2", ",", 
     "0.001"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6783132865946865`*^9, 3.6783132885147963`*^9}, {
  3.678313358820818*^9, 3.6783133636430936`*^9}, {3.6955748346476974`*^9, 
  3.6955748638173656`*^9}, {3.6955749357044773`*^9, 3.695574948016182*^9}, {
  3.6957650148163805`*^9, 3.6957650240079064`*^9}, {3.7055112034406934`*^9, 
  3.705511216979468*^9}, {3.705513699339451*^9, 3.705513724942915*^9}, {
  3.705513771595584*^9, 3.7055137717225904`*^9}, {3.715278915078506*^9, 
  3.715278915238515*^9}, {3.715609597615465*^9, 3.715609597765474*^9}, {
  3.7700332948669004`*^9, 3.7700332957989063`*^9}},
 CellLabel->
  "In[485]:=",ExpressionUUID->"4d09fe1b-e05d-437f-a277-974f0ba38bd3"],

Cell[BoxData[
 RowBox[{"ImageAdjust", "[", 
  RowBox[{
   RowBox[{"avgImg", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "thtemp"}], "]"}]], "Input",
 CellChangeTimes->{{3.705511223008813*^9, 3.7055112427609425`*^9}, 
   3.705513781923174*^9, {3.715278924878066*^9, 3.7152789249820724`*^9}, {
   3.7156096127093287`*^9, 3.715609612853337*^9}, {3.7700333052365737`*^9, 
   3.7700333063147774`*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"d4d38ce9-1556-42f6-9442-9031a301cec7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mymask", "=", 
   GraphicsBox[
    TagBox[RasterBox[CompressedData["
1:eJzt082uVUUUReELLV/Dt7Br0y4+ASRoTxM0Mb69P8GgCNyza1fVWKvm+BJI
bsjJqTvH4us3P7/64eXT09MvX/3516vXv3377t3r37//64fvfvr17Y9v333z
5q9/fnr5/o8kSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZJ0uhd/
o18hxIsP6Kdotxcfod+jfT5u7wUE+XR8LyDBF9p7Aad7Nr4XcKzH2nsBR7oS
3ws4zOX4XkBzY8U9gbYmBfcCNhsee1VwL2CbbQlvonc6Ed30Gnqtw9A5B9CT
HYMOOYwe7gB0wpvo+Vqj401Bj9gV3W0WeseO6GYz0Vt2Q/eajd6zGTrXfPSi
rdCxFqAnbYROtQQ9ah90qTXoVdugQy1Cz9oF3WkVetcm6Ezr0Mu2QEdaiJ62
A7rRSvS2DdCJlqLHrY8utBa9bnl0oMXoeYuj8yxHD1wbXWcDeuLK6DY70BsX
RqfZgh65LrrMHvTKZdFhNqFnrorusgu9c1F0ln3opUuio2xET10R3WQneuuC
6CRb0WOXQwfZjJ67GrrHbvTexdA59qMXL4WOAaAnr4RuQaA3r4MuwaBXr4Lu
QKF3L4LOgKGHL4GOAKKnL4BOwKLXp9H70+j9WfT6PLoAid6+AroBh16+BroC
hh6+CDoDhd69DDoEg169DroEgh69EDoFgd68EroFgJ68FrrGbvTe1dA9NqPn
rocushU9dkF0kp3orUuio+xDL10TXWUbeuiq6C6b0DOXRYfZg165MDrNDvTG
ldFtNqAnLo2Osx69cHF0ntXofauj+yxGz1sfXWgletsO6EYL0dP2QFdahh62
CTrTKvSubdCh1qBX7YMutQQ9aid0qwXoSVuhY81HL9oMnWs2es9u6F6T0XO2
Qwebi16zITrZTPSWHdHNJqKn7ImuNgu9Y1d0t0noGfuiy01Bj9gYnW4GesPW
6Hj30Qv2Rte7jR6wO7rfTfR87dEB76HXOwCd8A56uxPQDW+gpzsCHXEcvdwh
6Iyj6N1OQXccRM92DDrkEHq0g9ApR9CbHYWOeR292FnompfRgx2GznkVvddp
6J4X0XMdhw56Db3Weeiil9BjnYhuegE91ZHoqA+jhzoUnfVB9EzHosM+hl7p
XHTZR9AbHY2O+zx6obPRdZ9D73M6uu8z6HmORwf+InqcAHTiL6G3SUA3/jx6
mRB05s+gZ4lBh/40epUcdOlPoTdJQrf+BHqSKHTs/6EHCUPn/hi9Rxw6+H/Q
YwSik/8bvUUiuvkH9BKZ6Or/oHdIRXd/j54hFh3+b/QIyej2T+ZH0fGtzzJ/
NutnM38264ezfjbzZ7N+NvNns34282ezfjbzZ7N+OOtns34262ezfjbzZ7N+
Nutns34262czfzbrZ7N+OOtns34262czfzbrZ7N/NvNns38282ezfzb7hzN/
NvtnM382+2czfzb7Z7N/NvNns38282ezfzj7ZzN/NvtnM382+2ezfzbzZ7N/
NvNns38282ezfzb7RzN/tFv57d+e/aOZP5v9o93Lb//u7B/N/NFu5rd/c/aP
dje//XszfzT/+0e7nd/+rdk/mvmz2T/a/fz2b2xCfvs3Zv5oE/LbvzH7R5uR
3/5tmT+b/aNNyW//tuwfzfzR5uS3f1f2jzYpv/2bMn+0Sfnt39Os/Pbvyf7R
zJ/N/tGm5bd/R/Py278j80ebl9/+Hdk/2sT89m/I/NEm5rd/Q/aPNjO//fsx
f7SZ+e3fj/2jTc1v/27Mn83+0ebmt3839o9m/mz2jzY5v/2bsX8082ezf7TZ
+e3fi/2jTc9v/1bm9/cAGlmQ3/59rMhv/z6W9PcAuliT3/5d2D/aovweQBP2
j7Ysv/1bWNffA2hgYX77N2D/aCvzewD12T/a2vz2L25xfg+gOPtHW57f/qWt
7+8BFLYhv/0Ls3+0Hfk9gLrsH21PfvtXtam/B1DTrvz2r8n+0bbl9wBKsv8R
RsfdmN8DWGhw4K357b/O4Mz2P8TY1nvzewDLDO69Nf4D79GgsdU3VX/gJbpn
bPr1wR95he4bmn9p6UceoFmGGqyK/Mh3a6qREvPrPvS1mg9JOYRe6kx01cfR
S52JrnoBPdWR6KgX0FMdiY56Bb3VieimV9BbHYhOegk91oHopNfQa52HLnoN
vdZ56KLX0Gudhy56ET3XaeieV9F7HYbOeRk92FnomgPoyY5CxxxAT3YSuuUQ
erRz0CXH0Ksdgw45iJ7tFHTHYfRwZ6ArjqOXOwNdcRy93BHoiHfQ2x2ATngL
PV5/dMF76PXaowPeRe/XHd3vLnq/5uh899ELtkbHW4Yetge60kL0tB3QjZai
x22ATrQUPW59dKHF6Hmro/usRu9bHJ1nPXrh0ug4O9AbF0an2YIeuTA6zR70
ymXRYTahZ66K7rINPXRNdJWN6KkropvsRG9dEd1kK3rseugie9Frl0MH2Y3e
uxg6x3704qXQMQD05KXQMQj05nXQJRj06jXQFUD09Dg6AI3eH0WPXwCdAEMP
XwXdgUBvXgndYjt68GroHjvRW1dEN9mInromuso+9NJF0Vl2oXcuiw6zCT1z
XXSZPeiVC6PT7EBvXBodZwN64troOsvRA1dH91mN3rc8OtBa9Lr10YXWotdt
gE60Er1tC3Skhehpe6ArPWv4ifSyTUyNtcDoG+ld25gdbK7hR6KbtjI/2jzD
r+Tm7GdozpGal41/46bpzjA03cTMj1Yc/qAWWJf98xXHP6npVqb/bMTxT2o2
IP9j37pzhGRI/we+dt8C4ZD8z37vpl9eCw+A/sX0GPOHs38484czfzjzh7N/
OvOHM38484ezfzjzhzN/OPOHs38484czfzjrh7N+OOuns34444ezfjjrh7N+
OOuHs34466ezfjjrS5IkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZKW+QPsG/6Q
      "], {{0, 512.}, {512., 0}}, {0, 1},
      ColorFunction->GrayLevel,
      ImageResolution->72.],
     BoxForm`ImageTag[
     "Bit", ColorSpace -> Automatic, Interleaving -> None, Magnification -> 
      Automatic],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSize->Automatic,
    ImageSizeRaw->{512., 512.},
    PlotRange->{{0, 512.}, {0, 512.}}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ",", "mymask"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.695765046835212*^9, 3.6957650613840446`*^9}, {
   3.7055137992181635`*^9, 3.705513800518238*^9}, {3.7136419255917816`*^9, 
   3.713641926390827*^9}, {3.7152789467933197`*^9, 3.7152789476543694`*^9}, {
   3.7156096401608987`*^9, 3.7156096508625107`*^9}, {3.715638199950425*^9, 
   3.715638201410509*^9}, {3.7700338284675865`*^9, 3.7700338298874083`*^9}, 
   3.773076316951456*^9, 3.77359354775279*^9, 3.8014469613550005`*^9, 
   3.8014475880277424`*^9, 3.801448077528078*^9, 3.8014485147157335`*^9, 
   3.8066835658811874`*^9, {3.817575680087644*^9, 
   3.8175756811671467`*^9}},ExpressionUUID->"dcd1b07d-5b03-4bd3-a44a-\
ea5805da3473"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"mymask", "=", 
     RowBox[{"Image", "@", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"ImageDimensions", "@", "avgImg"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ",", "mymask"}], 
     "]"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.69506642241996*^9, 
  3.6950664612671824`*^9}},ExpressionUUID->"68bc5636-aeb2-45b5-b382-\
cd58e8905a24"]
}, Closed]],

Cell[CellGroupData[{

Cell["6. Running z-average ", "Section",
 CellChangeTimes->{{3.642337220641624*^9, 3.642337230681198*^9}, {
   3.678313774559597*^9, 3.6783137753366413`*^9}, 3.6783160899130273`*^9, {
   3.7700382421078634`*^9, 
   3.770038242317065*^9}},ExpressionUUID->"f5e0175e-6fef-40b0-b00d-\
4be05d7929a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"avgFrameN", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avgFrameN", ">>", 
   RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}]}], ";", 
  RowBox[{"myMaxN", "=", 
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{
     "myColMovie", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "-", "avgFrameN", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6423382732288284`*^9, 3.6423382777220855`*^9}, {
   3.642338308730859*^9, 3.6423383088428655`*^9}, {3.6423386993952036`*^9, 
   3.6423387003632593`*^9}, {3.6423387599876695`*^9, 3.642338760298687*^9}, {
   3.642338798179854*^9, 3.6423388086594534`*^9}, {3.6483102143678484`*^9, 
   3.6483102325378737`*^9}, {3.6515228854160624`*^9, 
   3.6515228856970778`*^9}, {3.678313684729459*^9, 3.6783136848644667`*^9}, {
   3.678313715858239*^9, 3.6783137159772463`*^9}, {3.678648513961624*^9, 
   3.6786485140406284`*^9}, {3.6786530916647177`*^9, 
   3.6786530917427177`*^9}, {3.6956781456757503`*^9, 
   3.6956781481148896`*^9}, {3.695678411442951*^9, 3.695678438243484*^9}, {
   3.6957538378230934`*^9, 3.695753838743146*^9}, {3.6957638950063314`*^9, 
   3.69576389515834*^9}, {3.7137100659231853`*^9, 3.713710086960389*^9}, 
   3.71689814039779*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"9c866b6b-158a-487a-9334-8282d267657f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myColMovieRunAv", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"avgFrameN", "\[Equal]", "1"}], ",", "myColMovie", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MovingAverage", "[", 
        RowBox[{"#", ",", "avgFrameN"}], "]"}], "&"}], "/@", "myColMovie"}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6956781416385193`*^9, 3.695678158387477*^9}, {
   3.6956782375380044`*^9, 3.695678284475689*^9}, {3.695753807128338*^9, 
   3.695753821922184*^9}, {3.695763975719948*^9, 3.6957639916228576`*^9}, 
   3.7055139286475663`*^9, 3.7168280275835657`*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"ebe44680-33b5-41b9-b8c2-09250d0321b6"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"myColMovieRunAv", "\[LeftDoubleBracket]", 
     RowBox[{"channel", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "threshold"}], "}"}]}], "]"}], "&"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"channel", ",", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "myColMovieRunAv"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"frame", ",", "1", ",", "myMaxN", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"threshold", ",", "0", ",", "0.3", ",", "0.001"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6423394014173574`*^9, 3.6423395160839157`*^9}, {
   3.642339667932601*^9, 3.642339669964717*^9}, {3.642730012083584*^9, 
   3.6427300144273615`*^9}, {3.6440626622445326`*^9, 
   3.6440626650956955`*^9}, {3.648470544066861*^9, 3.6484705464579983`*^9}, {
   3.6484720136119146`*^9, 3.648472071787242*^9}, {3.6515229410892463`*^9, 
   3.6515229458695197`*^9}, 3.6806250245689616`*^9, 3.6833957314826455`*^9, {
   3.695066507491826*^9, 3.695066550452283*^9}, {3.6957640277119217`*^9, 
   3.6957640278319283`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"86135c3e-dbaa-492f-b660-5c1768e9e4cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["7. Setting Threshold", "Section",
 CellChangeTimes->{{3.7130439866561804`*^9, 3.71304400658432*^9}, {
  3.770038246582097*^9, 
  3.7700382468160973`*^9}},ExpressionUUID->"c9536367-4408-4758-aefc-\
011cbb221521"],

Cell[BoxData[
 RowBox[{"MyThresholding", "[", 
  RowBox[{"myColMovieRunAv", ",", "analysisFolder"}], "]"}]], "Input",
 CellChangeTimes->{{3.713115515893419*^9, 3.7131155268860474`*^9}, {
   3.713117412803916*^9, 3.713117414540015*^9}, 3.7166680862224436`*^9, 
   3.7168981514864235`*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"5b3da281-c27a-459a-badf-58874dfdd6d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["8. Setting Threshold for Binarization", "Section",
 CellChangeTimes->{{3.7131099018533144`*^9, 3.7131099109658356`*^9}, {
  3.7131101185817103`*^9, 3.7131101194047575`*^9}, {3.7700382495047073`*^9, 
  3.770038249785508*^9}},ExpressionUUID->"e9fa7b50-9f9b-4225-9c9d-\
777f655bd22d"],

Cell[BoxData[
 RowBox[{"MyBinarization", "[", 
  RowBox[{"myColMovieRunAv", ",", "analysisFolder"}], "]"}]], "Input",
 CellChangeTimes->{{3.7131188291479263`*^9, 3.713118859584667*^9}, {
   3.7131836841294193`*^9, 3.713183698416236*^9}, {3.713184199073872*^9, 
   3.7131841992168803`*^9}, {3.713184696506324*^9, 3.713184696665333*^9}, {
   3.713187330148959*^9, 3.7131873342991967`*^9}, {3.7131877433565936`*^9, 
   3.7131877434836006`*^9}, 3.7131879096671057`*^9, 3.7131882847335587`*^9, 
   3.713208276253008*^9, 3.716668711232192*^9, 3.716670213233102*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"04c0c7d5-bd82-455a-8743-30762a43e503"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Tracking Particles", "Chapter",
 CellChangeTimes->{{3.7700333929707584`*^9, 3.7700333942643757`*^9}, {
  3.770033547115425*^9, 3.7700335492340417`*^9}, {3.7700336771325274`*^9, 
  3.770033677434928*^9}, {3.7700382158260794`*^9, 3.770038217065284*^9}, {
  3.7700391734546394`*^9, 3.770039175063244*^9}, {3.7700523255023074`*^9, 
  3.7700523275861115`*^9}},ExpressionUUID->"4de08094-d19f-4c1f-a074-\
e6c163332958"],

Cell[CellGroupData[{

Cell["A. Tracking mRNAs Globally", "Section",
 CellChangeTimes->{{3.770033397362591*^9, 3.7700334071132593`*^9}, {
  3.7700335854434657`*^9, 3.770033601852979*^9}, {3.770033699906296*^9, 
  3.7700337002416983`*^9}, {3.77003471867654*^9, 3.7700347303328342`*^9}, {
  3.7700382197850943`*^9, 3.770038220388111*^9}, {3.770039179235676*^9, 
  3.7700391815482993`*^9}, {3.770052263505929*^9, 
  3.7700522648517475`*^9}},ExpressionUUID->"9876c223-22f1-4597-b380-\
68286b67dc8f"],

Cell[CellGroupData[{

Cell["1. Tracking", "Subsection",
 CellChangeTimes->{{3.7700381950811205`*^9, 
  3.770038199893955*^9}},ExpressionUUID->"25391013-be8b-47af-a592-\
21d927b1b681"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"redSpots", "=", 
   RowBox[{"MyParticleFinder", "[", 
    RowBox[{"myColMovieRunAv", ",", "1", ",", "analysisFolder"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"myColMovieRunAv", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
      RowBox[{
       RowBox[{"ImageAdjust", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "thred"}], "]"}], 
       "&"}]}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Circle", "[", 
           RowBox[{"#", ",", "7"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"redSpots", "\[LeftDoubleBracket]", 
           RowBox[{"frame", ",", "All", ",", "3", ",", "1"}], 
           "\[RightDoubleBracket]"}], ")"}]}]}], "}"}], "]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<CLICK if you want to save this dataset\>\"", ",", 
     RowBox[{
      RowBox[{"redSpots", ">>", 
       RowBox[{"analysisFolder", "<>", "\"\<_redspots.dat\>\""}]}], ";"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"frame", ",", "1", ",", 
     RowBox[{"Length", "@", 
      RowBox[{
      "myColMovieRunAv", "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7700345719240923`*^9, 3.7700345995793033`*^9}, {
  3.7700347149887257`*^9, 3.770034715675929*^9}, {3.7700347753341637`*^9, 
  3.770034791740078*^9}, {3.770051924832451*^9, 3.7700519250352516`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"9d8a1c32-3890-4a3b-bfbe-6d149ef9e64d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Linking", "Subsection",
 CellChangeTimes->{{3.770038205252399*^9, 
  3.7700382067692137`*^9}},ExpressionUUID->"ae4f90bd-524d-45dc-93e7-\
4b56f8e2a531"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxJumpDistRed", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shortestTrackRed", "=", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6484765380766993`*^9, 3.6484765505344114`*^9}, {
  3.6485791838487015`*^9, 3.648579204208866*^9}, {3.678316141946004*^9, 
  3.6783161778030543`*^9}, {3.67831628944344*^9, 3.6783162895144444`*^9}, {
  3.6783163214922733`*^9, 3.678316321762288*^9}, {3.6783163693640113`*^9, 
  3.6783163761714*^9}, {3.678316418771837*^9, 3.6783164188668423`*^9}, {
  3.6783164783402443`*^9, 3.678316478683264*^9}, {3.7700383511782303`*^9, 
  3.770038351396631*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"01404b92-576d-469a-aabf-2c35770739f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myredtracks", "=", 
   RowBox[{"LinkTracks2", "[", 
    RowBox[{
     RowBox[{"redSpots", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "3", ",", "1"}], 
      "\[RightDoubleBracket]"}], ",", "maxJumpDistRed"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myredtracks", ">>", 
   RowBox[{"analysisFolder", "<>", "\"\<_redtracks.dat\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{
  "\"\<`` red tracks were found by allowing `` pixel jump, and the average \
length of the tracks is ``\>\"", ",", 
   RowBox[{"myredtracks", "//", "Length"}], ",", "maxJumpDistRed", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Length", "/@", "myredtracks"}], ")"}], "//", "Mean"}], "//", 
    "N"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.642538579958152*^9, 3.642538586658161*^9}, {
   3.642538786164441*^9, 3.6425387862844415`*^9}, {3.642883694363701*^9, 
   3.6428836961238017`*^9}, {3.6428866887429695`*^9, 3.642886725174053*^9}, {
   3.642886823230662*^9, 3.642886828141943*^9}, {3.643139322152774*^9, 
   3.643139391104718*^9}, {3.64313945425633*^9, 3.6431394638798804`*^9}, {
   3.6431395717610507`*^9, 3.6431396151045303`*^9}, {3.6431400019896584`*^9, 
   3.643140002560691*^9}, {3.6431415705373745`*^9, 3.6431415942497306`*^9}, {
   3.6431416834658337`*^9, 3.6431416894341745`*^9}, {3.643141863171112*^9, 
   3.643141865746259*^9}, {3.643473089089744*^9, 3.643473106553743*^9}, {
   3.648475694477448*^9, 3.648475701765865*^9}, {3.648476554158619*^9, 
   3.6484765642621965`*^9}, {3.648477027086669*^9, 3.6484770373752575`*^9}, {
   3.648579056232402*^9, 3.6485790602726336`*^9}, {3.6485793513222804`*^9, 
   3.648579354025435*^9}, {3.6485854937596073`*^9, 3.6485855238063264`*^9}, {
   3.649177306571166*^9, 3.649177324329824*^9}, {3.649372827183387*^9, 
   3.649372830471014*^9}, {3.678648827753572*^9, 3.6786488625615625`*^9}, {
   3.708253323883111*^9, 3.7082533299185143`*^9}, 3.708257051402505*^9, {
   3.7700382926138167`*^9, 3.7700383312086906`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"ae2ba3c5-71af-4042-8fbb-411b58d4d06c"],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*RowBox[{\\\"312\\\"}]\\) red tracks were \
found by allowing \\!\\(\\*RowBox[{\\\"10\\\"}]\\) pixel jump, and the \
average length of the tracks is \
\\!\\(\\*RowBox[{\\\"11.538461538461538`\\\"}]\\)\"\>",
  StringForm[
  "`` red tracks were found by allowing `` pixel jump, and the average length \
of the tracks is ``", 312, 10, 11.538461538461538`],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.7700383396925364`*^9, 3.770051952922807*^9, 3.770383553130675*^9, 
   3.773076513093052*^9, 3.773593733673857*^9, 3.801447155782094*^9, 
   3.8014477709812*^9, 3.801448221034567*^9, {3.801448592686043*^9, 
   3.8014486055930843`*^9}, 3.806683682932706*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"006aab16-d911-47bc-be74-eed79748f9fc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mylongredtracks", "=", 
   RowBox[{"myredtracks", "//", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"Length", "[", "x", "]"}], "<", "shortestTrackRed"}]}]}], 
      "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mylongredtracks", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "mylongredtracks"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{
  "\"\<   `` red tracks are longer than ``, and the average length of the \
long tracks is ``\>\"", ",", 
   RowBox[{"mylongredtracks", "//", "Length"}], ",", "shortestTrackRed", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Length", "/@", "mylongredtracks"}], ")"}], "//", "Mean"}], "//",
     "N"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6425389130486193`*^9, 3.6425389355786514`*^9}, {
  3.642538966830695*^9, 3.642538972310703*^9}, {3.6425399119100266`*^9, 
  3.6425399119700265`*^9}, {3.6428837130837717`*^9, 3.642883717557028*^9}, {
  3.6434731736335793`*^9, 3.643473178601864*^9}, {3.648475205109458*^9, 
  3.6484752053814735`*^9}, {3.6484757139595623`*^9, 3.648475842221898*^9}, {
  3.648475908638697*^9, 3.648475908965716*^9}, {3.7700396865095215`*^9, 
  3.770039707985656*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"063e4325-8237-4b6e-9c27-6d8d549fb13e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Hand-checking for Split Track by Mistake", "Subsection",
 CellChangeTimes->{{3.7700391873293357`*^9, 3.7700391887305408`*^9}, {
  3.7700393168774137`*^9, 
  3.7700393454093947`*^9}},ExpressionUUID->"abf16ff0-df35-48d8-94df-\
859c83e04111"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", "15"}], ";", 
  RowBox[{"time", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myHandCheckedTracksr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
      "#"}], "&"}], "/@", "mylongredtracks"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6805426942947645`*^9, 3.6805427035082912`*^9}, {
  3.680546796845417*^9, 3.6805467976134615`*^9}, {3.6838965655541315`*^9, 
  3.683896570121393*^9}, {3.7700402020278482`*^9, 3.7700402022958508`*^9}, {
  3.7700650295021653`*^9, 3.770065030496222*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"c6351005-890c-4282-948b-4eb159cf30e5"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"listConnectTracks", ",", "posiConnectTracks"}], "}"}], "=", 
     RowBox[{"FindConnectableTracks2", "[", 
      RowBox[{
      "myHandCheckedTracksr", ",", "myMaxN", ",", "dist", ",", "time", ",", 
       "trackN"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"myColMovieRunAv", "\[LeftDoubleBracket]", 
           RowBox[{"channel", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"ImageAdjust", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"channel", "\[Equal]", "1"}], ",", "thred", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"channel", "\[Equal]", "2"}], ",", "thgreen", ",", 
                 "thblue"}], "]"}]}], "]"}]}], "]"}], "&"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Circle", "[", 
               RowBox[{"#", ",", "7"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"posiConnectTracks", "\[LeftDoubleBracket]", 
               RowBox[{"frame", ",", "2", ",", "All", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], 
              ")"}]}], ",", "Green", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{"{", 
                  RowBox[{"10", ",", "10"}], "}"}]}]}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"posiConnectTracks", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "2", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"posiConnectTracks", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "2", ",", "All", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}], ")"}]}]}], "}"}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Thread", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\"\<track \>\"", "<>", "#"}], "&"}], "/@", 
                RowBox[{
                 RowBox[{"CharacterRange", "[", 
                  RowBox[{"\"\<A\>\"", ",", "\"\<F\>\""}], "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{";;", 
                  RowBox[{
                   RowBox[{"Length", "@", "listConnectTracks"}], "-", "1"}]}],
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"\"\<track \>\"", " ", "<>", "#"}], "&"}], "/@", 
                RowBox[{"ToString", "/@", 
                 RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], ",", 
               RowBox[{"myHandCheckedTracksr", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "1", 
                 ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Last", "/@", 
                  RowBox[{"myHandCheckedTracksr", "\[LeftDoubleBracket]", 
                   RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2", ",", "1"}], 
                "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Current track\>\"", ",", 
              RowBox[{"\"\<track \>\"", " ", "<>", 
               RowBox[{"ToString", "@", "trackN"}]}], ",", 
              RowBox[{"myHandCheckedTracksr", "\[LeftDoubleBracket]", 
               RowBox[{"trackN", ",", "1", ",", "2", ",", "1"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Last", "@", 
                 RowBox[{
                 "myHandCheckedTracksr", "\[LeftDoubleBracket]", "trackN", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<track\>\"", ",", "\"\<track number\>\"", ",", "\"\<Start\>\"",
             ",", "\"\<End\>\""}], "}"}]}], "]"}], "//", "TableForm"}], ",", 
       "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<The number of all tracks is \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "myHandCheckedTracksr"}]}]}]}], "}"}]}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Click to Save Handchecked Tracks\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myRNAtracks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], 
              "}"}]}], "}"}], "&"}], "/@", "#"}], "&"}], "/@", 
        "myHandCheckedTracksr"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myRNAtracks", ">>", 
       RowBox[{
       "analysisFolder", "<>", "\"\<_RedTracksHandChecked.dat\>\""}]}], 
      ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Spacer", "@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "15"}], "}"}]}], " ", ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Click to Connect\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chosenTracks", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "trackA", ",", "trackB", ",", "trackC", ",", "trackD", ",", 
                "trackE", ",", "trackF"}], "}"}], ",", "True"}], "]"}]}], "//",
            "Flatten"}], "\[RightDoubleBracket]"}], ",", "trackN"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"myHandCheckedTracksr", "=", 
       RowBox[{"ConnectTracksFilled", "[", 
        RowBox[{"myHandCheckedTracksr", ",", "chosenTracks"}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Print", "@", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Dynamic", "/@", 
         RowBox[{"(", 
          RowBox[{"ToExpression", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<track\>\"", "<>", "#"}], "&"}], "/@", 
             RowBox[{"CharacterRange", "[", 
              RowBox[{"\"\<A\>\"", ",", "\"\<F\>\""}], "]"}]}], ")"}]}], 
          ")"}]}], ",", "True"}], "]"}]}], "*)"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", "\"\<Remove This Point\>\"", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", "\"\<Split Tracks from This Frame\>\"", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Delete This Track\>\"", ",", 
     RowBox[{"myHandCheckedTracksr", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"myHandCheckedTracksr", ",", "trackN"}], "]"}]}]}], "]"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"channel", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackN", ",", "1", ",", 
     RowBox[{"Length", "@", "myHandCheckedTracksr"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"frame", ",", "1", ",", "myMaxN", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackA", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackB", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackC", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackD", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackE", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"trackF", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6791405409401803`*^9, 3.679140544156364*^9}, {
   3.6791405777482853`*^9, 3.6791406991002264`*^9}, {3.679141227253435*^9, 
   3.679141243133343*^9}, 3.6791416115494156`*^9, {3.6791423436412888`*^9, 
   3.67914237495008*^9}, {3.6791425449578037`*^9, 3.6791425459738617`*^9}, {
   3.679142578238707*^9, 3.679142596501752*^9}, {3.679142884183206*^9, 
   3.6791429925904064`*^9}, {3.6791458490807886`*^9, 3.679145859096361*^9}, {
   3.679145935720744*^9, 3.6791459405290194`*^9}, {3.679146240353168*^9, 
   3.6791462420652657`*^9}, {3.6791463173125696`*^9, 
   3.6791463396338463`*^9}, {3.6791466980983496`*^9, 3.679146727090008*^9}, {
   3.679147283242818*^9, 3.6791473090102916`*^9}, {3.679147754882794*^9, 
   3.6791477649783716`*^9}, {3.6791477950660925`*^9, 
   3.6791478159382863`*^9}, {3.679147949122904*^9, 3.679147964698795*^9}, {
   3.6791522036222477`*^9, 3.679152242254457*^9}, {3.6791524626790648`*^9, 
   3.679152502358334*^9}, {3.67915365882248*^9, 3.679153678031579*^9}, {
   3.6791557420656347`*^9, 3.6791557556174097`*^9}, {3.6791571558825006`*^9, 
   3.6791573251551824`*^9}, {3.679157355522919*^9, 3.679157361746275*^9}, {
   3.679157507259598*^9, 3.679157515916093*^9}, {3.679157663787551*^9, 
   3.6791576652586355`*^9}, {3.679160009431714*^9, 3.6791600144690027`*^9}, {
   3.6791603747416086`*^9, 3.6791604669168806`*^9}, {3.679160559629184*^9, 
   3.679160690568673*^9}, {3.6791607311019917`*^9, 3.6791607721743402`*^9}, {
   3.6791608325907965`*^9, 3.6791609797582135`*^9}, {3.6791611280866976`*^9, 
   3.6791611717331944`*^9}, {3.67916241386324*^9, 3.6791624601108847`*^9}, {
   3.679169673684478*^9, 3.679169686788227*^9}, {3.679170747765912*^9, 
   3.679170748149934*^9}, {3.6791707965537024`*^9, 3.679170800065903*^9}, {
   3.6791711629416585`*^9, 3.679171173389256*^9}, {3.679171231750594*^9, 
   3.6791712500296392`*^9}, {3.679171286693737*^9, 3.679171319357605*^9}, {
   3.679171400375239*^9, 3.6791714139420147`*^9}, {3.679171699502348*^9, 
   3.679171706374741*^9}, {3.6791717403746853`*^9, 3.679171745501979*^9}, {
   3.679171781397032*^9, 3.6791718025742435`*^9}, {3.679171886662053*^9, 
   3.679171900678855*^9}, {3.679171983558595*^9, 3.6791719948622417`*^9}, {
   3.679172082622261*^9, 3.6791721306630087`*^9}, {3.6791721777427015`*^9, 
   3.679172303814913*^9}, {3.679174750112833*^9, 3.679174752384963*^9}, {
   3.6791748813523397`*^9, 3.679174898833339*^9}, {3.679174983944207*^9, 
   3.6791750142809424`*^9}, {3.6792266990261407`*^9, 
   3.6792267128899336`*^9}, {3.6792268030420904`*^9, 3.679226808377395*^9}, {
   3.679226933746566*^9, 3.679226976554014*^9}, {3.6792511288614473`*^9, 
   3.679251134389764*^9}, {3.6792512365506067`*^9, 3.6792512694864907`*^9}, {
   3.6792513009892926`*^9, 3.6792513050785265`*^9}, {3.67925519784918*^9, 
   3.6792552135210767`*^9}, {3.6792554347217283`*^9, 
   3.6792554618252788`*^9}, {3.6792555284340887`*^9, 
   3.6792555515614114`*^9}, {3.6792555999931817`*^9, 3.679255645385778*^9}, {
   3.6792557984815345`*^9, 3.6792558017067184`*^9}, {3.679255834907618*^9, 
   3.6792559804659433`*^9}, {3.6792560130938096`*^9, 
   3.6792560154659452`*^9}, {3.6792561058181133`*^9, 
   3.6792561147616243`*^9}, {3.679258013467224*^9, 3.679258026276957*^9}, {
   3.6792617166470337`*^9, 3.6792617192071805`*^9}, {3.679261851439744*^9, 
   3.6792618529188285`*^9}, {3.6805402441526246`*^9, 3.680540259577507*^9}, {
   3.6805403045170774`*^9, 3.680540336873928*^9}, {3.6805426139721704`*^9, 
   3.680542649611209*^9}, {3.6833964917241287`*^9, 3.6833965380837803`*^9}, 
   3.702601383642167*^9, 3.70824947307074*^9, {3.770040274968336*^9, 
   3.7700405479406157`*^9}, {3.770052045502932*^9, 3.7700520605828133`*^9}, {
   3.7700521731144333`*^9, 3.7700521760752573`*^9}, {3.7700522075050287`*^9, 
   3.770052218442687*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"008bac0b-8c4f-4e42-be4d-3c0ac110a59d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["B. Tracking Particular Particles (Click-and-Track)", "Section",
 CellChangeTimes->{{3.7165761125008473`*^9, 3.716576130148857*^9}, {
  3.7700335769559903`*^9, 3.7700335951787405`*^9}, {3.7700337032267094`*^9, 
  3.7700337088969464`*^9}, {3.770038222722322*^9, 
  3.770038223011123*^9}},ExpressionUUID->"75956577-5f5e-4018-98c3-\
6e4f4ed09f60"],

Cell[CellGroupData[{

Cell["1. Tracking", "Subsection",
 CellChangeTimes->{{3.770039195313981*^9, 
  3.7700391990948086`*^9}},ExpressionUUID->"eb91998e-144b-4d32-b5fc-\
4566c512d5db"],

Cell[BoxData[
 RowBox[{"ClickAndTrack", "[", 
  RowBox[{"myColMovie", ",", "myColMovieRunAv", ",", "analysisFolder"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.716804151572936*^9, 3.7168041516989436`*^9}, {
   3.716804191195203*^9, 3.7168041912992086`*^9}, {3.716805949692783*^9, 
   3.716805949852792*^9}, {3.716806897637002*^9, 3.7168068977730103`*^9}, {
   3.716806987543144*^9, 3.7168069876691513`*^9}, {3.7168070775272913`*^9, 
   3.71680708694983*^9}, 3.7169294613592463`*^9},
 CellLabel->
  "In[994]:=",ExpressionUUID->"f6aa38c8-ed04-4bf7-b02e-d0d7710476c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Reading in Saved Tracks", "Subsection",
 CellChangeTimes->{{3.7700528851894875`*^9, 3.7700528980917535`*^9}, {
  3.7701291754431033`*^9, 
  3.77012917573812*^9}},ExpressionUUID->"01822993-2c53-468b-9f61-\
f7c9e9a0fcbf"],

Cell[CellGroupData[{

Cell["A. Checking All Track Files", "Subsubsection",
 CellChangeTimes->{{3.77013873589493*^9, 
  3.7701387679357624`*^9}},ExpressionUUID->"a357046a-103f-44e6-8a6f-\
d35cfbb127b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRNAtrackFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*myTrack_red*\>\"", ",", 
     RowBox[{"DirectoryName", "@", "analysisFolder"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "@", "myRNAtrackFiles"}]}], "Input",
 CellChangeTimes->{{3.7174428116969347`*^9, 3.7174428964557824`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"21eb0f1d-43cb-45bf-94e5-e069c5aaacb9"]
}, Closed]],

Cell[CellGroupData[{

Cell["B. Reading in Saved Files", "Subsubsection",
 CellChangeTimes->{{3.7701387721910057`*^9, 
  3.7701387789573927`*^9}},ExpressionUUID->"c2843344-1aec-404d-a1b2-\
5af8461188d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRNAtracks", "=", 
   RowBox[{"Get", "/@", "myRNAtrackFiles"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myRNAtracks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}]}]}]}], "]"}], "&"}], "/@", 
    "myRNAtracks"}]}], ";"}]}], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"f808f68c-2285-4e43-9266-00ca07cc5095"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Making Crops", "Chapter",
 CellChangeTimes->{{3.7700526264952173`*^9, 
  3.7700526356516705`*^9}},ExpressionUUID->"355c1741-c205-4edb-9218-\
888f1f408c3c"],

Cell[CellGroupData[{

Cell["1. Making Crops", "Section",
 CellChangeTimes->{{3.7700624775562024`*^9, 
  3.770062482546488*^9}},ExpressionUUID->"fd0f54bb-73cf-48cd-986f-\
f5d2297b9c79"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"myCrops", ",", "myCropsAvg"}], "}"}], "=", 
   RowBox[{"MyCropMaker", "[", 
    RowBox[{
    "myColMovie", ",", "myRNAtracks", ",", "7", ",", "analysisFolder"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770061739315977*^9, 3.77006176401439*^9}, {
   3.770062012161583*^9, 3.7700620183049345`*^9}, 3.7700623283096657`*^9, 
   3.770062485718669*^9, {3.770142033302531*^9, 3.7701420355866613`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"42a8eae8-e7ed-46d4-ab0c-8f80514999cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
2. Categorizing into Red-only, Yellow, Purple, and White Spots\
\>", "Section",
 CellChangeTimes->{{3.7700624888408475`*^9, 3.770062523130809*^9}, {
  3.770062866210432*^9, 
  3.770062889373757*^9}},ExpressionUUID->"ce8820da-d8be-4171-9fa4-\
1dd691e2228e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"myAvgCropsCategorized", ",", "myRNAtracksCategorized"}], "}"}], 
   "=", 
   RowBox[{"MyAutoCategorization", "[", 
    RowBox[{"myCropsAvg", ",", "myRNAtracks", ",", "1", ",", "4"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7700625491562977`*^9, 3.770062596845025*^9}, {
   3.770062989323474*^9, 3.7700630229613976`*^9}, 3.7700630862420173`*^9, {
   3.7700634329308467`*^9, 3.7700634370050793`*^9}, {3.770063854288947*^9, 
   3.7700638691517973`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"82d0ea1e-3b13-42c1-9613-72a87185dec0"]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Hand-checking the Auto Categorized Spots", "Section",
 CellChangeTimes->{{3.7700630506529818`*^9, 3.7700630791426115`*^9}, {
  3.7700644785986557`*^9, 
  3.77006447886067*^9}},ExpressionUUID->"5f73797f-c66d-4bda-95d5-\
b57e8a15efaa"],

Cell[BoxData[
 RowBox[{"MyCategoryHandChecker", "[", 
  RowBox[{"myAvgCropsCategorized", ",", "myRNAtracksCategorized"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.770123980035943*^9, 3.7701240147619295`*^9}, {
  3.770125063461911*^9, 3.7701250668051023`*^9}, {3.7701291120504775`*^9, 
  3.770129113203543*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"33b5807e-9815-4b93-a42b-5e8467a8329e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. Fitting Particles", "Chapter",
 CellChangeTimes->{{3.7700336460837*^9, 3.770033649005509*^9}, {
  3.770033681338159*^9, 3.770033682367563*^9}, {3.7700526429321027`*^9, 
  3.770052643181703*^9}},ExpressionUUID->"19a0d227-af9c-4a95-81bc-\
41e23152f003"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myRNAtracksHC", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_myRNAtracksHC.m\>\""}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7706604438258667`*^9, 3.770660447623502*^9}, {
   3.7706604791283245`*^9, 3.7706604838101683`*^9}, 3.7735954993498383`*^9, 
   3.7736012480316825`*^9},
 CellLabel->
  "In[181]:=",ExpressionUUID->"4b7f98bd-917f-4bcc-b1dc-391217284559"],

Cell[CellGroupData[{

Cell["1. Fitting Particles", "Section",
 CellChangeTimes->{{3.716218263423055*^9, 3.7162182721115522`*^9}, {
  3.7701334916489763`*^9, 
  3.7701334919229918`*^9}},ExpressionUUID->"43f22ad8-6903-45c5-a382-\
7cc1c4dead0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myAllfits", "=", 
   RowBox[{"MyCategorizedTrackFitter", "[", 
    RowBox[{
    "myRNAtracksHC", ",", "myColMovie", ",", "analysisFolder", ",", "1.5"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7701383738392215`*^9, 3.770138393185328*^9}, {
  3.7701470357136526`*^9, 3.7701470390038404`*^9}, {3.771956520665476*^9, 
  3.771956523326832*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"815f38a2-1df7-4481-acb0-f8945fa22a00"]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Filtering Results", "Section",
 CellChangeTimes->{{3.770133503796671*^9, 
  3.7701335170434284`*^9}},ExpressionUUID->"7ab5b2dc-085b-44d1-8134-\
3270572caa6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myAllfits", "=", 
   RowBox[{"Get", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "<>", "\"\<.m\>\""}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
        RowBox[{"ToString", "/@", 
         RowBox[{"{", 
          RowBox[{
          "myRedfitsR", ",", "myRedfitsY", ",", "myRedfitsP", ",", 
           "myRedfitsW", ",", "myGreenfitsY", ",", "myGreenfitsW", ",", 
           "myBluefitsP", ",", "myBluefitsW"}], "}"}]}]}], ")"}]}], ")"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.773594725604486*^9, 3.7735947317394953`*^9}, {
   3.7735948478276834`*^9, 3.77359486005884*^9}, {3.77359491718423*^9, 
   3.773595015536297*^9}, {3.7735952355765076`*^9, 3.773595262457461*^9}, {
   3.7735955432523403`*^9, 3.7735955447379894`*^9}, {3.773595683533966*^9, 
   3.7735956845025077`*^9}, 3.7736012714546967`*^9, {3.7736014332351704`*^9, 
   3.773601439113335*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"15d6b21b-b2b8-455b-a8a2-455dc353b867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myAllfitsFiltered", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FilterFitOutlierFixedSigma", "[", 
      RowBox[{"#", ",", "5"}], "]"}], "&"}], "/@", "myAllfits"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7701393073006124`*^9, 3.770139342895648*^9}, 
   3.7701474113531375`*^9, {3.770147486551439*^9, 3.770147487042467*^9}, {
   3.7703840094237733`*^9, 3.770384011966919*^9}, 3.7735951922241373`*^9, 
   3.773601469634596*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"aca07e37-3377-465a-bf2d-e04b1804c266"]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Reformatting Filtered Results", "Section",
 CellChangeTimes->{{3.7701491929360385`*^9, 
  3.770149205651766*^9}},ExpressionUUID->"ed0521e0-d74d-47d7-b86b-\
3bd1cfe5660c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myAllParameters", "=", 
   RowBox[{"GetMyAllParameters", "[", 
    RowBox[{"myAllfits", ",", "myAllfitsFiltered", ",", "analysisFolder"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770391387219759*^9, 3.7703913972993355`*^9}, {
   3.770393577207019*^9, 3.770393578689104*^9}, {3.7705780107116423`*^9, 
   3.770578012344102*^9}, {3.7706678988680725`*^9, 3.7706679011506767`*^9}, 
   3.773595202374818*^9, 3.7736014995685883`*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"ed5ff141-0f27-410b-a21f-e3cef6e6d4e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Filter Reformatted Filtered Results", "Section",
 CellChangeTimes->{{3.7706677316495037`*^9, 
  3.7706677509955244`*^9}},ExpressionUUID->"a2393135-8377-4788-bcf9-\
82a6f3912749"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myAllParametersFiltered", "=", 
   RowBox[{"MyAllParametersFilter", "[", 
    RowBox[{"myAllParameters", ",", "analysisFolder", ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7706677530912733`*^9, 3.7706678180821757`*^9}, {
  3.7735946143878307`*^9, 3.773594616249148*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"a3ed7dfc-1d22-4a3b-95de-5d58039149d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["5. Making Crops from Fit Results", "Section",
 CellChangeTimes->{{3.7703936812549706`*^9, 3.7703936984769554`*^9}, {
  3.770667720747439*^9, 
  3.7706677208878713`*^9}},ExpressionUUID->"a54fae16-2422-4a36-8c4e-\
36952670d602"],

Cell["\<\
If there is no green/blue fitting, crops are made based on red position (TF \
function applied) \
\>", "Text",
 CellChangeTimes->{{3.7703937329449267`*^9, 3.770393745082621*^9}, {
  3.7703946229578323`*^9, 
  3.7703946460331526`*^9}},ExpressionUUID->"b572f66d-edfa-4bf2-b229-\
989436571436"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"myFitCrops", ",", "myFitCropsAvg"}], "}"}], "=", 
   RowBox[{"MyFitCropMaker", "[", 
    RowBox[{
    "myColMovie", ",", "myAllParametersFiltered", ",", "5", ",", 
     "analysisFolder"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7703958413985233`*^9, 3.770395855450327*^9}, {
  3.770399104450159*^9, 3.77039911985104*^9}, {3.770667724251672*^9, 
  3.770667725295025*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"8d44a80c-c1b6-4dc9-8367-84140fe56cf5"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1392, 791},
WindowMargins->{{Automatic, 263}, {Automatic, 98}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 13, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"92e3b639-c274-4188-9c92-73eb902a027f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 3, 98, "Title",ExpressionUUID->"9e97aec4-4023-44e8-a12f-af7c57c1436c"],
Cell[740, 27, 667, 14, 73, "Input",ExpressionUUID->"23a3959d-752a-474c-a936-6bc8940df47d"],
Cell[1410, 43, 476, 12, 82, "Input",ExpressionUUID->"19233f34-1ad6-4da3-bc13-66116c44da09"]
}, Closed]],
Cell[CellGroupData[{
Cell[1923, 60, 253, 4, 72, "Title",ExpressionUUID->"35a2d634-c54c-4315-9def-6daffc4bf438"],
Cell[CellGroupData[{
Cell[2201, 68, 226, 4, 54, "Subsection",ExpressionUUID->"e1f2de0f-2dbb-4fab-9807-414012d44dbf"],
Cell[CellGroupData[{
Cell[2452, 76, 173, 3, 45, "Subsubsection",ExpressionUUID->"2ce83764-9ead-4af7-8546-8f57ee40c2a0"],
Cell[2628, 81, 4303, 99, 1, "Input",ExpressionUUID->"76cee680-fb4a-4de4-87dd-e75e63fc55fb"]
}, Closed]],
Cell[CellGroupData[{
Cell[6968, 185, 467, 7, 37, "Subsubsection",ExpressionUUID->"bffe24b6-70fd-456b-b58a-697a2b6c2a15"],
Cell[7438, 194, 10182, 228, 198, "Input",ExpressionUUID->"f3572849-4ba5-4223-9ec2-fdf7fafd9df0"]
}, Closed]],
Cell[CellGroupData[{
Cell[17657, 427, 242, 4, 37, "Subsubsection",ExpressionUUID->"de3e4957-78f0-4981-b16d-260e92546251"],
Cell[17902, 433, 1112, 18, 0, "Input",ExpressionUUID->"9cfad160-2352-43c8-ad4d-fbc980ee65f2"],
Cell[19017, 453, 5052, 123, 0, "Input",ExpressionUUID->"b3b7dc60-8e14-49c1-abb4-93ba328993c0"]
}, Closed]],
Cell[CellGroupData[{
Cell[24106, 581, 321, 5, 37, "Subsubsection",ExpressionUUID->"a6ac1f55-e041-4aaf-9f9b-a89674d7ac4d"],
Cell[24430, 588, 8665, 184, 3, "Input",ExpressionUUID->"c594ed29-1a37-4970-bb50-36b60408e43e"]
}, Closed]],
Cell[CellGroupData[{
Cell[33132, 777, 317, 4, 37, "Subsubsection",ExpressionUUID->"ac356e3e-9f30-4631-afb3-b4b05dcc1c0b"],
Cell[33452, 783, 3667, 57, 0, "Input",ExpressionUUID->"eb29efd3-ca99-462c-9bfd-e821f40607d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[37156, 845, 216, 4, 37, "Subsubsection",ExpressionUUID->"c5912298-d0e6-43f0-baa1-e8ece6444db4"],
Cell[37375, 851, 155, 3, 9, "Text",ExpressionUUID->"16b0fc8d-b854-45e4-88a8-78af83994205"],
Cell[37533, 856, 166, 2, 13, "Input",ExpressionUUID->"eaa2674f-3f66-4c7f-921f-08797eb11b79"],
Cell[37702, 860, 2364, 56, 90, "Input",ExpressionUUID->"3f0fcdcc-4965-4109-b6b8-3d9ce86ed438"]
}, Closed]],
Cell[CellGroupData[{
Cell[40103, 921, 618, 9, 37, "Subsubsection",ExpressionUUID->"3d881f04-2327-4591-bbd3-37e138762ea3"],
Cell[40724, 932, 155, 3, 35, "Text",ExpressionUUID->"54ce55b7-5d6f-48b8-8959-fa0cf7bf8c00"],
Cell[CellGroupData[{
Cell[40904, 939, 4838, 91, 110, "Input",ExpressionUUID->"eab74794-9c16-4720-a057-37947164b1b5"],
Cell[45745, 1032, 2890, 51, 70, "Output",ExpressionUUID->"6ab905d5-b9a4-4476-93bc-7f4e5c0758c2"],
Cell[48638, 1085, 2834, 51, 70, "Output",ExpressionUUID->"8c5680f7-c1f4-49a7-b4b3-e2d19209ff08"],
Cell[51475, 1138, 3065, 56, 70, "Output",ExpressionUUID->"029307c9-eee6-4943-b4dc-5fb331e6c795"],
Cell[54543, 1196, 3005, 55, 70, "Output",ExpressionUUID->"ea3afd4f-91b5-4d73-a4cc-440f3a5ec018"]
}, Open  ]],
Cell[57563, 1254, 2529, 60, 220, "Input",ExpressionUUID->"381ad9ba-dd31-4652-87ad-129b79c0ee48"],
Cell[60095, 1316, 581, 10, 178, "Input",ExpressionUUID->"b2a80756-1cec-4af8-85ab-9b164ac666e4"],
Cell[60679, 1328, 2306, 51, 178, "Input",ExpressionUUID->"63e690ab-1d8a-42a3-a14c-ebf0dd881ff9"]
}, Closed]],
Cell[CellGroupData[{
Cell[63022, 1384, 379, 6, 37, "Subsubsection",ExpressionUUID->"726f0240-b98e-4805-8f4f-2ea591701e3f"],
Cell[63404, 1392, 155, 3, 35, "Text",ExpressionUUID->"b8991132-c4c3-423d-b7f7-14ad857ebcc9"],
Cell[CellGroupData[{
Cell[63584, 1399, 6771, 129, 97, "Input",ExpressionUUID->"4c17959f-1fb0-479b-85e1-013123874646"],
Cell[70358, 1530, 2418, 44, 70, "Output",ExpressionUUID->"22cf2aba-7c3a-4a4d-9444-bceaaf507d04"],
Cell[72779, 1576, 2363, 44, 70, "Output",ExpressionUUID->"4b2cb94e-8db0-41c4-b721-430a70511144"],
Cell[75145, 1622, 2460, 45, 70, "Output",ExpressionUUID->"13fe2649-50f6-4d0a-8cce-2bd841c2141f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77642, 1672, 1018, 25, 73, "Input",ExpressionUUID->"a2f36a1c-96bf-40d8-a6cc-23cb56620da2"],
Cell[78663, 1699, 395, 7, 70, "Output",ExpressionUUID->"f087f9c6-9613-44a5-b34a-2a1e44609124"],
Cell[79061, 1708, 395, 7, 70, "Output",ExpressionUUID->"ae47f81e-5066-4ee2-98b7-ed61ea5c70f9"]
}, Open  ]],
Cell[79471, 1718, 6522, 116, 409, "Input",ExpressionUUID->"19ed8e70-394f-4b72-99e4-397b446d8093"],
Cell[85996, 1836, 284, 6, 30, "Input",ExpressionUUID->"a5c2fae7-014d-4e7a-a419-39376726b519"],
Cell[86283, 1844, 3541, 85, 199, "Input",ExpressionUUID->"1005b23c-d85f-4df9-8af1-a10777498a55"],
Cell[89827, 1931, 155, 3, 35, "Text",ExpressionUUID->"371f534a-ce9f-481e-858d-9596ce571d84"],
Cell[89985, 1936, 481, 12, 52, "Input",ExpressionUUID->"0bb64873-d217-4df4-a104-23082059db38"]
}, Closed]],
Cell[CellGroupData[{
Cell[90503, 1953, 365, 6, 37, "Subsubsection",ExpressionUUID->"35fb4dde-2332-4f1d-933f-09ef09c963f8"],
Cell[90871, 1961, 4950, 71, 283, "Input",ExpressionUUID->"19b42f68-f1fe-465b-aa1a-33cec54bc0ea"],
Cell[95824, 2034, 2132, 44, 157, "Input",ExpressionUUID->"05404d22-ee0a-47d4-9c6b-12f130d3ff4e"]
}, Closed]],
Cell[CellGroupData[{
Cell[97993, 2083, 463, 7, 37, "Subsubsection",ExpressionUUID->"da8b36c6-f116-497a-be6d-17aa0616882e"],
Cell[98459, 2092, 10293, 194, 451, "Input",ExpressionUUID->"8e19dd60-9f0d-49b6-a5ab-aaf63c76b9ae"]
}, Closed]],
Cell[CellGroupData[{
Cell[108789, 2291, 808, 12, 37, "Subsubsection",ExpressionUUID->"c14523ab-eeb3-4987-aa1f-11ed9cc449c9"],
Cell[109600, 2305, 3737, 88, 178, "Input",ExpressionUUID->"4c817102-a726-4f44-b80d-104f4aab69e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[113374, 2398, 753, 11, 37, "Subsubsection",ExpressionUUID->"5c6a7fc2-3a8a-4d20-9c5e-257042d62bb3"],
Cell[114130, 2411, 2268, 61, 126, "Input",ExpressionUUID->"2809f9be-f5c2-4487-8eb2-f6ea2da99962"]
}, Closed]],
Cell[CellGroupData[{
Cell[116435, 2477, 588, 8, 37, "Subsubsection",ExpressionUUID->"699221ed-a096-481a-a234-a9e06d7f651c"],
Cell[117026, 2487, 167, 3, 19, "Text",ExpressionUUID->"e65ac98b-23da-4846-8a92-5b448e0c344c"],
Cell[117196, 2492, 282, 5, 16, "Input",ExpressionUUID->"34e4572b-0ad1-4b24-a971-696a2ea0cad1"],
Cell[117481, 2499, 4382, 92, 187, "Input",ExpressionUUID->"aeabe348-cb90-4205-b9ba-075fe4c91b03"]
}, Closed]],
Cell[CellGroupData[{
Cell[121900, 2596, 371, 6, 37, "Subsubsection",ExpressionUUID->"7f8cbe35-642c-46f9-ad03-e5070d4766d0"],
Cell[122274, 2604, 167, 3, 30, "Text",ExpressionUUID->"2d2427d7-043f-4260-9edc-381b7f840861"],
Cell[CellGroupData[{
Cell[122466, 2611, 1232, 32, 41, "Input",ExpressionUUID->"7b641c58-a6df-4b67-b9ee-dfaa32a121a6"],
Cell[123701, 2645, 1550, 35, 70, "Output",ExpressionUUID->"b0d2686d-21ae-4c28-908f-0c8938c95f1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125288, 2685, 2885, 73, 71, "Input",ExpressionUUID->"875fd433-e4e9-4be2-9ed6-122a2a801260"],
Cell[128176, 2760, 1365, 32, 70, "Output",ExpressionUUID->"04d30448-b42c-4071-8976-ff22a2d16c98"],
Cell[129544, 2794, 1414, 33, 70, "Output",ExpressionUUID->"2358fe0d-2f49-4bbd-8c78-501660a1597e"]
}, Open  ]],
Cell[130973, 2830, 11562, 261, 737, "Input",ExpressionUUID->"ed0c91d7-d508-491f-9149-0fc5bad28ffe"],
Cell[CellGroupData[{
Cell[142560, 3095, 175, 2, 30, "Input",ExpressionUUID->"91bcb908-9452-4ee0-8304-e1bde5c11597"],
Cell[142738, 3099, 328, 4, 70, "Output",ExpressionUUID->"32607f76-f36f-42e1-be61-b2b198ee4330"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143103, 3108, 610, 14, 44, "Input",ExpressionUUID->"417de312-7c5e-4841-b0f4-ba0bf2f3f9e5"],
Cell[143716, 3124, 364, 6, 70, "Output",ExpressionUUID->"8a9fe8fa-984b-497f-b8bf-fdeac18969e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144117, 3135, 2169, 53, 99, "Input",ExpressionUUID->"70abdd6c-b022-4d78-b18d-1bc3bf49644d"],
Cell[146289, 3190, 533, 12, 70, "Message",ExpressionUUID->"cf0abb01-9031-4740-a6fb-b31a04c6e503"],
Cell[146825, 3204, 614, 13, 70, "Message",ExpressionUUID->"5836dc89-6d44-42f6-9a47-3e53fc0fa722"],
Cell[147442, 3219, 741, 13, 70, "Output",ExpressionUUID->"42799cc4-c7e4-4f7f-a617-0d05fc5134e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148220, 3237, 1710, 44, 41, "Input",ExpressionUUID->"72d72ed3-c7bd-47c0-ab11-b2e37e2c8d20"],
Cell[149933, 3283, 338, 5, 70, "Output",ExpressionUUID->"c5682a65-c42c-4bc0-9a16-0236469cf585"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150308, 3293, 1531, 39, 60, "Input",ExpressionUUID->"c7436e49-ceff-42ce-bf5e-3a8586d047f1"],
Cell[151842, 3334, 609, 13, 70, "Message",ExpressionUUID->"77b9f038-71e5-40be-a534-54ffc773d8b5"],
Cell[152454, 3349, 611, 13, 70, "Message",ExpressionUUID->"08c5250b-f381-4143-a86a-213c1cd91a0c"],
Cell[153068, 3364, 1846, 40, 70, "Output",ExpressionUUID->"49e11f7a-2ebd-48b8-826d-1a6a1876c9df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154951, 3409, 882, 21, 50, "Input",ExpressionUUID->"1656df1c-17e2-4280-a2e4-37367d97f128"],
Cell[155836, 3432, 513, 11, 70, "Message",ExpressionUUID->"d786f98a-9d9e-4998-94a3-771d58037f2a"],
Cell[156352, 3445, 526, 11, 70, "Message",ExpressionUUID->"3a40f44c-e5e9-4702-a6d1-5efb4fe4c8e6"],
Cell[156881, 3458, 960, 20, 70, "Output",ExpressionUUID->"4a61407d-6f5a-401e-9b71-494c877111c0"]
}, Open  ]],
Cell[157856, 3481, 6410, 145, 392, "Input",ExpressionUUID->"70556897-7906-4420-8a16-b7a76724f662"],
Cell[CellGroupData[{
Cell[164291, 3630, 1185, 30, 30, "Input",ExpressionUUID->"ad180aed-7cbd-4c8a-8459-dfb810cb114a"],
Cell[165479, 3662, 501, 11, 70, "Message",ExpressionUUID->"95131c53-17c8-4c63-bc30-a96af284b109"],
Cell[165983, 3675, 501, 11, 70, "Message",ExpressionUUID->"eb393e76-561d-4468-a0ae-68687904ca0d"],
Cell[166487, 3688, 503, 11, 70, "Message",ExpressionUUID->"2a1faa87-5407-43c2-a89c-49df33f21831"],
Cell[166993, 3701, 576, 12, 70, "Message",ExpressionUUID->"c7221786-0fed-4309-aa60-6d6be7442d5b"],
Cell[167572, 3715, 1365, 23, 70, "Output",ExpressionUUID->"7e14ea0b-cef4-4559-be00-0fcef99fdef3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[168986, 3744, 243, 4, 37, "Subsubsection",ExpressionUUID->"5d27b8f3-6c90-45f7-b3fc-49b0af80b20a"],
Cell[169232, 3750, 2825, 77, 136, "Input",ExpressionUUID->"435388a3-86f6-4d14-b992-7591fba82cd2"],
Cell[172060, 3829, 3188, 87, 136, "Input",ExpressionUUID->"e97afc7c-7f42-417a-936d-464838b4b382"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175285, 3921, 935, 15, 63, "Subsubsection",ExpressionUUID->"4fde548c-c2a7-45a2-a0a1-ed8b4add4e60"],
Cell[176223, 3938, 7661, 138, 92, "Text",ExpressionUUID->"b4edb672-6329-44bf-b36d-e1f31cb7260c"],
Cell[CellGroupData[{
Cell[183909, 4080, 8521, 156, 165, "Input",ExpressionUUID->"3f27adde-5b02-46ea-ad91-7e8d97ef833b"],
Cell[192433, 4238, 7875, 145, 70, "Output",ExpressionUUID->"68f4ccfd-85a4-451d-92b7-094efc3ace75"]
}, Open  ]],
Cell[200323, 4386, 9021, 193, 745, "Input",ExpressionUUID->"e1d63dbf-c5dd-48b0-85e4-78a0a5cac370"]
}, Closed]],
Cell[CellGroupData[{
Cell[209381, 4584, 1024, 17, 74, "Subsubsection",ExpressionUUID->"8ce7a505-7925-491e-973c-586e850d2d9e"],
Cell[210408, 4603, 167, 3, 34, "Text",ExpressionUUID->"89ec8ae9-4e81-4d08-aaf1-8fa720debe01"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210624, 4612, 229, 4, 53, "Subsection",ExpressionUUID->"db90326b-05c6-4a4b-9f54-dd85bff97e41"],
Cell[210856, 4618, 1100, 29, 67, "Input",ExpressionUUID->"ce5061b3-9ff5-4863-a8ce-59d81792de4a"]
}, Closed]],
Cell[CellGroupData[{
Cell[211993, 4652, 157, 3, 37, "Subsection",ExpressionUUID->"fad66368-8e67-4d1a-a03c-8efd96b999dd"],
Cell[212153, 4657, 1663, 45, 189, "Input",ExpressionUUID->"e64c9cf3-68fd-4ce2-889d-fb74f0df555f"],
Cell[213819, 4704, 51186, 845, 82, "Input",ExpressionUUID->"d4e6b430-64ae-4d9b-8784-1aaa7fe30d7d"]
}, Closed]],
Cell[CellGroupData[{
Cell[265042, 5554, 164, 3, 37, "Subsection",ExpressionUUID->"a895c199-0c24-4689-8387-4c5f8da05d67"],
Cell[265209, 5559, 10181, 228, 694, "Input",ExpressionUUID->"3cd9d0d8-7296-40db-91d9-6b40328a0da3"],
Cell[275393, 5789, 9277, 224, 694, "Input",ExpressionUUID->"3c2439b2-e874-4057-ae6c-128c0256da2a"]
}, Closed]],
Cell[CellGroupData[{
Cell[284707, 6018, 163, 3, 37, "Subsection",ExpressionUUID->"27295f72-fb1e-4693-962f-c0cb0e131e02"],
Cell[284873, 6023, 19083, 420, 922, "Input",ExpressionUUID->"1cccd39f-223a-4539-9b26-49509d8f9395"],
Cell[303959, 6445, 16329, 378, 846, "Input",ExpressionUUID->"f4a75cf4-6246-4a13-887a-fec3c1c800d4"]
}, Closed]],
Cell[CellGroupData[{
Cell[320325, 6828, 163, 3, 37, "Subsection",ExpressionUUID->"ea107ba6-6c6d-42e3-83ad-2aee4bbc61e5"],
Cell[320491, 6833, 4104, 90, 124, "Input",ExpressionUUID->"9157950d-031c-400b-b750-3a41159e3a40"],
Cell[324598, 6925, 2523, 57, 162, "Input",ExpressionUUID->"fb0061be-db34-4dd4-a1eb-c76f86f484eb"],
Cell[327124, 6984, 4859, 115, 257, "Input",ExpressionUUID->"c8eb5bcb-356b-404e-a8ac-e1b4af35decb"],
Cell[331986, 7101, 1391, 37, 86, "Input",ExpressionUUID->"051eaf6e-8a40-495d-adfa-d532a78b7686"],
Cell[333380, 7140, 2738, 72, 181, "Input",ExpressionUUID->"e2f08ea4-c04d-445c-9a17-dfc86bd78bee"]
}, Closed]],
Cell[CellGroupData[{
Cell[336155, 7217, 398, 8, 37, "Subsection",ExpressionUUID->"0d56f4d5-27d6-4886-954c-901b4816b290"],
Cell[336556, 7227, 12033, 226, 618, "Input",ExpressionUUID->"1c94271e-f3c7-4616-9a8e-db171f72cf9c"]
}, Closed]],
Cell[CellGroupData[{
Cell[348626, 7458, 426, 8, 37, "Subsection",ExpressionUUID->"c5864982-ac8c-46e4-8600-292f2b6d096b"],
Cell[349055, 7468, 3380, 67, 295, "Input",ExpressionUUID->"69c93b80-9ad2-4cd5-828e-4c305da2a48e"],
Cell[352438, 7537, 5197, 124, 295, "Input",ExpressionUUID->"dd76e305-9bfd-41d7-aa04-90b0b0766153"]
}, Closed]],
Cell[CellGroupData[{
Cell[357672, 7666, 292, 4, 37, "Subsection",ExpressionUUID->"6f3a9e22-1b0e-4cb3-8696-14fcc8a658ce"],
Cell[357967, 7672, 2440, 54, 219, "Input",ExpressionUUID->"247742ff-d160-46e7-914f-90aeea0a72df"],
Cell[360410, 7728, 1314, 37, 48, "Input",ExpressionUUID->"7713582a-fd17-4e38-adbd-467b7f14e503"],
Cell[361727, 7767, 8891, 203, 504, "Input",ExpressionUUID->"01dd3399-191b-4eec-8a55-f09624257870"]
}, Closed]],
Cell[CellGroupData[{
Cell[370655, 7975, 259, 4, 37, "Subsection",ExpressionUUID->"33132d20-7bb9-475c-a772-65342213d35d"],
Cell[370917, 7981, 4233, 95, 200, "Input",ExpressionUUID->"d098258e-7b58-42a2-820d-5a03bf40a995"]
}, Closed]],
Cell[CellGroupData[{
Cell[375187, 8081, 161, 3, 37, "Subsection",ExpressionUUID->"a04c3b61-38a1-43d4-ba5c-66e90f98cba1"],
Cell[375351, 8086, 506, 10, 28, "Input",ExpressionUUID->"47ce27b1-92b2-401c-b425-9f7d6d9ae3ba"],
Cell[375860, 8098, 3866, 96, 238, "Input",ExpressionUUID->"a0cc7a7c-820a-4bcb-97d5-f961f7be3d92"]
}, Closed]],
Cell[CellGroupData[{
Cell[379763, 8199, 159, 3, 37, "Subsection",ExpressionUUID->"b0a47a3e-b06a-47d9-bf2e-eb836351f867"],
Cell[379925, 8204, 513, 9, 28, "Input",ExpressionUUID->"43cd7335-6459-4bfa-bdf5-37bf73abb8e4"],
Cell[380441, 8215, 13272, 294, 998, "Input",ExpressionUUID->"2a5aa042-bd26-4e87-86e6-50bc71c66ce6"],
Cell[393716, 8511, 440, 10, 28, "Input",ExpressionUUID->"de5bb7f5-9065-449e-9475-33833d5d59a1"]
}, Closed]],
Cell[CellGroupData[{
Cell[394193, 8526, 165, 3, 37, "Subsection",ExpressionUUID->"15f87806-614d-4021-acd6-582d93442541"],
Cell[394361, 8531, 643, 12, 100, "Text",ExpressionUUID->"319606ea-c52a-4438-b654-e1ea17f3e3d3"],
Cell[395007, 8545, 2511, 52, 162, "Input",ExpressionUUID->"c681f31f-8d94-4c56-b0ad-92de4ae4b1cb"],
Cell[397521, 8599, 12763, 274, 713, "Input",ExpressionUUID->"3693eb9a-0daa-4d83-9939-aa4f7b076299"],
Cell[410287, 8875, 13085, 280, 751, "Input",ExpressionUUID->"72483956-951e-413f-b741-07e2f6fe263d"],
Cell[423375, 9157, 16464, 345, 998, "Input",ExpressionUUID->"1f872559-45a6-46f9-9164-a3f54a4433e2"],
Cell[439842, 9504, 15787, 330, 979, "Input",ExpressionUUID->"5f422c0f-5fa6-4849-8224-d1c943889982"],
Cell[455632, 9836, 15191, 315, 941, "Input",ExpressionUUID->"d7dd54bd-7981-4fbd-8df7-153174503026"],
Cell[470826, 10153, 13632, 289, 732, "Input",ExpressionUUID->"a383b246-d449-4ec3-94ba-de89c3d09f0d"],
Cell[484461, 10444, 14960, 312, 770, "Input",ExpressionUUID->"d5879ee8-af25-405a-8814-d3a1f8ebc8b7"]
}, Closed]],
Cell[CellGroupData[{
Cell[499458, 10761, 162, 3, 37, "Subsection",ExpressionUUID->"34cedc17-308c-40ac-8650-47ed111a55a1"],
Cell[499623, 10766, 6870, 163, 428, "Input",ExpressionUUID->"e8cf5d6a-b2b9-472e-9118-ed11507fe3a3"],
Cell[506496, 10931, 1889, 48, 162, "Input",ExpressionUUID->"5e8f1361-4999-4d40-a0e6-6778ca4541be"],
Cell[508388, 10981, 1960, 46, 200, "Input",ExpressionUUID->"7367a715-e1ff-4a88-972e-ad77450b2018"],
Cell[510351, 11029, 1802, 45, 162, "Input",ExpressionUUID->"50d1b750-3666-4ffd-b5a6-72cf4b4f7031"]
}, Closed]],
Cell[CellGroupData[{
Cell[512190, 11079, 424, 8, 38, "Subsection",ExpressionUUID->"c3acbe8f-e3d7-4674-ba17-5430b497508b"],
Cell[512617, 11089, 6591, 156, 276, "Input",ExpressionUUID->"59fcb5af-abf3-487e-80eb-7d2b5e42c4e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[519245, 11250, 312, 7, 38, "Subsection",ExpressionUUID->"35c19298-b199-4b8e-a2e2-67d2b6e4b74a"],
Cell[519560, 11259, 2528, 51, 105, "Input",ExpressionUUID->"55471e2b-443c-4c68-b9c6-964851130635"]
}, Closed]],
Cell[CellGroupData[{
Cell[522125, 11315, 488, 9, 38, "Subsection",ExpressionUUID->"c2553a79-340b-401e-beb0-9eb1e1d4ceea"],
Cell[522616, 11326, 4402, 90, 219, "Input",ExpressionUUID->"d1bd9974-d7f1-47e7-ab6a-e0c236e0c6d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[527055, 11421, 306, 5, 38, "Subsection",ExpressionUUID->"7b107ae1-c8ef-4f7e-ad33-e85ce5d6c16e"],
Cell[527364, 11428, 14359, 315, 865, "Input",ExpressionUUID->"5949f831-9ad6-4d4e-afc3-8c73c12a52e7"],
Cell[541726, 11745, 8671, 203, 504, "Input",ExpressionUUID->"7e74beb0-2562-419b-a59e-340dcf8671a8"],
Cell[550400, 11950, 3619, 86, 352, "Input",ExpressionUUID->"9a80c090-7bc0-47f8-84b7-21da8f5c3bd6"]
}, Closed]],
Cell[CellGroupData[{
Cell[554056, 12041, 253, 4, 38, "Subsection",ExpressionUUID->"375fabfc-537b-4e00-a5f7-38fbb96f9ab0"],
Cell[554312, 12047, 1612, 37, 143, "Input",ExpressionUUID->"34de6b27-6377-4071-89a4-b240db734b6c"],
Cell[555927, 12086, 1941, 44, 143, "Input",ExpressionUUID->"7961cdd5-2ef1-4bd7-8eb3-38a9c1dec976"],
Cell[557871, 12132, 6767, 155, 390, "Input",ExpressionUUID->"e8acae78-ce0e-490d-9cd9-490870b4bc93"]
}, Closed]],
Cell[CellGroupData[{
Cell[564675, 12292, 158, 3, 38, "Subsection",ExpressionUUID->"2a735256-94d2-4f2a-ac1f-49713f46a7e4"],
Cell[564836, 12297, 625, 12, 48, "Input",ExpressionUUID->"3805a56c-ee52-4108-964c-3cfa77c43a0f"],
Cell[565464, 12311, 8963, 200, 466, "Input",ExpressionUUID->"266eeab2-059a-4c81-8b56-efccb51887b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[574464, 12516, 171, 3, 38, "Subsection",ExpressionUUID->"df42858d-8eb6-430d-baab-004a77ced840"],
Cell[574638, 12521, 7654, 176, 371, "Input",ExpressionUUID->"4fd90806-9be8-4a25-a36c-77dffc74a978"]
}, Closed]],
Cell[CellGroupData[{
Cell[582329, 12702, 170, 3, 38, "Subsection",ExpressionUUID->"0ea5db5a-8ce4-4f8b-9e03-9d993d23342d"],
Cell[582502, 12707, 7850, 170, 447, "Input",ExpressionUUID->"2faf830e-7352-4971-ba87-4416dedebc68"],
Cell[590355, 12879, 9485, 195, 466, "Input",ExpressionUUID->"37fceca0-686c-4dcc-a76d-900739511464"],
Cell[599843, 13076, 7256, 164, 447, "Input",ExpressionUUID->"4cad4ff6-f0a9-4c81-bb9d-a18d50bbc031"]
}, Closed]],
Cell[CellGroupData[{
Cell[607136, 13245, 163, 3, 38, "Subsection",ExpressionUUID->"5bd3dea6-8876-4c76-8b5d-bb9b57373ca2"],
Cell[607302, 13250, 40605, 831, 1834, "Input",ExpressionUUID->"7a14c906-df1b-4174-9bd1-4b20d3555fcf"],
Cell[647910, 14083, 40891, 838, 1853, "Input",ExpressionUUID->"f02a97c5-692b-4d86-b52d-39ca3775a965"]
}, Closed]],
Cell[CellGroupData[{
Cell[688838, 14926, 218, 4, 38, "Subsection",ExpressionUUID->"05aed639-cd8e-42d5-b3e5-5d8bf0f76702"],
Cell[689059, 14932, 4168, 98, 200, "Input",ExpressionUUID->"e2591b70-619e-41a7-a6f9-cda3bab1a0d8"]
}, Closed]],
Cell[CellGroupData[{
Cell[693264, 15035, 166, 3, 38, "Subsection",ExpressionUUID->"6da35232-a8e0-4082-a236-1228e9f73ea9"],
Cell[693433, 15040, 3297, 82, 162, "Input",ExpressionUUID->"251715b3-d8bf-4edd-9387-b0ae059f7cb0"]
}, Closed]],
Cell[CellGroupData[{
Cell[696767, 15127, 168, 3, 38, "Subsection",ExpressionUUID->"af1d4fe6-9a4d-4736-a9ed-b3886f5709a0"],
Cell[696938, 15132, 4750, 119, 276, "Input",ExpressionUUID->"20f493cd-1eb0-42d6-b204-70304a008f8b"],
Cell[701691, 15253, 7156, 176, 371, "Input",ExpressionUUID->"b3635c1a-e6b7-4ff0-9db2-4da7186095f2"],
Cell[CellGroupData[{
Cell[708872, 15433, 189, 3, 28, "Input",ExpressionUUID->"ac2bac5e-94bb-4b07-9cbb-d8d0b523f6b2"],
Cell[709064, 15438, 831, 12, 70, "Output",ExpressionUUID->"82f79d86-e302-4221-98b1-dbcccd738e89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[709932, 15455, 343, 7, 28, "Input",ExpressionUUID->"b51d076a-0b00-4264-9992-5cbeb9d246c6"],
Cell[710278, 15464, 894, 15, 70, "Output",ExpressionUUID->"28ae79f9-455e-41d8-9bf0-0453e663e231"]
}, Open  ]],
Cell[CellGroupData[{
Cell[711209, 15484, 342, 7, 28, "Input",ExpressionUUID->"b23294e1-679d-4627-a8b4-937b1f7b4db9"],
Cell[711554, 15493, 974, 16, 70, "Output",ExpressionUUID->"8ed45768-70e3-45c5-8a64-254541bda5bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[712565, 15514, 626, 16, 28, "Input",ExpressionUUID->"b765382c-0285-4a4a-8585-621aee182f0d"],
Cell[713194, 15532, 1162, 21, 70, "Output",ExpressionUUID->"ed82752c-9453-4f36-b3eb-d35f59cdaebc"]
}, Open  ]],
Cell[714371, 15556, 232, 5, 28, "Input",ExpressionUUID->"96de9f6d-8637-4732-8886-bdb481e00ebc"],
Cell[714606, 15563, 413, 11, 28, "Input",ExpressionUUID->"fe7566b6-5b81-45e2-a971-c3fe890e3681"],
Cell[715022, 15576, 830, 24, 28, "Input",ExpressionUUID->"3ea3a148-f01c-4333-a301-501a178f55ae"],
Cell[CellGroupData[{
Cell[715877, 15604, 479, 14, 28, "Input",ExpressionUUID->"3309a44e-c280-4a6f-8986-bd4af09f3331"],
Cell[716359, 15620, 1093, 20, 70, "Output",ExpressionUUID->"2e1be8be-398b-410b-82b2-01fd027ec068"]
}, Open  ]],
Cell[717467, 15643, 1484, 39, 86, "Input",ExpressionUUID->"3f734ecf-f2e4-48bb-84c5-8677c5f84473"],
Cell[CellGroupData[{
Cell[718976, 15686, 445, 9, 28, "Input",ExpressionUUID->"39c797b8-d7cb-48db-a8b1-11268c4b8e70"],
Cell[719424, 15697, 929, 15, 70, "Output",ExpressionUUID->"59d1e897-7c50-4ae9-9032-8c9d66b20ddd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[720390, 15717, 364, 10, 28, "Input",ExpressionUUID->"772bfdd8-6fa7-417a-ae26-756b2ffb9457"],
Cell[720757, 15729, 842, 13, 70, "Output",ExpressionUUID->"27b6265c-deb0-4dce-8e68-82c29dff5b05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[721636, 15747, 893, 25, 28, "Input",ExpressionUUID->"fbec1b03-41a2-4f89-a9e3-2f1167cc0deb"],
Cell[722532, 15774, 878, 14, 70, "Output",ExpressionUUID->"40702cd9-0a93-41fe-9709-86fc9dfef1ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[723447, 15793, 256, 6, 28, "Input",ExpressionUUID->"0edbd7d1-cb5c-49f4-9e93-e3146aecceca"],
Cell[723706, 15801, 1196, 21, 70, "Message",ExpressionUUID->"c2ac2155-1933-478d-a227-0d4ac3b5e4b6"],
Cell[724905, 15824, 889, 15, 70, "Output",ExpressionUUID->"d8f3eef4-638f-4836-9f31-5222f60be3dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[725831, 15844, 645, 18, 28, "Input",ExpressionUUID->"21f759d0-4589-471a-bfb6-3c9d542f706f"],
Cell[726479, 15864, 1040, 18, 70, "Message",ExpressionUUID->"a0a9d929-e0a0-49ae-ab2f-27d02553e422"],
Cell[727522, 15884, 1038, 18, 70, "Message",ExpressionUUID->"3f5e5c5f-0669-4291-8f0c-5bbc58de7f53"],
Cell[728563, 15904, 1300, 22, 70, "Message",ExpressionUUID->"678d8f4f-d06f-4b0e-af9e-30fccd5f7a20"],
Cell[729866, 15928, 1209, 25, 70, "Output",ExpressionUUID->"9b283026-81a1-4b85-8ca8-ee6f5ef4604e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[731112, 15958, 261, 5, 28, "Input",ExpressionUUID->"209f364c-34e6-49a6-9a84-ca1511fceb70"],
Cell[731376, 15965, 1043, 18, 70, "Message",ExpressionUUID->"623b0101-4b5a-47fb-b96a-2f71113ee366"],
Cell[732422, 15985, 957, 16, 70, "Output",ExpressionUUID->"9b433462-a225-4288-8c1a-de3896e567db"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[733428, 16007, 160, 3, 38, "Subsection",ExpressionUUID->"77d9164b-9545-42ca-90b1-ca3a3955caa5"],
Cell[733591, 16012, 6061, 135, 409, "Input",ExpressionUUID->"2ba8d386-1ae2-463c-a8a1-67e497491363"]
}, Closed]],
Cell[CellGroupData[{
Cell[739689, 16152, 172, 3, 38, "Subsection",ExpressionUUID->"6ced526a-ebf7-4b33-8a7e-e99105ba7b65"],
Cell[739864, 16157, 7761, 192, 371, "Input",ExpressionUUID->"c8989dc6-9cc9-4577-843e-d8b27ba4d99c"]
}, Closed]],
Cell[CellGroupData[{
Cell[747662, 16354, 169, 3, 38, "Subsection",ExpressionUUID->"58464248-74c7-4dcd-92b2-359be56116fe"],
Cell[747834, 16359, 13760, 297, 523, "Input",ExpressionUUID->"8b2c2e83-d9c4-4082-9883-686125fcf6d6"]
}, Closed]],
Cell[CellGroupData[{
Cell[761631, 16661, 171, 3, 38, "Subsection",ExpressionUUID->"0cce9ee1-607d-4dfc-9512-515965c88d35"],
Cell[761805, 16666, 10765, 257, 903, "Input",ExpressionUUID->"5a67bdfc-c63a-4024-8ff3-007e0763bebd"]
}, Closed]],
Cell[CellGroupData[{
Cell[772607, 16928, 178, 3, 38, "Subsection",ExpressionUUID->"60f2b663-1a4e-4698-abaf-8a3000cf6072"],
Cell[772788, 16933, 3376, 78, 162, "Input",ExpressionUUID->"5108866f-07e0-4d2a-833b-e1a7931ba567"]
}, Closed]],
Cell[CellGroupData[{
Cell[776201, 17016, 168, 3, 38, "Subsection",ExpressionUUID->"369a8a96-8ba0-47a2-aa53-c3b2443bbb9f"],
Cell[776372, 17021, 311, 7, 34, "Text",ExpressionUUID->"976ab656-f957-4cd5-a372-88505f9fff12"],
Cell[776686, 17030, 28423, 613, 1492, "Input",ExpressionUUID->"210c85d5-076f-4ddf-a9bb-68bbeba53872"],
Cell[805112, 17645, 24289, 526, 1492, "Input",ExpressionUUID->"242613e7-66b9-448f-a4cc-dc0bfd51f0b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[829438, 18176, 169, 3, 38, "Subsection",ExpressionUUID->"0172e43b-57b6-4dca-801c-11dcf485f632"],
Cell[829610, 18181, 2792, 65, 200, "Input",ExpressionUUID->"9e8ce18d-e1b8-4e9a-8b7f-8c0eb2fa7485"]
}, Closed]],
Cell[CellGroupData[{
Cell[832439, 18251, 164, 3, 38, "Subsection",ExpressionUUID->"68f243d2-7c88-4e2a-ad38-ec17ee052f48"],
Cell[832606, 18256, 26421, 555, 1435, "Input",ExpressionUUID->"5a6a1aeb-b680-4107-91e1-9169c7e9b065"]
}, Closed]],
Cell[CellGroupData[{
Cell[859064, 18816, 161, 3, 38, "Subsection",ExpressionUUID->"420b2eb0-dbcc-4e55-9c6f-0d5cf0e4c050"],
Cell[859228, 18821, 5914, 133, 499, "Input",ExpressionUUID->"7644582b-571f-4cc3-8865-42f2696f4ea5"],
Cell[865145, 18956, 5762, 128, 480, "Input",ExpressionUUID->"bc741561-9da4-4437-bd0d-1e0168a08fa9"],
Cell[870910, 19086, 5185, 118, 461, "Input",ExpressionUUID->"bb225ba9-89f8-493c-9045-e0b8f1c7cb21"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[876144, 19210, 150, 3, 72, "Title",ExpressionUUID->"dd294261-86e1-4c6d-a9c7-61d1f31cbd40"],
Cell[CellGroupData[{
Cell[876319, 19217, 260, 4, 69, "Chapter",ExpressionUUID->"b2fc20ab-45c5-4ff1-bed1-28dcec16fc53"],
Cell[CellGroupData[{
Cell[876604, 19225, 450, 7, 67, "Section",ExpressionUUID->"1ecf965e-e589-4c14-bb17-2a8a1d612fb1"],
Cell[CellGroupData[{
Cell[877079, 19236, 648, 12, 30, "Input",ExpressionUUID->"82b96eab-bff3-4f38-bad5-578a80fb5e57"],
Cell[877730, 19250, 435, 11, 45, "Output",ExpressionUUID->"55fcff7c-9196-4a1b-a6e2-982700f95e3f"]
}, Open  ]],
Cell[878180, 19264, 1666, 43, 103, "Input",ExpressionUUID->"0846260c-1d40-4d90-a381-f14443dd67f8"]
}, Closed]],
Cell[CellGroupData[{
Cell[879883, 19312, 343, 5, 53, "Section",ExpressionUUID->"06369ad6-88da-4fd6-b4a3-5658ff56fcd9"],
Cell[880229, 19319, 494, 13, 52, "Input",ExpressionUUID->"8272173b-8e96-4ab9-8cba-84e5aa14cc3f"],
Cell[880726, 19334, 336, 9, 30, "Input",ExpressionUUID->"ef058910-7086-4471-88b8-67e255c73b8f"],
Cell[881065, 19345, 753, 20, 52, "Input",ExpressionUUID->"b4c803e9-bfa8-4c70-9356-4a6a10fa7a38"],
Cell[881821, 19367, 339, 9, 30, "Input",ExpressionUUID->"d26526e0-7197-45d2-b3c3-21f249b8e3e6"]
}, Closed]],
Cell[CellGroupData[{
Cell[882197, 19381, 235, 4, 53, "Section",ExpressionUUID->"9ac46a5c-7900-4f9a-b337-b06be2d90035"],
Cell[882435, 19387, 313, 8, 30, "Input",ExpressionUUID->"52cd9e9c-39ac-41b5-8c67-a62370b48e08"],
Cell[882751, 19397, 2303, 55, 136, "Input",ExpressionUUID->"5ddefe19-dfb6-4316-8108-354eeb614dd9"],
Cell[885057, 19454, 2078, 49, 115, "Input",ExpressionUUID->"cca7a0a9-938c-4317-97a6-0e1f671b30bc"],
Cell[887138, 19505, 2037, 43, 73, "Input",ExpressionUUID->"65c93276-f406-4876-9831-720f778aad0c"],
Cell[889178, 19550, 2788, 56, 94, "Input",ExpressionUUID->"e5c26d46-df0f-47d9-a7c2-9fa256fa9424"],
Cell[891969, 19608, 306, 9, 30, "Input",ExpressionUUID->"adad3120-379b-4502-b999-e1abd786ce3b"]
}, Closed]],
Cell[CellGroupData[{
Cell[892312, 19622, 235, 4, 53, "Section",ExpressionUUID->"f57a5699-ab18-4bfa-ab47-94a39592d131"],
Cell[892550, 19628, 1085, 26, 73, "Input",ExpressionUUID->"9e0f783a-83be-4b36-b042-ad4404b98106"],
Cell[893638, 19656, 1959, 47, 115, "Input",ExpressionUUID->"c1126c24-25bf-4de2-9628-f3bfce155909"],
Cell[895600, 19705, 1735, 39, 73, "Input",ExpressionUUID->"bf93fbe6-fd0d-41a7-973d-4e6d9f5b7f7c"],
Cell[897338, 19746, 883, 19, 73, "Input",ExpressionUUID->"f9223ac0-ffb6-4882-a766-373c3d68a1c3"]
}, Closed]],
Cell[CellGroupData[{
Cell[898258, 19770, 310, 5, 53, "Section",ExpressionUUID->"798ad17a-aa7c-4fda-a3c8-f8a26b2b986a"],
Cell[898571, 19777, 1828, 48, 178, "Input",ExpressionUUID->"1160ea42-162f-4797-9e4a-4a1bbb0e28dc"],
Cell[900402, 19827, 1640, 38, 73, "Input",ExpressionUUID->"4d09fe1b-e05d-437f-a277-974f0ba38bd3"],
Cell[902045, 19867, 569, 12, 30, "Input",ExpressionUUID->"d4d38ce9-1556-42f6-9442-9031a301cec7"],
Cell[902617, 19881, 4347, 80, 136, "Input",ExpressionUUID->"dcd1b07d-5b03-4bd3-a44a-ea5805da3473"],
Cell[906967, 19963, 570, 17, 52, "Input",ExpressionUUID->"68bc5636-aeb2-45b5-b382-cd58e8905a24"]
}, Closed]],
Cell[CellGroupData[{
Cell[907574, 19985, 295, 5, 53, "Section",ExpressionUUID->"f5e0175e-6fef-40b0-b00d-4be05d7929a3"],
Cell[907872, 19992, 1362, 26, 52, "Input",ExpressionUUID->"9c866b6b-158a-487a-9334-8282d267657f"],
Cell[909237, 20020, 694, 16, 30, "Input",ExpressionUUID->"ebe44680-33b5-41b9-b8c2-09250d0321b6"],
Cell[909934, 20038, 1390, 31, 52, "Input",ExpressionUUID->"86135c3e-dbaa-492f-b660-5c1768e9e4cd"]
}, Closed]],
Cell[CellGroupData[{
Cell[911361, 20074, 217, 4, 53, "Section",ExpressionUUID->"c9536367-4408-4758-aefc-011cbb221521"],
Cell[911581, 20080, 370, 7, 30, "Input",ExpressionUUID->"5b3da281-c27a-459a-badf-58874dfdd6d6"]
}, Closed]],
Cell[CellGroupData[{
Cell[911988, 20092, 287, 4, 53, "Section",ExpressionUUID->"e9fa7b50-9f9b-4225-9c9d-777f655bd22d"],
Cell[912278, 20098, 642, 10, 30, "Input",ExpressionUUID->"04c0c7d5-bd82-455a-8743-30762a43e503"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[912969, 20114, 421, 6, 69, "Chapter",ExpressionUUID->"4de08094-d19f-4c1f-a074-e6c163332958"],
Cell[CellGroupData[{
Cell[913415, 20124, 472, 7, 67, "Section",ExpressionUUID->"9876c223-22f1-4597-b380-68286b67dc8f"],
Cell[CellGroupData[{
Cell[913912, 20135, 161, 3, 54, "Subsection",ExpressionUUID->"25391013-be8b-47af-a592-21d927b1b681"],
Cell[914076, 20140, 1859, 47, 94, "Input",ExpressionUUID->"9d8a1c32-3890-4a3b-bfbe-6d149ef9e64d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[915972, 20192, 160, 3, 54, "Subsection",ExpressionUUID->"ae4f90bd-524d-45dc-93e7-4b56f8e2a531"],
Cell[916135, 20197, 719, 13, 52, "Input",ExpressionUUID->"01404b92-576d-469a-aabf-2c35770739f6"],
Cell[CellGroupData[{
Cell[916879, 20214, 2163, 41, 94, "Input",ExpressionUUID->"ae2ba3c5-71af-4042-8fbb-411b58d4d06c"],
Cell[919045, 20257, 794, 15, 34, "Output",ExpressionUUID->"006aab16-d911-47bc-be74-eed79748f9fc"]
}, Open  ]],
Cell[919854, 20275, 1538, 36, 94, "Input",ExpressionUUID->"063e4325-8237-4b6e-9c27-6d8d549fb13e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[921429, 20316, 248, 4, 54, "Subsection",ExpressionUUID->"abf16ff0-df35-48d8-94df-859c83e04111"],
Cell[921680, 20322, 806, 20, 52, "Input",ExpressionUUID->"c6351005-890c-4282-948b-4eb159cf30e5"],
Cell[922489, 20344, 14115, 299, 556, "Input",ExpressionUUID->"008bac0b-8c4f-4e42-be4d-3c0ac110a59d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[936653, 20649, 349, 5, 53, "Section",ExpressionUUID->"75956577-5f5e-4018-98c3-6e4f4ed09f60"],
Cell[CellGroupData[{
Cell[937027, 20658, 161, 3, 54, "Subsection",ExpressionUUID->"eb91998e-144b-4d32-b5fc-4566c512d5db"],
Cell[937191, 20663, 566, 10, 30, "Input",ExpressionUUID->"f6aa38c8-ed04-4bf7-b02e-d0d7710476c7"]
}, Closed]],
Cell[CellGroupData[{
Cell[937794, 20678, 228, 4, 38, "Subsection",ExpressionUUID->"01822993-2c53-468b-9f61-f7c9e9a0fcbf"],
Cell[CellGroupData[{
Cell[938047, 20686, 179, 3, 45, "Subsubsection",ExpressionUUID->"a357046a-103f-44e6-8a6f-d35cfbb127b2"],
Cell[938229, 20691, 444, 10, 52, "Input",ExpressionUUID->"21eb0f1d-43cb-45bf-94e5-e069c5aaacb9"]
}, Closed]],
Cell[CellGroupData[{
Cell[938710, 20706, 180, 3, 37, "Subsubsection",ExpressionUUID->"c2843344-1aec-404d-a1b2-5af8461188d9"],
Cell[938893, 20711, 643, 18, 52, "Input",ExpressionUUID->"f808f68c-2285-4e43-9266-00ca07cc5095"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[939609, 20737, 164, 3, 69, "Chapter",ExpressionUUID->"355c1741-c205-4edb-9218-888f1f408c3c"],
Cell[CellGroupData[{
Cell[939798, 20744, 162, 3, 67, "Section",ExpressionUUID->"fd0f54bb-73cf-48cd-986f-f5d2297b9c79"],
Cell[939963, 20749, 555, 13, 30, "Input",ExpressionUUID->"42a8eae8-e7ed-46d4-ab0c-8f80514999cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[940555, 20767, 266, 6, 53, "Section",ExpressionUUID->"ce8820da-d8be-4171-9fa4-1dd691e2228e"],
Cell[940824, 20775, 609, 14, 30, "Input",ExpressionUUID->"82d0ea1e-3b13-42c1-9613-72a87185dec0"]
}, Closed]],
Cell[CellGroupData[{
Cell[941470, 20794, 242, 4, 53, "Section",ExpressionUUID->"5f73797f-c66d-4bda-95d5-b57e8a15efaa"],
Cell[941715, 20800, 394, 8, 30, "Input",ExpressionUUID->"33b5807e-9815-4b93-a42b-5e8467a8329e"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[942158, 20814, 260, 4, 69, "Chapter",ExpressionUUID->"19a0d227-af9c-4a95-81bc-41e23152f003"],
Cell[942421, 20820, 447, 11, 30, "Input",ExpressionUUID->"4b7f98bd-917f-4bcc-b1dc-391217284559"],
Cell[CellGroupData[{
Cell[942893, 20835, 220, 4, 67, "Section",ExpressionUUID->"43f22ad8-6903-45c5-a382-7cc1c4dead0d"],
Cell[943116, 20841, 471, 11, 30, "Input",ExpressionUUID->"815f38a2-1df7-4481-acb0-f8945fa22a00"]
}, Closed]],
Cell[CellGroupData[{
Cell[943624, 20857, 167, 3, 53, "Section",ExpressionUUID->"7ab5b2dc-085b-44d1-8134-3270572caa6d"],
Cell[943794, 20862, 1093, 26, 52, "Input",ExpressionUUID->"15d6b21b-b2b8-455b-a8a2-455dc353b867"],
Cell[944890, 20890, 549, 13, 30, "Input",ExpressionUUID->"aca07e37-3377-465a-bf2d-e04b1804c266"]
}, Closed]],
Cell[CellGroupData[{
Cell[945476, 20908, 179, 3, 53, "Section",ExpressionUUID->"ed0521e0-d74d-47d7-b86b-3bd1cfe5660c"],
Cell[945658, 20913, 557, 11, 30, "Input",ExpressionUUID->"ed5ff141-0f27-410b-a21f-e3cef6e6d4e0"]
}, Closed]],
Cell[CellGroupData[{
Cell[946252, 20929, 187, 3, 53, "Section",ExpressionUUID->"a2393135-8377-4788-bcf9-82a6f3912749"],
Cell[946442, 20934, 407, 9, 30, "Input",ExpressionUUID->"a3ed7dfc-1d22-4a3b-95de-5d58039149d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[946886, 20948, 232, 4, 53, "Section",ExpressionUUID->"a54fae16-2422-4a36-8c4e-36952670d602"],
Cell[947121, 20954, 301, 7, 35, "Text",ExpressionUUID->"b572f66d-edfa-4bf2-b229-989436571436"],
Cell[947425, 20963, 527, 13, 30, "Input",ExpressionUUID->"8d44a80c-c1b6-4dc9-8367-84140fe56cf5"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

